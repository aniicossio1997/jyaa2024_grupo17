import{a as Ve,b as Ae}from"./chunk-UZR5UCXT.js";import{a as ee,b as kt,c as E,d as jt}from"./chunk-2HMGA3HY.js";import{a as _t,b as bt}from"./chunk-5FI5EUAA.js";import{a as Y}from"./chunk-CL7TEWH3.js";import{a as Mt,b as ke}from"./chunk-47TK7PFT.js";import{a as je,b as Rt}from"./chunk-74WSQMHU.js";import{a as Te,b as St}from"./chunk-UHWMFGLO.js";import{a as de,b as xt}from"./chunk-676UXHSL.js";import{a as ge}from"./chunk-LHQOYPNM.js";import{A as b,B as Nt,b as Pe,c as Ct,i as $,j as Et,l as pe,m as It,n as Ne,o as Me,p as Re,q as yt,s as wt,t as Ft,u as Dt,v as K,w as Tt,x as X,y as U,z as Pt}from"./chunk-N32QBCDO.js";import{a as pt,b as ut,e as ft,f as Fe,g as De,i as gt,l as vt}from"./chunk-MOHWG4PF.js";import{$ as I,G as at,H as T,I as rt,K as we,L as P,N as G,O as k,Q as ot,R as fe,T as j,U as B,V as lt,W as L,X as st,Y as q,Z as mt,_ as ct,a as se,ca as me,ea as W,ha as dt,ia as ce,ja as V,m as it,pa as J,q as nt,qa as ht,v as H}from"./chunk-VXQCQYAP.js";import{$ as y,$b as Z,Db as Se,Eb as Ce,Fb as Ee,Gb as z,Hb as l,Ib as h,Ic as Ye,Jb as F,Kb as N,Kc as ye,Lb as Ie,Lc as R,Oa as m,Pa as u,Pb as D,Pc as et,R as oe,Rb as _,S as We,Tb as Xe,Uc as tt,W as le,_b as Q,aa as Je,eb as v,fb as ne,gb as c,ia as S,ja as C,jb as Ke,pb as t,qb as a,r as xe,rb as d,sb as Le,tb as qe,vb as w,xb as g,yb as f}from"./chunk-MPDHWXUF.js";var A=(()=>{let o=class o{constructor(e){this.http=e,this.API_URL=ce.API_URL+"elaboraciones"}getAll(e){return this.http.get(this.API_URL+(e?"?recetaId="+e:""))}detail(e){return this.http.get(this.API_URL+"/"+e)}create(e){return this.http.post(this.API_URL,e)}edit(e,n){return this.http.put(this.API_URL+"/"+e,n)}delete(e){return this.http.delete(this.API_URL+"/"+e).pipe(xe(n=>n))}ngOnDestroy(){}};o.\u0275fac=function(n){return new(n||o)(le(se))},o.\u0275prov=oe({token:o,factory:o.\u0275fac});let i=o;return i})();var te=(()=>{let o=class o{constructor(e){this.http=e,this.API_URL=ce.API_URL+"notas"}create(e){return this.http.post(this.API_URL,e)}delete(e){return this.http.delete(this.API_URL+"/"+e).pipe(xe(n=>n))}ngOnDestroy(){}};o.\u0275fac=function(n){return new(n||o)(le(se))},o.\u0275prov=oe({token:o,factory:o.\u0275fac});let i=o;return i})();var Kt=["ingresosDropdown"];var Ot=(()=>{let o=class o{constructor(e,n,s,p,x){this.ref=e,this.fb=n,this.toastr=s,this.notaService=p,this.config=x,this.msjError=void 0,this.selectedIngresos=[],this.submited=!1,this.initForm()}ngOnInit(){this.callback=this.config.data.callback,this.elaboracionId=this.config.data.elaboracionId}cancel(){this.ref.close()}save(){let n={descripcion:this.myForm.getRawValue().descripcion,elaboracionId:this.elaboracionId};this.notaService.create(n).subscribe(()=>{this.toastr.success("Se ha a\xF1adido la nota!"),this.callback(),this.ref.close()})}initForm(){this.myForm=this.fb.group({descripcion:new fe("",[P.minLength(3),P.maxLength(256)])})}};o.\u0275fac=function(n){return new(n||o)(u(U),u(q),u(V),u(te),u(X))},o.\u0275cmp=y({type:o,selectors:[["app-ingreso-cambiar-nota"]],viewQuery:function(n,s){if(n&1&&Se(Kt,5),n&2){let p;Ce(p=Ee())&&(s.ingresosDropdown=p.first)}},features:[D([b,te])],decls:13,vars:5,consts:[[1,"p-fluid","p-formgrid","grid",3,"ngSubmit","formGroup"],[1,"field","col-12","md:col-12"],["htmlFor","descripcion"],[1,"text-danger"],["pInputText","","id","descripcion","type","text","placeholder","Escribe una nota","formControlName","descripcion","appCustomInputError","",3,"errors"],["customLabel","",3,"valueForm","errors"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"onClick"],["pRipple","","label","Aceptar","icon","pi pi-check","type","submit",3,"disabled"]],template:function(n,s){if(n&1&&(t(0,"div")(1,"form",0),g("ngSubmit",function(){return s.save()}),t(2,"div",1)(3,"label",2),l(4,"Nota "),t(5,"span",3),l(6,"*"),a()(),d(7,"textarea",4)(8,"span",5),a(),t(9,"div",6)(10,"div",7)(11,"p-button",8),g("onClick",function(){return s.cancel()}),a(),d(12,"p-button",9),a()()()()),n&2){let p,x,M;m(),c("formGroup",s.myForm),m(6),c("errors",(p=s.myForm.get("descripcion"))==null?null:p.errors),m(),c("valueForm",(x=s.myForm.get("descripcion"))==null?null:x.value)("errors",(M=s.myForm.get("descripcion"))==null?null:M.errors),m(4),c("disabled",s.myForm.invalid)}},dependencies:[T,J,j,we,G,k,B,L,ft,Fe],encapsulation:2});let i=o;return i})();var Oe=(()=>{let o=class o{constructor(e){this.http=e,this.API_URL=ce.API_URL+"estadoelaboracion"}create(e){return this.http.post(this.API_URL,e)}ngOnDestroy(){}};o.\u0275fac=function(n){return new(n||o)(le(se))},o.\u0275prov=oe({token:o,factory:o.\u0275fac});let i=o;return i})();function ei(i,o){if(i&1&&(t(0,"span",11),l(1),a()),i&2){let r=f();m(),F(" ",r.msjError!=null?r.msjError:""," ")}}var Gt=(()=>{let o=class o{constructor(e,n,s,p,x,M){this.dialogService=e,this.ref=n,this.fb=s,this.config=p,this.toastr=x,this.estadoElaboracionService=M,this.estados=Object.keys(E),this.msjError=void 0,this.currentDate=new Date,this.loading=!1,this.initForm()}ngOnInit(){this.elaboracionId=this.config.data.elaboracionId,this.estadoInicial=this.config.data.estadoInicial,this.callback=this.config.data.callback,this.myForm.get("estado").setValue(this.estadoInicial),this.myForm.get("estado").valueChanges.subscribe(e=>{e!=this.msjError&&(this.msjError=void 0)})}cancel(){this.ref.close()}save(){if(this.myForm.get("estado").value==this.estadoInicial){this.msjError="Debes asignar un estado distinto al actual";return}this.msjError=void 0,this.loading=!0,this.estadoElaboracionService.create({estado:this.myForm.get("estado").value,elaboracionId:this.elaboracionId,fecha:this.myForm.get("fecha").value}).subscribe(e=>{this.loading=!1,this.toastr.success("Se ha actualizado el estado de la elaboraci\xF3n!"),this.cancel(),this.callback()})}initForm(){this.myForm=this.fb.group({estado:["",P.required],fecha:[new Date,P.required]})}};o.\u0275fac=function(n){return new(n||o)(u(b),u(U),u(q),u(X),u(V),u(Oe))},o.\u0275cmp=y({type:o,selectors:[["app-elaboracion-cambiar-estado"]],features:[D([b,Oe])],decls:15,vars:11,consts:[[1,"p-fluid","p-formgrid","grid",3,"formGroup"],[1,"field","col-12","md:col-12"],["htmlFor","estado"],["placeholder","Selecciona un estado","formControlName","estado",3,"options","autoDisplayFirst","value"],["class","p-2 text-danger",4,"ngIf"],["htmlFor","descripcionid"],["inputId","calendar-24h","formControlName","fecha","dateFormat","dd/mm/yy ",1,"min-w-full",3,"showTime","maxDate","hourFormat","showIcon"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"click"],["pRipple","","label","Guardar","icon","pi pi-check",3,"click","disabled","loading"],[1,"p-2","text-danger"]],template:function(n,s){n&1&&(t(0,"div")(1,"form",0)(2,"div",1)(3,"label",2),l(4,"Estados *"),a(),d(5,"p-dropdown",3),v(6,ei,2,1,"span",4),a(),t(7,"div",1)(8,"label",5),l(9,"Fecha "),a(),d(10,"p-calendar",6),a(),t(11,"div",7)(12,"div",8)(13,"p-button",9),g("click",function(){return s.cancel()}),a(),t(14,"p-button",10),g("click",function(){return s.save()}),a()()()()()),n&2&&(m(),c("formGroup",s.myForm),m(4),c("options",s.estados)("autoDisplayFirst",!1)("value",s.myForm.get("estado")),m(),c("ngIf",s.msjError!=null),m(4),c("showTime",!0)("maxDate",s.currentDate)("hourFormat",24)("showIcon",!0),m(4),c("disabled",s.myForm.invalid)("loading",s.loading))},dependencies:[R,T,$,j,G,k,B,L,Pe],encapsulation:2});let i=o;return i})();function ii(i,o){if(i&1&&(t(0,"span",15),l(1),a()),i&2){let r=f();m(),F(" ",r.msjError!=null?r.msjError:""," ")}}var qt=(()=>{let o=class o{constructor(e,n,s,p,x,M,ue){this.dialogService=e,this.ref=n,this.fb=s,this.config=p,this.toastr=x,this.entregaElaboracionService=M,this.puntoVentaService=ue,this.msjError=void 0,this.currentDate=new Date,this.maxCantidad=0,this.loading=!1,this.puntosVenta=[],this.bloquear=!1,this.positiveNumberValidator=be=>{let He=be.value;return isNaN(He)||He<0?{positiveNumber:{value:be.value}}:null}}ngOnInit(){this.elaboracion=this.config.data.elaboracion,this.callback=this.config.data.callback,this.maxCantidad=this.elaboracion.cantidad-this.elaboracion.entregas.reduce((e,n)=>e+n.cantidad,0),this.bloquear=this.maxCantidad<=0||!0,this.initForm(),this.puntoVentaService.get().subscribe(e=>this.puntosVenta=e)}cancel(){this.ref.close()}save(){this.msjError=void 0,this.loading=!0,this.entregaElaboracionService.create({cantidad:this.myForm.get("cantidad").value,updateState:this.myForm.get("updateState").value,elaboracionId:this.elaboracion.id,puntoVentaId:this.myForm.get("puntoVentaId").value,fecha:this.myForm.get("fecha").value}).subscribe(e=>{this.loading=!1,this.toastr.success("Se ha registrado la entrega!"),this.cancel(),this.callback()})}initForm(){this.myForm=this.fb.group({cantidad:[null,[P.required,P.max(this.maxCantidad)]],fecha:[new Date,P.required],puntoVentaId:[null,P.required],updateState:[!1]})}};o.\u0275fac=function(n){return new(n||o)(u(b),u(U),u(q),u(X),u(V),u(Ve),u(Ae))},o.\u0275cmp=y({type:o,selectors:[["app-elaboracion-registrar-entrega"]],features:[D([b,Ve,Ae])],decls:27,vars:18,consts:[[1,"p-fluid","p-formgrid","grid",3,"formGroup"],[1,"field","col-12","md:col-12"],["htmlFor","estado"],[1,"text-danger"],["placeholder","Selecciona un Punto de Venta","optionLabel","nombre","formControlName","puntoVentaId","filterPlaceholder","Buscar","optionValue","id","filterBy","nombre",3,"options","autoDisplayFirst","filter","value"],["class","p-2 text-danger",4,"ngIf"],["htmlFor","cantidad"],["placeholder","Ingrese una cantidad","formControlName","cantidad","maxFractionDigits","0",3,"min","max","value"],["customLabel","",3,"valueForm","errors"],["htmlFor","fecha"],["inputId","calendar-24h","placeholder","Selecciona una fecha","formControlName","fecha","dateFormat","dd/mm/yy ",1,"min-w-full",3,"showTime","maxDate","showIcon","value"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"click"],["pRipple","","label","Guardar","icon","pi pi-check",3,"click","disabled","loading"],[1,"p-2","text-danger"]],template:function(n,s){if(n&1&&(t(0,"div")(1,"form",0)(2,"div",1)(3,"label",2),l(4,"Punto de Venta "),t(5,"span",3),l(6,"*"),a()(),d(7,"p-dropdown",4),v(8,ii,2,1,"span",5),a(),t(9,"div",1)(10,"label",6),l(11,"Cantidad "),t(12,"span",3),l(13,"*"),a()(),t(14,"p-inputGroup"),d(15,"p-inputNumber",7),t(16,"p-inputGroupAddon"),l(17),a()(),d(18,"span",8),a(),t(19,"div",1)(20,"label",9),l(21,"Fecha "),a(),d(22,"p-calendar",10),a(),t(23,"div",11)(24,"div",12)(25,"p-button",13),g("click",function(){return s.cancel()}),a(),t(26,"p-button",14),g("click",function(){return s.save()}),a()()()()()),n&2){let p,x;m(),c("formGroup",s.myForm),m(6),c("options",s.puntosVenta)("autoDisplayFirst",!1)("filter",!0)("value",s.myForm.get("puntoVentaId")),m(),c("ngIf",s.msjError!=null),m(7),c("min",1)("max",s.maxCantidad)("value",s.myForm.get("cantidad")),m(2),F("disponible: ",s.maxCantidad,""),m(),c("valueForm",(p=s.myForm.get("cantidad"))==null?null:p.value)("errors",(x=s.myForm.get("cantidad"))==null?null:x.errors),m(4),c("showTime",!1)("maxDate",s.currentDate)("showIcon",!0)("value",s.myForm.get("fecha")),m(4),c("disabled",s.myForm.invalid)("loading",s.loading)}},dependencies:[R,T,$,j,G,k,B,L,Fe,pe,de,Te,Pe],encapsulation:2});let i=o;return i})();var ie=()=>({"min-width":"50rem"}),Be=()=>[5,10,20],oi=()=>["autor.username","fecha","descripcion"],li=()=>["estado","fecha","autor.username"],si=()=>["cantidad","puntoVenta.nombre","autor.username","fecha"],mi=()=>["cantidad","ingrediente","ingresoCodigo","ingresoFecha","unidadMedida","familiaProductora","tipo"],ci=(i,o)=>({"text-success":i,"text-900":o});function di(i,o){if(i&1){let r=w();t(0,"div",20)(1,"h5",21),l(2,"Notas"),a(),t(3,"p-button",22),g("click",function(){S(r);let n=f(2);return C(n.openNotaForm())}),a()()}}function pi(i,o){i&1&&(t(0,"tr")(1,"th",23),l(2,"Fecha"),d(3,"p-sortIcon",24),a(),t(4,"th",25),l(5," Autor "),d(6,"p-sortIcon",26),a(),t(7,"th",27),l(8," Nota "),d(9,"p-sortIcon",28),a(),d(10,"th",29),a())}function ui(i,o){if(i&1){let r=w();t(0,"tr")(1,"td"),l(2),Q(3,"dateTransformPipe"),a(),t(4,"td"),l(5),a(),t(6,"td")(7,"b"),l(8),a()(),t(9,"td",29)(10,"p-button",30),g("onClick",function(){let n=S(r).$implicit,s=f(2);return C(s.deleteNota(n))}),a()()()}if(i&2){let r=o.$implicit;m(2),F(" ",Z(3,5,r.fecha)," "),m(3),h(r.autor.username),m(3),h(r.descripcion),m(2),c("rounded",!0)("text",!0)}}function fi(i,o){i&1&&(t(0,"tr")(1,"td",31),l(2," A\xFAn no se han agregado notas "),a()()),i&2&&(m(),ne("colspan",6))}function gi(i,o){if(i&1){let r=w();t(0,"h5"),l(1,"Historial de Estados"),a(),t(2,"div",20)(3,"span",32),d(4,"i",33),t(5,"input",34),g("input",function(n){S(r),f();let s=z(40);return C(s.filterGlobal(n.target.value,"contains"))}),a()(),t(6,"p-button",35),g("click",function(){S(r);let n=f(2);return C(n.openCambiarEstado())}),a()()}}function vi(i,o){i&1&&(t(0,"tr")(1,"th",23),l(2," Fecha Inicio"),d(3,"p-sortIcon",24),a(),t(4,"th",25),l(5," Autor "),d(6,"p-sortIcon",26),a(),t(7,"th",36),l(8," Estado "),d(9,"p-sortIcon",37),a()())}function hi(i,o){if(i&1&&(t(0,"tr")(1,"td"),l(2),Q(3,"dateTransformPipe"),a(),t(4,"td"),l(5),a(),t(6,"td"),d(7,"p-tag",38),a()()),i&2){let r=o.$implicit,e=f(2);m(2),F(" ",Z(3,4,r.fecha)," "),m(3),h(r.autor.username),m(2),c("value",r.estado)("severity",e.getEstadoSeverity(r.estado))}}function _i(i,o){i&1&&(t(0,"tr")(1,"td",31),l(2," No se encontraron resultados "),a()()),i&2&&(m(),ne("colspan",6))}function bi(i,o){if(i&1){let r=w();t(0,"div",20)(1,"h5"),l(2,"Entregas"),a(),t(3,"div",39),l(4," Entregado: "),t(5,"b"),l(6),a()()(),t(7,"div",20)(8,"span",32),d(9,"i",33),t(10,"input",34),g("input",function(n){S(r),f();let s=z(47);return C(s.filterGlobal(n.target.value,"contains"))}),a()(),t(11,"p-button",40),g("onClick",function(){S(r);let n=f(2);return C(n.openRegistrarEntrega())}),a()()}if(i&2){let r=f(2);m(3),c("ngClass",Xe(4,ci,r.totalEntregado===r.elaboracionDetalle.cantidad,r.totalEntregado!==r.elaboracionDetalle.cantidad)),m(3),N(" ",r.totalEntregado," / ",r.elaboracionDetalle.cantidad,""),m(5),c("disabled",r.totalEntregado>=r.elaboracionDetalle.cantidad)}}function xi(i,o){i&1&&(t(0,"tr")(1,"th",25),l(2," Autor"),d(3,"p-sortIcon",26),a(),t(4,"th",41),l(5," Cantidad "),d(6,"p-sortIcon",42),a(),t(7,"th",43),l(8," Punto de Venta "),d(9,"p-sortIcon",44),a(),t(10,"th",23),l(11," Fecha "),d(12,"p-sortIcon",24),a()())}function Si(i,o){if(i&1&&(t(0,"tr")(1,"td"),l(2),a(),t(3,"td"),l(4),a(),t(5,"td"),l(6),a(),t(7,"td"),l(8),Q(9,"dateTransformPipe"),a()()),i&2){let r=o.$implicit;m(2),F(" ",r.autor.username," "),m(2),h(r.cantidad),m(2),h(r.puntoVenta.nombre),m(2),h(Z(9,4,r.fecha))}}function Ci(i,o){i&1&&(t(0,"tr")(1,"td",31),l(2," A\xFAn no se han registrado entregas resultados "),a()()),i&2&&(m(),ne("colspan",6))}function Ei(i,o){if(i&1){let r=w();t(0,"div",20)(1,"h5"),l(2,"Consumos de Insumos y Materias Primas"),a(),t(3,"span",32),d(4,"i",33),t(5,"input",34),g("input",function(n){S(r),f();let s=z(54);return C(s.filterGlobal(n.target.value,"contains"))}),a()()()}}function Ii(i,o){i&1&&(t(0,"tr")(1,"th",45),l(2," Ingrediente"),d(3,"p-sortIcon",46),a(),t(4,"th",41),l(5," Cantidad "),d(6,"p-sortIcon",42),a(),t(7,"th",47),l(8,"Tipo "),d(9,"p-sortIcon",48),a(),t(10,"th",49),l(11," Familia Productora "),d(12,"p-sortIcon",50),a(),t(13,"th",51),l(14," C\xF3digo "),d(15,"p-sortIcon",52),a(),t(16,"th",53),l(17," Fecha Ingreso "),d(18,"p-sortIcon",54),a()())}function yi(i,o){if(i&1&&(t(0,"tr")(1,"td"),l(2),a(),t(3,"td"),l(4),a(),t(5,"td")(6,"b"),l(7),a()(),t(8,"td"),l(9),a(),t(10,"td"),l(11),a(),t(12,"td"),l(13),Q(14,"dateTransformPipe"),a()()),i&2){let r=o.$implicit;m(2),F(" ",r.ingrediente," "),m(2),N("",r.cantidad," ",r.unidadMedida,""),m(3),h(r.tipo),m(2),h(r.familiaProductora),m(2),h(r.ingresoCodigo),m(2),h(Z(14,7,r.ingresoFecha))}}function wi(i,o){i&1&&(t(0,"tr")(1,"td",31),l(2," No se encontraron resultados "),a()()),i&2&&(m(),ne("colspan",6))}function Fi(i,o){if(i&1&&(t(0,"div",6)(1,"div",7)(2,"div",8),l(3,"Detalle de elaboraci\xF3n"),a(),t(4,"div",9)(5,"div",10),l(6," Receta: "),t(7,"b"),l(8),a()(),t(9,"div",10),l(10," C\xF3digo: "),t(11,"b"),l(12),a()(),t(13,"div",10),l(14," Autor: "),t(15,"b"),l(16),a()(),t(17,"div",10),l(18," Estado: "),d(19,"p-tag",11),a(),t(20,"div",10),l(21," Cantidad: "),t(22,"b"),l(23),a()(),t(24,"div",10),l(25," Actualizado: "),t(26,"b"),l(27),Q(28,"dateTransformPipe"),a()()()(),t(29,"div"),d(30,"p-divider"),t(31,"div",12)(32,"p-table",13,0),v(34,di,4,0,"ng-template",14)(35,pi,11,0,"ng-template",15)(36,ui,11,7,"ng-template",16)(37,fi,3,1,"ng-template",17),a()(),t(38,"div",18)(39,"p-table",19,1),v(41,gi,7,0,"ng-template",14)(42,vi,10,0,"ng-template",15)(43,hi,8,6,"ng-template",16)(44,_i,3,1,"ng-template",17),a()(),t(45,"div",18)(46,"p-table",19,2),v(48,bi,12,7,"ng-template",14)(49,xi,13,0,"ng-template",15)(50,Si,10,6,"ng-template",16)(51,Ci,3,1,"ng-template",17),a()(),t(52,"div",18)(53,"p-table",19,3),v(55,Ei,6,0,"ng-template",14)(56,Ii,19,0,"ng-template",15)(57,yi,15,9,"ng-template",16)(58,wi,3,1,"ng-template",17),a()()()()),i&2){let r=f();m(8),h(r.elaboracionDetalle.receta.nombre),m(4),h(r.elaboracionDetalle.codigo),m(4),h(r.autor),m(3),c("value",r.elaboracionDetalle.estado.estado)("severity",r.getEstadoSeverity(r.elaboracionDetalle.estado.estado)),m(4),N("",r.elaboracionDetalle.cantidad," ",r.elaboracionDetalle.cantidad>1?"UNIDADES":"UNIDAD",""),m(4),h(Z(28,40,r.elaboracionDetalle.estado.fecha)),m(5),c("value",r.elaboracionDetalle.notas)("tableStyle",_(42,ie))("paginator",!0)("alwaysShowPaginator",!1)("rows",5)("tableStyle",_(43,ie))("rowsPerPageOptions",_(44,Be))("globalFilterFields",_(45,oi)),m(7),c("value",r.elaboracionDetalle.estados)("tableStyle",_(46,ie))("paginator",!0)("rows",5)("tableStyle",_(47,ie))("alwaysShowPaginator",!1)("rowsPerPageOptions",_(48,Be))("globalFilterFields",_(49,li)),m(7),c("value",r.elaboracionDetalle.entregas)("tableStyle",_(50,ie))("paginator",!0)("rows",5)("tableStyle",_(51,ie))("alwaysShowPaginator",!1)("rowsPerPageOptions",_(52,Be))("globalFilterFields",_(53,si)),m(7),c("value",r.consumos)("tableStyle",_(54,ie))("paginator",!0)("rows",5)("tableStyle",_(55,ie))("alwaysShowPaginator",!1)("rowsPerPageOptions",_(56,Be))("globalFilterFields",_(57,mi))}}var $t=(()=>{let o=class o{constructor(e,n,s,p,x,M,ue){this.elaboracionService=e,this.router=n,this.toastr=s,this.activatedRoute=p,this.dialogService=x,this.confirmationDialogService=M,this.notaService=ue,this.loading=!1,this.consumos=[],this.totalEntregado=0,this.id=Number(this.activatedRoute.snapshot.paramMap.get("id"))}ngOnInit(){this.init()}get autor(){return this.elaboracionDetalle?this.elaboracionDetalle.estados[0]?.autor.nombre:""}openNotaForm(){let e=this.init.bind(this);this.ref=this.dialogService.open(Ot,{header:"Agregar Nota",width:"50vw",breakpoints:{"960px":"75vw","640px":"90vw"},closable:!1,contentStyle:{overflow:"visible"},data:{callback:e,elaboracionId:this.elaboracionDetalle.id}}),this.ref.onClose.subscribe(n=>{})}openCambiarEstado(){let e=this.init.bind(this);this.ref=this.dialogService.open(Gt,{header:"Cambiar estado de la elaboraci\xF3n",width:"30vw",breakpoints:{"960px":"75vw","640px":"90vw"},closable:!1,contentStyle:{overflow:"visible"},data:{callback:e,elaboracionId:this.elaboracionDetalle.id,estadoInicial:this.elaboracionDetalle.estado.estado}}),this.ref.onClose.subscribe(n=>{})}openRegistrarEntrega(){let e=this.init.bind(this);this.ref=this.dialogService.open(qt,{header:"Registrar Entrega",width:"30vw",breakpoints:{"960px":"75vw","640px":"90vw"},closable:!1,contentStyle:{overflow:"visible"},data:{callback:e,elaboracion:this.elaboracionDetalle}}),this.ref.onClose.subscribe(n=>{this.init()})}getEstadoSeverity(e){switch(e){case E.ENTREGADO_COMPLETO:return"success";case E.ENTREGADO_PARCIAL:return"primary";case E.EN_DEPOSITO:return"warning";case E.EN_PROCESO:return"info"}return""}init(){this.elaboracionService.detail(this.id).subscribe(e=>{this.elaboracionDetalle=e;let n=e.consumosMateriaPrima.map(p=>({cantidad:p.cantidad,unidadMedida:p.unidadMedida,ingresoCodigo:p.ingresoMateriaPrima.codigo,tipo:"MATERIA PRIMA",ingrediente:p.ingresoMateriaPrima.materiaPrima.nombre,familiaProductora:p.ingresoMateriaPrima.familiaProductora.nombre,ingresoFecha:p.ingresoMateriaPrima.fecha})),s=e.consumosInsumo.map(p=>({cantidad:p.cantidad,unidadMedida:p.insumo.unidadMedida,tipo:"INSUMO",ingresoCodigo:null,ingrediente:p.insumo.nombre,familiaProductora:null,ingresoFecha:null}));this.consumos=[...n,...s],this.totalEntregado=e.entregas.reduce((p,x)=>p+x.cantidad,0)})}deleteNota(e){let n=this.init.bind(this);this.confirmationDialogService.confirmDelete("\xBFEst\xE1 seguro que desea eliminar la nota?",()=>{console.log(e),this.notaService.delete(e.id).subscribe(()=>{this.toastr.success("Se ha eliminado la nota!"),n()})})}back(){this.router.navigate(["/"+I.Elaboracion,I.Query])}};o.\u0275fac=function(n){return new(n||o)(u(A),u(W),u(V),u(me),u(b),u(ge),u(te))},o.\u0275cmp=y({type:o,selectors:[["elaboracion-detail"]],features:[D([A,b,ge,te])],decls:2,vars:1,consts:[["dt2",""],["dt",""],["dt4",""],["dt3",""],["pRipple","","label","Volver","icon","pi pi-arrow-left","styleClass","mb-2","severity","secondary",3,"click"],["class","card relative",4,"ngIf"],[1,"card","relative"],[1,"mt-2"],[1,"mb-4","font-bold"],[1,"grid","text-lg"],[1,"col-6"],[1,"ml-1",3,"value","severity"],[1,"bg-item","border-round"],[3,"value","tableStyle","paginator","alwaysShowPaginator","rows","rowsPerPageOptions","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"mt-3","bg-item","border-round"],[3,"value","tableStyle","paginator","rows","alwaysShowPaginator","rowsPerPageOptions","globalFilterFields"],[1,"flex","align-items-center","justify-content-between"],[1,"m-0"],["pRipple","","label","Agregar Nota","icon","pi pi-plus","styleClass","mb-2","severity","primary",3,"click"],["pSortableColumn","fecha"],["field","fecha"],["pSortableColumn","autor.username"],["field","autor.username"],["pSortableColumn","descripcion"],["field","descripcion"],[2,"width","80px"],["pRipple","","icon","pi pi-trash","severity","secondary",3,"onClick","rounded","text"],[1,"text-center","py-4"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pRipple","","label","Cambiar estado","icon","pi pi-tag","styleClass","mb-2","severity","primary",3,"click"],["pSortableColumn","estado"],["field","estado"],[3,"value","severity"],[3,"ngClass"],["pRipple","","label","Registrar Entrega","icon","pi pi-truck","styleClass","mb-2","severity","primary",3,"onClick","disabled"],["pSortableColumn","cantidad"],["field","cantidad"],["pSortableColumn","puntoVenta.nombre"],["field","puntoVenta.nombre"],["pSortableColumn","ingrediente"],["field","ingrediente"],["pSortableColumn","tipo"],["field","tipo"],["pSortableColumn","familiaProductora"],["field","familiaProductora"],["pSortableColumn","ingresoCodigo"],["field","ingresoCodigo"],["pSortableColumn","ingresoFecha"],["field","ingresoFecha"]],template:function(n,s){n&1&&(t(0,"p-button",4),g("click",function(){return s.back()}),a(),v(1,Fi,59,58,"div",5)),n&2&&(m(),c("ngIf",!!s.elaboracionDetalle))},dependencies:[Ye,R,Ne,H,Me,Re,T,K,J,je,De]});let i=o;return i})();var Ti=["ingresosDropdown"],Pi=()=>({height:"2.5rem"});function Ni(i,o){if(i&1&&(t(0,"div",17)(1,"div"),l(2),a(),t(3,"div",18),l(4),d(5,"p-tag",19),a()()),i&2){let r=o.$implicit,e=f(2);m(2),h(r.codigo),m(2),N(" disponible (",r.cantidad," ",e.materiaPrima.unidadMedida,") "),m(),c("value",r.currentState.nombre)("severity",e.getSeverity(r.currentState.nombre))}}function Mi(i,o){i&1&&d(0,"i",20)}function Ri(i,o){if(i&1){let r=w();t(0,"div",21)(1,"span")(2,"b"),l(3),a(),d(4,"p-tag",19),a(),t(5,"div",22)(6,"span",18),l(7),a(),t(8,"p-inputGroup",23),d(9,"p-inputNumber",24),t(10,"p-inputGroupAddon"),l(11),a()(),t(12,"p-button",25),g("onClick",function(){let n=S(r).$implicit,s=f(2);return C(s.onDeleteIngreso(n.id))}),a()()()}if(i&2){let r=o.$implicit,e=o.index,n=f(2);m(3),h(r.codigo),m(),c("value",r.currentState.nombre)("severity",n.getSeverity(r.currentState.nombre)),m(3),N(" (disponible: ",r.cantidad," ",n.materiaPrima.unidadMedida,")"),m(),Ke(_(13,Pi)),m(),c("maxFractionDigits",2)("formControlName",e)("max",r.cantidad),m(2),h(n.materiaPrima.unidadMedida),m(),c("rounded",!0)("text",!0)}}function ki(i,o){if(i&1&&(t(0,"div",26),l(1),a()),i&2){let r=o.ngIf;m(),F(" ",r," ")}}function ji(i,o){if(i&1){let r=w();t(0,"div")(1,"form",2),g("ngSubmit",function(){S(r);let n=f();return C(n.save())}),t(2,"div",3),l(3," Por favor, selecciona los ingresos y cantidades correspondientes a las materias primas utilizados en la elaboraci\xF3n. "),a(),t(4,"div",4)(5,"label",5),l(6,"Ingresos"),a(),t(7,"p-dropdown",6,0),g("onChange",function(n){S(r);let s=f();return C(s.onSelectIngreso(n))}),v(9,Ni,6,5,"ng-template",7),a()(),t(10,"div",8),l(11),v(12,Mi,1,0,"i",9),a(),t(13,"div",10),v(14,Ri,13,14,"div",11),a(),v(15,ki,2,1,"div",12),t(16,"div",13)(17,"div",14)(18,"p-button",15),g("onClick",function(){S(r);let n=f();return C(n.cancel())}),a(),d(19,"p-button",16),a()()()()}if(i&2){let r=f();m(),c("formGroup",r.myForm),m(6),c("options",r.materiaPrima.ingresos)("autoDisplayFirst",!1)("filter",!0)("showClear",!0),m(4),Ie(" ",r.getMin(r.cantidadRequerida,r.cantidadTotalSeleccionada)," / ",r.cantidadRequerida," ",r.materiaPrima.unidadMedida," "),m(),c("ngIf",r.cantidadRequerida<=r.materiaPrima.totalCantidadDisponible),m(2),c("ngForOf",r.selectedIngresos),m(),c("ngIf",r.getErrorMessage())}}function Ut(i){return i.value>0?null:{greaterThanZero:!0}}var Qt=(()=>{let o=class o{constructor(e,n,s,p){this.ref=e,this.fb=n,this.config=s,this.materiaPrimaService=p,this.msjError=void 0,this.selectedIngresos=[],this.submited=!1,this.initForm()}ngOnInit(){this.materiaPrimaId=this.config.data.materiaPrima.id,this.cantidadRequerida=this.config.data.cantidadRequerida;let e=this.config.data.initialData??[];this.callback=this.config.data.callback,this.materiaPrimaId&&this.materiaPrimaService.getById(this.materiaPrimaId).subscribe(n=>{this.materiaPrima=n,e.forEach(s=>{let p=this.materiaPrima.ingresos.find(x=>x.id==s.ingresoMateriaPrimaId);p&&(this.selectedIngresos.push(p),this.getIngresosFormArr().push(new fe(s.cantidad,Ut)))})})}onSelectIngreso(e){let n=e.value;n&&(this.selectedIngresos.find(s=>s.id==n.id)||(this.selectedIngresos.push(n),this.getIngresosFormArr().push(new fe(0,Ut))),this.ingresosDropdown.clear())}onDeleteIngreso(e){let n=this.selectedIngresos.findIndex(s=>s.id==e);n>-1&&(this.selectedIngresos.splice(n,1),this.getIngresosFormArr().removeAt(n))}getIngresosFormArr(){return this.myForm.get("cantidades")}getMin(e,n){return Math.min(e,n)}cancel(){this.ref.close()}save(){let e=this.getIngresosFormArr().getRawValue(),n=this.selectedIngresos.map((s,p)=>({ingresoMateriaPrimaId:s.id,cantidad:e[p]}));this.submited=!0,!this.getErrorMessage()&&(console.log({materiaPrimaId:this.materiaPrimaId,data:n}),this.callback(this.materiaPrimaId,n),this.ref.close())}get cantidadTotalSeleccionada(){return this.getIngresosFormArr().getRawValue().reduce((n,s)=>n+s,0)}getErrorMessage(){return this.submited?this.cantidadTotalSeleccionada>this.cantidadRequerida?"La cantidad seleccionada supera la cantidad requerida, por favor ajusta las cantidades.":this.cantidadTotalSeleccionada<this.cantidadRequerida?"La cantidad seleccionada no cubre la cantidad requerida, por favor ajusta las cantidades.":null:null}getSeverity(e){switch(e){case ke.CAMARA_FRIO:return"primary";case ke.ESTANTE:return"warning";case ke.FREEZER:return"info"}}initForm(){this.myForm=this.fb.group({cantidades:new st([],P.required)})}};o.\u0275fac=function(n){return new(n||o)(u(U),u(q),u(X),u(Y))},o.\u0275cmp=y({type:o,selectors:[["app-ingreso-cambiar-estado"]],viewQuery:function(n,s){if(n&1&&Se(Ti,5),n&2){let p;Ce(p=Ee())&&(s.ingresosDropdown=p.first)}},features:[D([b,Y])],decls:1,vars:1,consts:[["ingresosDropdown",""],[4,"ngIf"],[1,"p-fluid","p-formgrid","grid",3,"ngSubmit","formGroup"],[1,"col-12","md:col-12","text-400"],[1,"field","col-12","md:col-12"],["htmlFor","estado"],["placeholder","Buscar ingresos","optionLabel","codigo","filterPlaceholder","C\xF3digo de ingreso","filterBy","codigo",3,"onChange","options","autoDisplayFirst","filter","showClear"],["pTemplate","item"],[1,"ml-auto"],["class","fa-solid fa-check text-success",4,"ngIf"],["formArrayName","cantidades",1,"field","col-12","flex","flex-column","gap-1"],["class","shadow-1 px-2 pl-2 pr-1 flex justify-content-between align-items-center border-round-md bg-item",4,"ngFor","ngForOf"],["class","text-danger p-3",4,"ngIf"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"onClick"],["pRipple","","label","Aceptar","icon","pi pi-check","type","submit"],[1,"flex","align-items-center","justify-content-between","gap-2"],[1,"text-sm"],[1,"ml-2",3,"value","severity"],[1,"fa-solid","fa-check","text-success"],[1,"shadow-1","px-2","pl-2","pr-1","flex","justify-content-between","align-items-center","border-round-md","bg-item"],[1,"flex","gap-2","align-items-center"],[1,"w-10rem"],["placeholder","Cantidad","size","2",3,"maxFractionDigits","formControlName","max"],["pRipple","","icon","pi pi-trash","severity","secondary",3,"onClick","rounded","text"],[1,"text-danger","p-3"]],template:function(n,s){n&1&&v(0,ji,20,11,"div",1),n&2&&c("ngIf",s.materiaPrima)},dependencies:[ye,R,H,T,K,$,j,G,k,B,L,lt,pe,de,Te],encapsulation:2});let i=o;return i})();var Ai=()=>({width:"100%"});function Oi(i,o){if(i&1&&d(0,"p-tag",29),i&2){let r=o.$implicit,e=f();c("value",r)("severity",e.getEstadoSeverity(r))}}function Gi(i,o){if(i&1&&d(0,"p-tag",29),i&2){let r=o.$implicit,e=f();c("value",r)("severity",e.getEstadoSeverity(r))}}function Bi(i,o){i&1&&d(0,"i",38)}function Li(i,o){if(i&1&&(t(0,"div",39),l(1," No cuentas con las cantidades necesarias "),t(2,"div",40),l(3),a()()),i&2){let r=f(2).$implicit;m(3),N(" (disponible: ",r.insumo.cantidadDisponible," ",r.insumo.unidadMedida,") ")}}function qi(i,o){if(i&1&&(t(0,"div",41),l(1),a()),i&2){let r=f(2).$implicit;m(),N(" disponible: ",r.insumo.cantidadDisponible," ",r.insumo.unidadMedida," ")}}function $i(i,o){if(i&1&&(Le(0),t(1,"div",32)(2,"div")(3,"h6",33),l(4),a()(),t(5,"div",34)(6,"div"),l(7),v(8,Bi,1,0,"i",35),a(),v(9,Li,4,2,"div",36)(10,qi,2,2,"div",37),a()(),qe()),i&2){let r=o.ngIf,e=f().$implicit;m(4),h(e.insumo.nombre),m(3),N("",r," ",e.insumo.unidadMedida," "),m(),c("ngIf",r<=e.insumo.cantidadDisponible),m(),c("ngIf",r>e.insumo.cantidadDisponible),m(),c("ngIf",r<=e.insumo.cantidadDisponible)}}function Ui(i,o){if(i&1&&(t(0,"div",30),v(1,$i,11,6,"ng-container",31),a()),i&2){let r,e=o.$implicit,n=f();m(),c("ngIf",(((r=n.form.get("cantidad"))==null?null:r.value)*e.cantidad).toFixed(1))}}function Qi(i,o){i&1&&d(0,"i",38)}function Zi(i,o){if(i&1&&(t(0,"div",39),l(1," No cuentas con las cantidades necesarias "),t(2,"div",40),l(3),a()()),i&2){let r=f(2).$implicit;m(3),N(" (disponible: ",r.materiaPrima.totalCantidadDisponible," ",r.materiaPrima.unidadMedida,") ")}}function zi(i,o){if(i&1&&(t(0,"div",46),l(1),a()),i&2){let r=f(2).$implicit;m(),N(" disponible: ",r.materiaPrima.totalCantidadDisponible," ",r.materiaPrima.unidadMedida," ")}}function Hi(i,o){if(i&1){let r=w();Le(0),t(1,"div",32)(2,"div")(3,"h6",33),l(4),a()(),t(5,"div",43)(6,"div",34)(7,"div"),l(8),v(9,Qi,1,0,"i",35),a(),v(10,Zi,4,2,"div",36)(11,zi,2,2,"div",44),a(),t(12,"p-button",45),g("click",function(){S(r);let n=f().$implicit,s=f();return C(s.openSelectorIngresos(n))}),a()()(),qe()}if(i&2){let r=o.ngIf,e=f().$implicit,n=f();m(4),h(e.materiaPrima.nombre),m(4),Ie(" ",n.getMin(n.consumosMateriaPrima.get(e.materiaPrima.id)?r:0,e.materiaPrima.totalCantidadDisponible)," / ",r," ",e.materiaPrima.unidadMedida," "),m(),c("ngIf",n.consumosMateriaPrima.get(e.materiaPrima.id)),m(),c("ngIf",r>e.materiaPrima.totalCantidadDisponible),m(),c("ngIf",r<=e.materiaPrima.totalCantidadDisponible)}}function Wi(i,o){if(i&1&&(t(0,"div",42),v(1,Hi,13,7,"ng-container",31),a()),i&2){let r=o.$implicit,e=f();m(),c("ngIf",e.getCantidad(r))}}var Zt=(()=>{let o=class o{constructor(e,n,s,p,x,M,ue,be){this.fb=e,this.router=n,this.recetaService=s,this.materiasPrimaService=p,this.activatedRoute=x,this.dialogService=M,this.elaboracionService=ue,this.toastr=be,this.detalleMateriaPrima=new Map,this.consumosMateriaPrima=new Map,this.unidadMedidaArray=Object.keys(Mt),this.estados=Object.keys(E),this.loading=!1,this.initForm(),this.consumosMateriaPrima=new Map,this.recetaId=Number(this.activatedRoute.snapshot.paramMap.get("id"))}ngOnInit(){this.recetaService.detail(this.recetaId).subscribe(e=>{this.receta=e,this.insumos=e.ingredientes.filter(n=>n.insumo!=null),this.materiasPrimas=e.ingredientes.filter(n=>n.materiaPrima!=null),this.materiasPrimas.forEach(n=>{this.materiasPrimaService.getById(n.materiaPrima.id).subscribe(s=>{this.detalleMateriaPrima.set(s.id,s)})})})}initForm(){this.form=this.fb.group({cantidad:[1,P.required],estado:E.EN_PROCESO,nota:[""]})}cancel(){this.router.navigate(["/"+I.Elaboracion])}save(){let e=this.form.getRawValue(),n=Array.from(this.consumosMateriaPrima.values()),s={cantidad:e.cantidad,estado:e.estado,fecha:new Date,nota:e.nota,recetaId:this.recetaId,consumoMateriasPrimas:n.flat()};this.loading=!0,this.elaboracionService.create(s).subscribe(p=>{this.loading=!1,this.toastr.success("Se ha creado la elaboraci\xF3n!"),this.router.navigate(["/"+I.Elaboracion+"/"+I.Detail+"/"+p.id])})}getMin(e,n){return Math.min(e,n)}getCantidad(e){return(e.cantidad*(this.form.get("cantidad")?.value??0)).toFixed(1)}onIngresosSelected(e,n){this.consumosMateriaPrima.set(e,n)}openSelectorIngresos(e){let n=this.onIngresosSelected.bind(this);this.ref=this.dialogService.open(Qt,{header:"Seleccionar ingresos de "+e.materiaPrima.nombre,width:"50vw",closable:!1,contentStyle:{overflow:"visible"},data:{materiaPrima:e.materiaPrima,cantidadRequerida:this.getCantidad(e),initialData:this.consumosMateriaPrima.get(e.materiaPrima.id),callback:n}}),this.ref.onClose.subscribe(s=>{})}getEstadoSeverity(e){switch(e){case E.ENTREGADO_COMPLETO:return"success";case E.ENTREGADO_PARCIAL:return"primary";case E.EN_DEPOSITO:return"warning";case E.EN_PROCESO:return"info"}return""}};o.\u0275fac=function(n){return new(n||o)(u(q),u(W),u(ee),u(Y),u(me),u(b),u(A),u(V))},o.\u0275cmp=y({type:o,selectors:[["app-insumos-new"]],features:[D([ee,Y,b,A])],decls:47,vars:15,consts:[[1,"card",2,"width","80%"],[1,"mb-5"],[1,"p-fluid","p-formgrid","grid",3,"formGroup"],[1,"field","col-12","md:col-12"],["htmlFor","recetaId",1,"mr-3"],["id","recetaId","type","text","pInputText","",1,"font-bold",3,"disabled","value"],[1,"field","col-12","md:col-4"],["htmlFor","unidadMedida"],[1,"text-danger"],["placeholder","Ingrese una cantidad","formControlName","cantidad",3,"value"],[1,"field","col-12","md:col-8"],["htmlFor","nota",1,"mr-3"],["id","nota","type","text","placeholder","Nota Adicional","pInputText","","formControlName","nota",3,"disabled","value"],["htmlFor","estado"],["placeholder","Selecciona un estado","formControlName","estado",3,"options","autoDisplayFirst","value"],["pTemplate","selectedItem"],["pTemplate","item"],["styleClass","w-full",3,"ngStyle"],[1,"grid","w-full","col-12"],[1,"field","col-12"],["htmlFor","familiaPrimaId",1,"mr-3","text-lg","font-bold"],[1,"flex","flex-column","gap-1","mt-2"],["class","shadow-1 p-2 px-3 border-round-md border-200 border-1 bg-item",4,"ngFor","ngForOf"],[1,"flex","justify-content-between"],[1,"mr-3","text-lg","font-bold"],["class","shadow-1 p-3 border-round-md border-200 border-1 bg-item",4,"ngFor","ngForOf"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"click"],["pRipple","","label","Guardar","icon","pi pi-check",3,"click","loading","disabled"],[3,"value","severity"],[1,"shadow-1","p-2","px-3","border-round-md","border-200","border-1","bg-item"],[4,"ngIf"],[1,"flex","justify-content-between","align-items-center","flex-wrap"],[1,"mb-2"],[1,"flex","flex-column","align-items-end"],["class","fa-solid fa-check text-success",4,"ngIf"],["class","flex align-items-end text-danger flex-wrap text-sm",4,"ngIf"],["class","text-success text-sm",4,"ngIf"],[1,"fa-solid","fa-check","text-success"],[1,"flex","align-items-end","text-danger","flex-wrap","text-sm"],[1,"ml-1"],[1,"text-success","text-sm"],[1,"shadow-1","p-3","border-round-md","border-200","border-1","bg-item"],[1,"flex","flex-wrap","gap-4"],["class","text-info text-sm",4,"ngIf"],["pRipple","","label","Seleccionar Ingresos","size","small","severity","secondary",3,"click"],[1,"text-info","text-sm"]],template:function(n,s){n&1&&(t(0,"div",0)(1,"h5",1),l(2,"Nueva Elaboraci\xF3n"),a(),t(3,"form",2)(4,"div",3)(5,"label",4),l(6,"Receta: "),a(),d(7,"input",5),a(),t(8,"div",6)(9,"label",7),l(10,"Cantidad "),t(11,"span",8),l(12,"*"),a()(),t(13,"p-inputGroup"),d(14,"p-inputNumber",9),a()(),t(15,"div",10)(16,"label",11),l(17,"Nota Adicional: "),a(),d(18,"input",12),a(),t(19,"div",3)(20,"label",13),l(21,"Estado "),t(22,"span",8),l(23,"*"),a()(),t(24,"p-dropdown",14),v(25,Oi,1,2,"ng-template",15)(26,Gi,1,2,"ng-template",16),a()(),d(27,"p-divider",17),t(28,"div",3)(29,"h5"),l(30,"Ingredientes"),a(),t(31,"div",18)(32,"div",19)(33,"label",20),l(34,"Insumos"),a(),t(35,"div",21),v(36,Ui,2,1,"div",22),a()(),t(37,"div",19)(38,"div",23)(39,"label",24),l(40,"Materias Primas"),a()(),t(41,"div",21),v(42,Wi,2,1,"div",25),a()()()(),t(43,"div",19)(44,"div",26)(45,"p-button",27),g("click",function(){return s.cancel()}),a(),t(46,"p-button",28),g("click",function(){return s.save()}),a()()()()()),n&2&&(m(3),c("formGroup",s.form),m(4),c("disabled",!0)("value",s.receta==null?null:s.receta.nombre),m(7),c("value",s.form.get("cantidad")),m(4),c("disabled",!0)("value",s.form.get("nota")),m(6),c("options",s.estados)("autoDisplayFirst",!1)("value",s.form.get("estado")),m(3),c("ngStyle",_(14,Ai)),m(9),c("ngForOf",s.insumos),m(6),c("ngForOf",s.materiasPrimas),m(4),c("loading",s.loading)("disabled",s.form.invalid))},dependencies:[ye,R,et,H,T,K,J,$,j,we,G,k,B,L,je,pe,de],encapsulation:2});let i=o;return i})();function Ji(i,o){if(i&1){let r=w();t(0,"div")(1,"form",1),g("ngSubmit",function(){S(r);let n=f();return C(n.save())}),t(2,"div",2),l(3," Por favor, selecciona la receta que deseas a elaborar para continuar. "),a(),t(4,"div",3)(5,"p-dropdown",4),g("onChange",function(n){S(r);let s=f();return C(s.onSelectReceta(n))}),a()(),t(6,"div",5)(7,"div",6)(8,"p-button",7),g("onClick",function(){S(r);let n=f();return C(n.cancel())}),a(),d(9,"p-button",8),a()()()()}if(i&2){let r=f();m(5),c("options",r.recetas)("autoDisplayFirst",!1)("filter",!0),m(4),c("disabled",!r.recetaId)}}var zt=(()=>{let o=class o{constructor(e,n,s){this.ref=e,this.recetaService=n,this.router=s,this.recetas=[]}ngOnInit(){this.recetaService.get().subscribe(e=>{this.recetas=e})}onSelectReceta(e){this.recetaId=e.value.id}cancel(){this.ref.close()}save(){this.recetaId&&(this.router.navigate([`/${I.Elaboracion}/${I.New}/`,this.recetaId]),this.ref.close())}};o.\u0275fac=function(n){return new(n||o)(u(U),u(ee),u(W))},o.\u0275cmp=y({type:o,selectors:[["app-ingreso-cambiar-estado"]],features:[D([b,ee])],decls:1,vars:1,consts:[[4,"ngIf"],[1,"p-fluid","p-formgrid","grid",3,"ngSubmit"],[1,"col-12","md:col-12","text-400"],[1,"field","col-12","md:col-12"],["placeholder","Buscar recetas","optionLabel","nombre","filterPlaceholder","Buscar recetas","filterBy","nombre",3,"onChange","options","autoDisplayFirst","filter"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"onClick"],["pRipple","","label","Continuar","icon","pi pi-check","type","submit",3,"disabled"]],template:function(n,s){n&1&&v(0,Ji,10,4,"div",0),n&2&&c("ngIf",s.recetas)},dependencies:[R,T,$,j,k,ot],encapsulation:2});let i=o;return i})();var Ht=()=>({"min-width":"50rem"}),Ki=()=>[5,10,20],Xi=()=>["codigo","receta","cantidad","autor.username"];function Yi(i,o){if(i&1){let r=w();t(0,"h2",9),l(1,"Elaboraciones"),a(),t(2,"div",10)(3,"div",11)(4,"span",12),d(5,"i",13),t(6,"input",14),g("input",function(n){S(r),f();let s=z(2);return C(s.filterGlobal(n.target.value,"contains"))}),a()()(),t(7,"p-button",15),g("click",function(){S(r);let n=f();return C(n.openSelectorReceta())}),a()()}}function en(i,o){i&1&&(t(0,"tr")(1,"th"),l(2,"Acciones"),a(),t(3,"th",16),l(4," Fecha Inicio"),d(5,"p-sortIcon",17),a(),t(6,"th",18),l(7,"C\xF3digo "),d(8,"p-sortIcon",19),a(),t(9,"th",20),l(10,"Receta "),d(11,"p-sortIcon",21),a(),t(12,"th",22),l(13," Cantidad "),d(14,"p-sortIcon",23),a(),t(15,"th",24),l(16," Autor "),d(17,"p-sortIcon",25),a(),t(18,"th",26),l(19,"Estado "),d(20,"p-sortIcon",27),a(),t(21,"th",28),l(22," Actualizado"),d(23,"p-sortIcon",29),a()())}function tn(i,o){if(i&1){let r=w();t(0,"tr")(1,"td")(2,"button",30),g("click",function(n){let s=S(r).$implicit,p=z(4),x=f();return C(x.generateMenu(s,p,n))}),a(),d(3,"p-menu",31,1),a(),t(5,"td"),l(6),Q(7,"dateTransformPipe"),a(),t(8,"td"),l(9),a(),t(10,"td")(11,"b"),l(12),a()(),t(13,"td"),l(14),a(),t(15,"td")(16,"b"),l(17),a()(),t(18,"td"),d(19,"p-tag",32),a(),t(20,"td"),l(21),Q(22,"dateTransformPipe"),a()()}if(i&2){let r=o.$implicit,e=f();m(3),c("popup",!0)("model",e.itemsMenu),m(3),F(" ",Z(7,10,r.fecha)," "),m(3),h(r.codigo),m(3),h(r.receta),m(2),h(r.cantidad),m(3),h(r.autor.username),m(2),c("value",r.estado.estado)("severity",e.getEstadoSeverity(r.estado.estado)),m(2),F(" ",Z(22,12,r.estado.fecha)," ")}}function nn(i,o){i&1&&(t(0,"tr")(1,"td",33),l(2," No se encontraron resultados "),a()()),i&2&&(m(),ne("colspan",6))}function an(i,o){if(i&1&&(t(0,"div",34),l(1),a()),i&2){let r=f(),e=z(2);m(),F(" En total hay ",e.filteredValue?e.filteredValue.length:r.elaboraciones.length," registros. ")}}var Wt=(()=>{let o=class o{constructor(e,n,s,p,x,M){this.elaboracionService=e,this.router=n,this.toastr=s,this.confirmationDialogService=p,this.activatedRoute=x,this.dialogService=M,this.elaboraciones=[],this.loading=!0,this.itemsMenu=[]}ngOnInit(){this.recetaId=Number(this.activatedRoute.snapshot.paramMap.get("id")),this.fetchAll()}fetchAll(){this.loading=!0,this.elaboracionService.getAll().subscribe(e=>{this.elaboraciones=e,this.loading=!1})}get Routes(){return{NEW:`/${I.Elaboracion}/${I.New}`}}generateMenu(e,n,s){n.toggle(s),this.itemsMenu=[{label:"Detalle",icon:"pi pi-eye",command:()=>{this.router.navigate([`/${I.Elaboracion}/${I.Detail}/`,e.id])}},{label:"Eliminar",icon:"pi pi-trash",command:()=>{this.delete(e)}}]}delete(e){this.confirmationDialogService.confirmDelete("\xBFEst\xE1 seguro que desea eliminar la elaboraci\xF3n?",()=>{this.elaboracionService.delete(e.id).subscribe(()=>{this.toastr.success("Se ha eliminado la elaboracion"),this.fetchAll()})})}openSelectorReceta(){this.ref=this.dialogService.open(zt,{header:"Agregar elaboracion",width:"50vw",breakpoints:{"960px":"75vw","640px":"90vw"},closable:!1,contentStyle:{overflow:"visible"}}),this.ref.onClose.subscribe(e=>{})}getEstadoSeverity(e){switch(e){case E.ENTREGADO_COMPLETO:return"success";case E.ENTREGADO_PARCIAL:return"primary";case E.EN_DEPOSITO:return"warning";case E.EN_PROCESO:return"info"}return""}};o.\u0275fac=function(n){return new(n||o)(u(A),u(W),u(V),u(ge),u(me),u(b))},o.\u0275cmp=y({type:o,selectors:[["elaboraciones-query"]],features:[D([A,it,nt,b])],decls:8,vars:11,consts:[["dt",""],["menu",""],[1,"card"],[3,"value","tableStyle","paginator","rows","rowsPerPageOptions","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"mb-4"],[1,"flex","align-items-center","justify-content-between","flex-wrap"],[1,"flex","gap-4","flex-wrap"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pRipple","","severity","primary","label","Agregar Elaboraci\xF3n","icon","pi pi-plus",1,"mr-2",3,"click"],["pSortableColumn","fecha"],["field","fecha"],["pSortableColumn","codigo"],["field","codigo"],["pSortableColumn","receta"],["field","receta"],["pSortableColumn","cantidad"],["field","cantidad"],["pSortableColumn","autor.username"],["field","autor.username"],["pSortableColumn","estado.estado"],["field","estado.estado"],["pSortableColumn","estado.fecha"],["field","estado.fecha"],["pButton","","pRipple","","type","button","icon","pi pi-bars",1,"p-button-rounded","p-button-text",3,"click"],["appendTo","body",3,"popup","model"],[3,"value","severity"],[1,"text-center","py-4"],[1,"flex","align-items-center","justify-content-between"]],template:function(n,s){n&1&&(t(0,"div",2)(1,"p-table",3,0),v(3,Yi,8,0,"ng-template",4)(4,en,24,0,"ng-template",5)(5,tn,23,14,"ng-template",6)(6,nn,3,1,"ng-template",7)(7,an,2,1,"ng-template",8),a()()),n&2&&(m(),c("value",s.elaboraciones)("tableStyle",_(7,Ht))("paginator",!0)("rows",5)("tableStyle",_(8,Ht))("rowsPerPageOptions",_(9,Ki))("globalFilterFields",_(10,Xi)))},dependencies:[Ne,H,Me,Re,at,T,pt,K,J,De],encapsulation:2});let i=o;return i})();var rn=[{path:"",redirectTo:"query",pathMatch:"full"},{path:"detail/:id",component:$t,title:"Detalle de Elaboracion"},{path:"query",component:Wt,title:"Listado de Elaboraciones"},{path:`${I.New}/:id`,component:Zt,title:"Nueva Elaboracion"}],Ka=(()=>{let o=class o{};o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=Je({type:o}),o.\u0275inj=We({imports:[tt,dt.forChild(rn),yt,rt,ut,Dt,Tt,vt,Ft,bt,ht,_t,Nt,Pt,wt,Et,mt,ct,gt,kt,Rt,jt,It,xt,St,Ct]});let i=o;return i})();export{Ka as ElaboracionesModule};
