import{a as Jt,b as Yt}from"./chunk-DIGLBKTG.js";import{a as Y}from"./chunk-RJCKGDOT.js";import{a as ee}from"./chunk-PKO2OHKX.js";import{a as Qe,b as ei,c as He,d as ti}from"./chunk-C2756QQK.js";import{a as Ke,b as Zt}from"./chunk-CNX4EVCT.js";import{a as Pt}from"./chunk-DJPC4CBX.js";import{B as Ut,D as Wt,E as je,F as Ge,H as Xt,b as J,c as Kt,g as jt,h as Ze,i as Xe,j as De,k as Gt,m as Pe,n as Qt,o as Ae,p as Re,q as Ne,r as Ht,t as qt,u as $t,w as Bt,y as zt}from"./chunk-6ORVLML4.js";import{B as Ot,C as Ft,D as Et,E as W,F as kt,G as Ie,H as Se,I as q,J as Mt,K as we,L as Te,M as Oe,N as Q,P as Fe,Q as Ee,R as ke,S as Me,T as me,V as Vt,W as Lt,X as S,_ as Ve,a as bt,aa as Z,ba as Le,da as Dt,g as O,ga as At,h as xt,ha as Rt,j as vt,m as yt,ma as ue,n as Ct,oa as Nt,p as Ce,pa as X,q as It,r as St,s as D,t as fe,v as B,x as wt,y as Tt}from"./chunk-FEXW6FWZ.js";import{$ as ne,Bb as ae,Cb as V,Db as F,Dc as ce,Eb as E,Fb as N,Fc as pe,Gb as m,Gc as z,Hb as I,Ib as k,Jb as xe,Kc as U,Lc as ye,Mc as gt,Na as a,Nb as G,Oa as v,Oc as de,P as ge,Pb as w,Q as at,Qb as L,R as ie,Rb as le,Sb as se,Tb as ut,Ua as pt,V as lt,Yb as _t,Zb as ft,_ as K,_a as oe,_b as We,ab as be,db as u,eb as y,fb as c,gb as dt,ha as f,ia as h,ib as $,jb as re,kc as ve,ma as st,nc as T,oa as ct,ob as l,oc as _e,pb as s,pc as ht,qa as j,qb as g,r as rt,rb as A,sb as R,tb as H,ub as C,wb as x,xb as d,yb as mt,zb as Ue}from"./chunk-G7V5XMVF.js";var M=(()=>{let r=class r{constructor(i){this.http=i,this.API_URL="http://localhost:8080/SalaDeElaboracion/api/recetas"}get(){return this.http.get(this.API_URL)}detail(i){return this.http.get(this.API_URL+"/"+i)}create(i){return this.http.post(this.API_URL,i)}edit(i,t){return this.http.put(this.API_URL+"/"+i,t)}delete(i){return this.http.delete(this.API_URL+"/"+i).pipe(rt(t=>t))}ngOnDestroy(){}};r.\u0275fac=function(t){return new(t||r)(lt(bt))},r.\u0275prov=at({token:r,factory:r.\u0275fac});let n=r;return n})();var ii=()=>({"min-width":"50rem"}),fi=()=>[5,10,20],hi=()=>["nombre"],gi=n=>[n];function bi(n,r){if(n&1){let e=C();l(0,"h2",9),m(1,"Recetas"),s(),l(2,"div",10)(3,"div",11)(4,"span",12),g(5,"i",13),l(6,"input",14),x("input",function(t){f(e),d();let o=N(2);return h(o.filterGlobal(t.target.value,"contains"))}),s()()(),g(7,"p-button",15),s()}if(n&2){let e=d();a(7),c("routerLink",L(1,gi,e.Routes.NEW))}}function xi(n,r){n&1&&(l(0,"tr")(1,"th"),m(2,"Acciones"),s(),l(3,"th",16),m(4,"Nombre "),g(5,"p-sortIcon",17),s(),l(6,"th",18),m(7," Descripci\xF3n "),g(8,"p-sortIcon",19),s(),l(9,"th",20),m(10,"Autor "),g(11,"p-sortIcon",21),s(),l(12,"th",22),m(13," Cant. Elaboraciones "),g(14,"p-sortIcon",23),s(),l(15,"th",24),m(16," Cant. Ingredientes "),g(17,"p-sortIcon",25),s()())}function vi(n,r){if(n&1){let e=C();l(0,"tr")(1,"td")(2,"button",26),x("click",function(t){let o=f(e).$implicit,p=N(4),_=d();return h(_.generateMenu(o,p,t))}),s(),g(3,"p-menu",27,1),s(),l(5,"td"),m(6),s(),l(7,"td"),m(8),s(),l(9,"td"),m(10),s(),l(11,"td"),m(12),s(),l(13,"td"),m(14),s()()}if(n&2){let e=r.$implicit,i=d();a(3),c("popup",!0)("model",i.itemsMenu),a(3),I(e.nombre),a(2),I(e.descripcion),a(2),I(e.autor),a(2),I(e.elaboraciones),a(2),I(e.ingredientes)}}function yi(n,r){n&1&&(l(0,"tr")(1,"td",28),m(2," No se encontraron resultados "),s()()),n&2&&(a(),y("colspan",6))}function Ci(n,r){if(n&1&&(l(0,"div",29),m(1),s()),n&2){let e=d(),i=N(2);a(),k(" En total hay ",i.filteredValue?i.filteredValue.length:e.recetas.length," registros. ")}}var ni=(()=>{let r=class r{constructor(i,t,o,p){this.recetasService=i,this.router=t,this.toastr=o,this.confirmationDialogService=p,this.recetas=[],this.loading=!0,this.itemsMenu=[]}ngOnInit(){this.fetchAll()}fetchAll(){this.loading=!0,this.recetasService.get().subscribe(i=>{this.recetas=i,this.loading=!1})}get Routes(){return{NEW:`/${S.Receta}/${S.New}`}}generateMenu(i,t,o){t.toggle(o),this.itemsMenu=[{label:"Detalle",icon:"pi pi-eye",command:()=>{this.router.navigate([`/${S.Receta}/${S.Detail}/`,i.id])}},{label:"Editar",icon:"pi pi-pencil",command:()=>{this.router.navigate([`/${S.Receta}/${S.Edit}/`,i.id])}},{label:"Eliminar",icon:"pi pi-trash",command:()=>{this.delete(i)}}]}delete(i){this.confirmationDialogService.confirmDelete("\xBFEst\xE1 seguro que desea eliminar la receta?",()=>{this.recetasService.delete(i.id).subscribe(()=>{this.toastr.success("Se ha eliminado la receta"),this.fetchAll()})})}};r.\u0275fac=function(t){return new(t||r)(v(M),v(Z),v(X),v(Pt))},r.\u0275cmp=K({type:r,selectors:[["app-query"]],features:[G([M,vt,Ct])],decls:8,vars:11,consts:[["dt",""],["menu",""],[1,"card"],[3,"value","tableStyle","paginator","rows","rowsPerPageOptions","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"mb-4"],[1,"flex","align-items-center","justify-content-between","flex-wrap"],[1,"flex","gap-4","flex-wrap"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pRipple","","severity","primary","label","Agregar Receta","icon","pi pi-plus",1,"mr-2",3,"routerLink"],["pSortableColumn","nombre"],["field","nombre"],["pSortableColumn","descripcion"],["field","descripcion"],["pSortableColumn","autor"],["field","autor"],["pSortableColumn","elaboraciones"],["field","elaboraciones"],["pSortableColumn","ingredientes"],["field","ingredientes"],["pButton","","pRipple","","type","button","icon","pi pi-bars",1,"p-button-rounded","p-button-text",3,"click"],["appendTo","body",3,"popup","model"],[1,"text-center","py-4"],[1,"flex","align-items-center","justify-content-between"]],template:function(t,o){t&1&&(l(0,"div",2)(1,"p-table",3,0),u(3,bi,8,3,"ng-template",4)(4,xi,18,0,"ng-template",5)(5,vi,15,7,"ng-template",6)(6,yi,3,1,"ng-template",7)(7,Ci,2,1,"ng-template",8),s()()),t&2&&(a(),c("value",o.recetas)("tableStyle",w(7,ii))("paginator",!0)("rows",5)("tableStyle",w(8,ii))("rowsPerPageOptions",w(9,fi))("globalFilterFields",w(10,hi)))},dependencies:[Le,Ae,D,Re,Ne,Et,W,At,J],encapsulation:2});let n=r;return n})();var Ii=["input"],Si=(n,r,e,i)=>({"p-checkbox p-component":!0,"p-checkbox-checked":n,"p-checkbox-disabled":r,"p-checkbox-focused":e,"p-variant-filled":i}),wi=(n,r,e)=>({"p-highlight":n,"p-disabled":r,"p-focus":e}),Ti=(n,r,e)=>({"p-checkbox-label":!0,"p-checkbox-label-active":n,"p-disabled":r,"p-checkbox-label-focus":e});function Oi(n,r){if(n&1&&g(0,"span",10),n&2){let e=d(3);c("ngClass",e.checkboxIcon),y("data-pc-section","icon")}}function Fi(n,r){n&1&&g(0,"CheckIcon",11),n&2&&(c("styleClass","p-checkbox-icon"),y("data-pc-section","icon"))}function Ei(n,r){if(n&1&&(A(0),u(1,Oi,1,2,"span",8)(2,Fi,1,2,"CheckIcon",9),R()),n&2){let e=d(2);a(),c("ngIf",e.checkboxIcon),a(),c("ngIf",!e.checkboxIcon)}}function ki(n,r){}function Mi(n,r){n&1&&u(0,ki,0,0,"ng-template")}function Vi(n,r){if(n&1&&(l(0,"span",12),u(1,Mi,1,0,null,13),s()),n&2){let e=d(2);y("data-pc-section","icon"),a(),c("ngTemplateOutlet",e.checkboxIconTemplate)}}function Li(n,r){if(n&1&&(A(0),u(1,Ei,3,2,"ng-container",5)(2,Vi,2,2,"span",7),R()),n&2){let e=d();a(),c("ngIf",!e.checkboxIconTemplate),a(),c("ngIf",e.checkboxIconTemplate)}}function Di(n,r){if(n&1){let e=C();l(0,"label",14),x("click",function(t){f(e);let o=d(),p=N(3);return h(o.onClick(t,p,!0))}),m(1),s()}if(n&2){let e=d();re(e.labelStyleClass),c("ngClass",se(6,Ti,e.checked(),e.disabled,e.focused)),y("for",e.inputId)("data-pc-section","label"),a(),k(" ",e.label,"")}}var Pi={provide:Ie,useExisting:ge(()=>Ai),multi:!0},Ai=(()=>{class n{cd;injector;config;value;name;disabled;binary;label;ariaLabelledBy;ariaLabel;tabindex;inputId;style;styleClass;labelStyleClass;formControl;checkboxIcon;readonly;required;autofocus;trueValue=!0;falseValue=!1;variant="outlined";onChange=new j;onFocus=new j;onBlur=new j;inputViewChild;templates;checkboxIconTemplate;model;onModelChange=()=>{};onModelTouched=()=>{};focused=!1;constructor(e,i,t){this.cd=e,this.injector=i,this.config=t}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"icon":this.checkboxIconTemplate=e.template;break}})}onClick(e,i,t){e.preventDefault(),!(this.disabled||this.readonly)&&(this.updateModel(e),t&&i.focus())}updateModel(e){let i,t=this.injector.get(Mt,null,{optional:!0,self:!0}),o=t&&!this.formControl?t.value:this.model;this.binary?(i=this.checked()?this.falseValue:this.trueValue,this.model=i,this.onModelChange(i)):(this.checked()?i=o.filter(p=>!O.equals(p,this.value)):i=o?[...o,this.value]:[this.value],this.onModelChange(i),this.model=i,this.formControl&&this.formControl.setValue(i)),this.onChange.emit({checked:i,originalEvent:e})}handleChange(e){this.readonly||this.updateModel(e)}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.onBlur.emit(e),this.onModelTouched()}focus(){this.inputViewChild.nativeElement.focus()}writeValue(e){this.model=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){setTimeout(()=>{this.disabled=e,this.cd.markForCheck()})}checked(){return this.binary?this.model===this.trueValue:O.contains(this.value,this.model)}static \u0275fac=function(i){return new(i||n)(v(ve),v(st),v(Ce))};static \u0275cmp=K({type:n,selectors:[["p-checkbox"]],contentQueries:function(i,t,o){if(i&1&&ae(o,D,4),i&2){let p;F(p=E())&&(t.templates=p)}},viewQuery:function(i,t){if(i&1&&V(Ii,5),i&2){let o;F(o=E())&&(t.inputViewChild=o.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",name:"name",disabled:[2,"disabled","disabled",T],binary:[2,"binary","binary",T],label:"label",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",tabindex:[2,"tabindex","tabindex",_e],inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:[2,"readonly","readonly",T],required:[2,"required","required",T],autofocus:[2,"autofocus","autofocus",T],trueValue:"trueValue",falseValue:"falseValue",variant:"variant"},outputs:{onChange:"onChange",onFocus:"onFocus",onBlur:"onBlur"},features:[G([Pi]),be],decls:7,vars:37,consts:[["input",""],[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","checkbox","pAutoFocus","",3,"change","focus","blur","value","checked","disabled","readonly","autofocus"],[1,"p-checkbox-box",3,"click","ngClass"],[4,"ngIf"],[3,"class","ngClass","click",4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],["class","p-checkbox-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-checkbox-icon",3,"ngClass"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet"],[3,"click","ngClass"]],template:function(i,t){if(i&1){let o=C();l(0,"div",1)(1,"div",2)(2,"input",3,0),x("change",function(_){return f(o),h(t.handleChange(_))})("focus",function(_){return f(o),h(t.onInputFocus(_))})("blur",function(_){return f(o),h(t.onInputBlur(_))}),s()(),l(4,"div",4),x("click",function(_){f(o);let b=N(3);return h(t.onClick(_,b,!0))}),u(5,Li,3,2,"ng-container",5),s()(),u(6,Di,2,10,"label",6)}i&2&&(re(t.styleClass),c("ngStyle",t.style)("ngClass",ut(28,Si,t.checked(),t.disabled,t.focused,t.variant==="filled"||t.config.inputStyle()==="filled")),y("data-pc-name","checkbox")("data-pc-section","root"),a(),y("data-pc-section","hiddenInputWrapper")("data-p-hidden-accessible",!0),a(),c("value",t.value)("checked",t.checked())("disabled",t.disabled)("readonly",t.readonly)("autofocus",t.autofocus),y("id",t.inputId)("name",t.name)("tabindex",t.tabindex)("required",t.required)("aria-labelledby",t.ariaLabelledBy)("aria-label",t.ariaLabel)("aria-checked",t.checked())("data-pc-section","hiddenInput"),a(2),c("ngClass",se(33,wi,t.checked(),t.disabled,t.focused)),y("data-p-highlight",t.checked())("data-p-disabled",t.disabled)("data-p-focused",t.focused)("data-pc-section","input"),a(),c("ngIf",t.checked()),a(),c("ngIf",t.label))},dependencies:()=>[ce,z,ye,U,wt,ue],styles:[`@layer primeng{.p-checkbox{display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;vertical-align:bottom;position:relative}.p-checkbox-disabled{cursor:default!important;pointer-events:none}.p-checkbox-box{display:flex;justify-content:center;align-items:center}p-checkbox{display:inline-flex;vertical-align:bottom;align-items:center}.p-checkbox-label{line-height:1}}
`],encapsulation:2,changeDetection:0})}return n})(),oi=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ne({type:n});static \u0275inj=ie({imports:[de,Tt,ue,fe]})}return n})();var Ri=n=>[n],Ni=()=>({"min-width":"50rem"}),Ki=()=>[5,10,20],ji=()=>["nombre","cantidad","cantidadDisponible","tipo"];function Gi(n,r){if(n&1){let e=C();l(0,"div",16)(1,"h2",17),m(2,"Ingredientes"),s(),l(3,"div",18)(4,"span",19),g(5,"i",20),l(6,"input",21),x("input",function(t){f(e),d();let o=N(16);return h(o.filterGlobal(t.target.value,"contains"))}),s()()()()}}function Qi(n,r){n&1&&(l(0,"tr")(1,"th",22),m(2," Ingrediente "),g(3,"p-sortIcon",23),s(),l(4,"th",24),m(5,"Tipo "),g(6,"p-sortIcon",25),s(),l(7,"th",26),m(8," Cantidad "),g(9,"p-sortIcon",27),s(),l(10,"th",28),m(11," Disponible "),g(12,"p-sortIcon",29),s()())}function Hi(n,r){if(n&1&&(l(0,"tr")(1,"td"),m(2),s(),l(3,"td"),m(4),s(),l(5,"td"),m(6),s(),l(7,"td",30)(8,"b"),m(9),s()()()),n&2){let e=r.$implicit;a(2),k(" ",e.nombre," "),a(2),k(" ",e.tipo," "),a(2),xe("",e.cantidad," ",e.unidadMedida,""),a(),c("ngClass",e.cantidadDisponible>=e.cantidad?"text-green-400":"text-red-400"),a(2),xe("",e.cantidadDisponible," ",e.unidadMedida,"")}}function qi(n,r){n&1&&(l(0,"tr")(1,"td",31),m(2," No se encontraron resultados "),s()()),n&2&&(a(),y("colspan",6))}function $i(n,r){if(n&1&&(l(0,"div",3)(1,"div",4)(2,"h1",5),m(3),_t(4,"titlecase"),s()(),l(5,"span",6),g(6,"p-button",7),s(),l(7,"p",8),m(8),s(),l(9,"div",9)(10,"div",10)(11,"b"),m(12,"Autor:"),s(),m(13),s()(),l(14,"div")(15,"p-table",11,0),u(17,Gi,7,0,"ng-template",12)(18,Qi,13,0,"ng-template",13)(19,Hi,10,7,"ng-template",14)(20,qi,3,1,"ng-template",15),s()()()),n&2){let e=d();a(3),I(ft(4,13,e.receta.nombre)),a(3),c("text",!0)("routerLink",L(15,Ri,e.Routes.EDIT)),a(2),I(e.receta.descripcion),a(5),xe(" ",e.receta.autor.nombre," ",e.receta.autor.apellido," "),a(2),c("value",e.ingredientesNormal)("tableStyle",w(17,Ni))("paginator",!0)("rows",10)("rowsPerPageOptions",w(18,Ki))("globalFilterFields",w(19,ji))("alwaysShowPaginator",!1)}}var ri=(()=>{let r=class r{constructor(i,t,o,p){this.recetasService=i,this.router=t,this.toastr=o,this.activatedRoute=p,this.loading=!1,this.id=Number(this.activatedRoute.snapshot.paramMap.get("id"))}ngOnInit(){this.recetasService.detail(this.id).subscribe(i=>{this.receta=i,this.ingredientesNormal=this.receta.ingredientes.map(t=>({cantidad:t.cantidad,nombre:t.insumo?.nombre||t.materiaPrima?.nombre,unidadMedida:t.materiaPrima?.unidadMedida||t.insumo?.unidadMedida,tipo:t.insumo?"INSUMO":"MATERIA PRIMA",cantidadDisponible:t.insumo?.cantidadDisponible||t.materiaPrima.totalCantidadDisponible}))})}get Routes(){return{EDIT:`/${S.Receta}/${S.Edit}/${this.receta?.id}`}}back(){this.router.navigate(["/"+S.Receta,S.Query])}};r.\u0275fac=function(t){return new(t||r)(v(M),v(Z),v(X),v(Ve))},r.\u0275cmp=K({type:r,selectors:[["receta-detail"]],features:[G([M])],decls:2,vars:1,consts:[["dt",""],["pRipple","","label","Volver","icon","pi pi-arrow-left","styleClass","mb-2","severity","secondary",3,"click"],["class","card relative",4,"ngIf"],[1,"card","relative"],[1,"font-bold","mt-2"],[1,"p-card-title"],[1,"absolute",2,"top","5px","right","5px"],["pRipple","","severity","primary","label","Editar","icon","pi pi-pencil",1,"mr-2",3,"text","routerLink"],[1,"text-lg"],[1,"grid","text-lg"],[1,"col-6"],[3,"value","tableStyle","paginator","rows","rowsPerPageOptions","globalFilterFields","alwaysShowPaginator"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","align-items-center","justify-content-between","flex-wrap"],[1,"m-0"],[1,"flex","gap-4","flex-wrap"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pSortableColumn","nombre"],["field","nombre"],["pSortableColumn","tipo"],["field","tipo"],["pSortableColumn","cantidad"],["field","cantidad"],["pSortableColumn","cantidadDisponible"],["field","cantidadDisponible"],[3,"ngClass"],[1,"text-center","py-4"]],template:function(t,o){t&1&&(l(0,"p-button",1),x("click",function(){return o.back()}),s(),u(1,$i,21,20,"div",2)),t&2&&(a(),c("ngIf",!!o.receta))},dependencies:[ce,z,Le,Ae,D,Re,Ne,W,J,gt]});let n=r;return n})();var nn=["materiaPrimaDropdown"],on=["insumosDropdown"],rn=()=>({maxWidth:"1200px"}),an=()=>({width:"100%"}),li=()=>({height:"2.5rem"});function ln(n,r){if(n&1&&(l(0,"div",26),m(1),l(2,"div"),g(3,"i",27),s()()),n&2){let e=r.$implicit;a(),k(" ",e.nombre," ")}}function sn(n,r){if(n&1){let e=C();l(0,"div",28)(1,"span")(2,"b"),m(3),s()(),l(4,"div",29)(5,"p-inputGroup",30),g(6,"p-inputNumber",31),l(7,"p-inputGroupAddon"),m(8),s()(),l(9,"p-button",32),x("onClick",function(){let t=f(e).$implicit,o=d();return h(o.onDeleteMateriaPrima(t.id))}),s()()()}if(n&2){let e=r.$implicit,i=r.index;a(3),I(e.nombre),a(2),$(w(8,li)),a(),c("maxFractionDigits",2)("formControlName",i),a(2),I(e.unidadMedida),a(),c("rounded",!0)("text",!0)}}function cn(n,r){if(n&1&&(l(0,"div",26),m(1),l(2,"div"),g(3,"i",27),s()()),n&2){let e=r.$implicit;a(),k(" ",e.nombre," ")}}function pn(n,r){if(n&1){let e=C();l(0,"div",28)(1,"span")(2,"b"),m(3),s()(),l(4,"div",29)(5,"p-inputGroup",30),g(6,"p-inputNumber",31),l(7,"p-inputGroupAddon"),m(8),s()(),l(9,"p-button",32),x("onClick",function(){let t=f(e).$implicit,o=d();return h(o.onDeleteInsumo(t.id))}),s()()()}if(n&2){let e=r.$implicit,i=r.index;a(3),I(e.nombre),a(2),$(w(8,li)),a(),c("maxFractionDigits",2)("formControlName",i),a(2),I(e.unidadMedida),a(),c("rounded",!0)("text",!0)}}function ai(n){return n.value>0?null:{greaterThanZero:!0}}var si=(()=>{let r=class r{constructor(i,t,o,p,_){this.recetasService=i,this.materiaPrimaService=t,this.insumosService=o,this.router=p,this.toastr=_,this.loading=!1,this.allMateriasPrimas=[],this.allInsumos=[],this.selectedMateriasPrimas=[],this.selectedInsumos=[],this.form=new Oe({nombre:new Q("",[q.required,q.maxLength(256)]),descripcion:new Q("",q.maxLength(256)),materiasPrimas:new me([],q.required),insumos:new me([],q.required)})}ngOnInit(){this.materiaPrimaService.get().subscribe(i=>this.allMateriasPrimas=i),this.insumosService.get().subscribe(i=>this.allInsumos=i)}onSubmit(){if(this.form.markAllAsTouched(),!this.form.valid)return;let i=this.form.getRawValue(),t=this.selectedInsumos.map((b,P)=>({insumoId:b.id,materiaPrimaId:null,cantidad:i.insumos[P]})),o=this.selectedMateriasPrimas.map((b,P)=>({materiaPrimaId:b.id,insumoId:null,cantidad:i.materiasPrimas[P]})),p=[...t,...o],_={nombre:i.nombre,descripcion:i.descripcion,ingredientes:p};this.loading=!0,this.recetasService.create(_).subscribe(b=>{this.toastr.success("Se ha agregado la receta"),this.router.navigate(["/"+S.Receta,S.Query])})}get filteredInsumos(){let i=this.selectedInsumos.map(t=>t.id);return this.allInsumos.filter(t=>!i.includes(t.id))}get filteredMateriasPrimas(){let i=this.selectedMateriasPrimas.map(t=>t.id);return this.allMateriasPrimas.filter(t=>!i.includes(t.id))}getMateriasPrimasFormArr(){return this.form.get("materiasPrimas")}onSelectMateriaPrima(i){let t=i.value;t&&(this.selectedMateriasPrimas.find(o=>o.id==t.id)||(this.selectedMateriasPrimas.push({id:t.id,nombre:t.nombre,cantidad:0,unidadMedida:t.unidadMedida}),this.getMateriasPrimasFormArr().push(new Q("",ai))),this.materiaPrimaDropdown.clear())}onDeleteMateriaPrima(i){let t=this.selectedMateriasPrimas.findIndex(o=>o.id==i);t>-1&&(this.selectedMateriasPrimas.splice(t,1),this.getMateriasPrimasFormArr().removeAt(t))}getInsumosArr(){return this.form.get("insumos")}onSelectInsumo(i){let t=i.value;t&&(this.selectedInsumos.find(o=>o.id==t.id)||(this.selectedInsumos.push({id:t.id,nombre:t.nombre,cantidad:0,unidadMedida:t.unidadMedida}),this.getInsumosArr().push(new Q("",ai))),this.insumosDropdown.clear())}onDeleteInsumo(i){let t=this.selectedInsumos.findIndex(o=>o.id==i);t>-1&&(this.selectedInsumos.splice(t,1),this.getInsumosArr().removeAt(t))}cancel(){this.router.navigate(["/"+S.Receta,S.Query])}};r.\u0275fac=function(t){return new(t||r)(v(M),v(Y),v(ee),v(Z),v(X))},r.\u0275cmp=K({type:r,selectors:[["app-new"]],viewQuery:function(t,o){if(t&1&&(V(nn,5),V(on,5)),t&2){let p;F(p=E())&&(o.materiaPrimaDropdown=p.first),F(p=E())&&(o.insumosDropdown=p.first)}},features:[G([M,Y,ee])],decls:47,vars:22,consts:[["materiaPrimaDropdown",""],["insumosDropdown",""],["pRipple","","label","Volver","icon","pi pi-arrow-left","styleClass","mb-2","severity","secondary",3,"click"],[1,"card",3,"ngStyle"],[1,"mb-5","m-2"],[1,"p-fluid","p-formgrid","grid",3,"ngSubmit","formGroup"],[1,"field","col-12","md:col-12"],["htmlFor","nombre"],["pInputText","","id","firstname2","type","text","placeholder","Nombre","formControlName","nombre","appCustomInputError","",3,"errors"],["customLabel","",3,"valueForm","errors"],["htmlFor","descripcion"],["pInputText","","id","descripcion","type","text","placeholder","Descripcion","formControlName","descripcion","appCustomInputError","",3,"errors"],["styleClass","my-0 w-full",3,"ngStyle"],[1,"my-4","field","col-12","md:col-12"],[1,"text-500"],[1,"grid","w-full","field","col-12"],[1,"col"],["htmlFor","familiaPrimaId",1,"mr-3"],["placeholder","Selecciona una materia prima","optionLabel","nombre","filterBy","nombre",3,"onChange","options","autoDisplayFirst","filter","showClear"],["pTemplate","item"],["formArrayName","materiasPrimas",1,"flex","flex-column","gap-1","mt-2"],["class","shadow-1 px-2 pl-2 pr-1 flex justify-content-between align-items-center border-round-md",4,"ngFor","ngForOf"],["placeholder","Selecciona un insumos","optionLabel","nombre","filterBy","nombre",3,"onChange","options","autoDisplayFirst","filter","showClear"],["formArrayName","insumos",1,"flex","flex-column","gap-1","mt-2"],[1,"ml-auto","mt-2"],["label","Guardar","size","large","type","submit",3,"disabled"],[1,"flex","align-items-center","justify-content-between","gap-2"],[1,"fa-solid","fa-plus","text-lg","opacity-50"],[1,"shadow-1","px-2","pl-2","pr-1","flex","justify-content-between","align-items-center","border-round-md"],[1,"flex","gap-2","align-items-center"],[1,"w-10rem"],["placeholder","Cantidad","size","2",3,"maxFractionDigits","formControlName"],["pRipple","","icon","pi pi-trash","severity","secondary",3,"onClick","rounded","text"]],template:function(t,o){if(t&1){let p=C();l(0,"p-button",2),x("click",function(){return f(p),h(o.cancel())}),s(),l(1,"div",3)(2,"h5",4),m(3,"Agregar receta"),s(),l(4,"form",5),x("ngSubmit",function(){return f(p),h(o.onSubmit())}),l(5,"div",6)(6,"h5"),m(7,"Detalles"),s(),l(8,"label",7),m(9,"Nombre"),s(),g(10,"input",8)(11,"span",9),s(),l(12,"div",6)(13,"label",10),m(14,"Descripci\xF3n"),s(),g(15,"input",11)(16,"span",9),s(),g(17,"p-divider",12),l(18,"div",13)(19,"h5"),m(20,"Ingredientes"),s(),l(21,"p",14),m(22," Los ingredientes deben estar especificados para la elaboraci\xF3n de "),l(23,"b"),m(24,"una unidad"),s(),m(25," del producto final. "),g(26,"br"),m(27," Debes incluir al menos un ingrediente de cada tipo: materia prima y receta. "),s()(),l(28,"div",15)(29,"div",16)(30,"label",17),m(31,"Materias Primas"),s(),l(32,"p-dropdown",18,0),x("onChange",function(b){return f(p),h(o.onSelectMateriaPrima(b))}),u(34,ln,4,1,"ng-template",19),s(),l(35,"div",20),u(36,sn,10,9,"div",21),s()(),l(37,"div",16)(38,"label",17),m(39,"Insumos"),s(),l(40,"p-dropdown",22,1),x("onChange",function(b){return f(p),h(o.onSelectInsumo(b))}),u(42,cn,4,1,"ng-template",19),s(),l(43,"div",23),u(44,pn,10,9,"div",21),s()()(),l(45,"span",24),g(46,"p-button",25),s()()()}if(t&2){let p,_,b,P,nt,ot;a(),c("ngStyle",w(20,rn)),a(3),c("formGroup",o.form),a(6),c("errors",(p=o.form.get("nombre"))==null?null:p.errors),a(),c("valueForm",(_=o.form.get("nombre"))==null?null:_.value)("errors",(b=o.form.get("nombre"))==null?null:b.errors),a(4),c("errors",(P=o.form.get("descripcion"))==null?null:P.errors),a(),c("valueForm",(nt=o.form.get("descripcion"))==null?null:nt.value)("errors",(ot=o.form.get("descripcion"))==null?null:ot.errors),a(),c("ngStyle",w(21,an)),a(15),c("options",o.filteredMateriasPrimas)("autoDisplayFirst",!1)("filter",!0)("showClear",!0),a(4),c("ngForOf",o.selectedMateriasPrimas),a(4),c("options",o.filteredInsumos)("autoDisplayFirst",!1)("filter",!0)("showClear",!0),a(4),c("ngForOf",o.selectedInsumos),a(2),c("disabled",o.form.invalid)}},dependencies:[pe,U,D,W,J,De,Fe,Se,we,Te,Ee,Me,ke,je,Ge,Qe,Pe,Ke,He]});let n=r;return n})();var dn=["headerchkbox"],mn=["filter"],un=["lastHiddenFocusableElement"],_n=["firstHiddenFocusableElement"],fn=["scroller"],hn=["list"],gn=[[["p-header"]],[["p-footer"]]],bn=["p-header","p-footer"],Be=(n,r)=>({$implicit:n,options:r}),ci=n=>({"p-checkbox-disabled":n}),xn=(n,r,e)=>({"p-highlight":n,"p-focus":r,"p-disabled":e}),pi=n=>({options:n}),it=n=>({height:n}),vn=()=>({}),yn=n=>({$implicit:n}),Cn=(n,r,e)=>({"p-listbox-item":!0,"p-highlight":n,"p-focus":r,"p-disabled":e}),In=(n,r)=>({$implicit:n,index:r}),Sn=n=>({"p-highlight":n});function wn(n,r){n&1&&H(0)}function Tn(n,r){if(n&1&&(l(0,"div",19),Ue(1),u(2,wn,1,0,"ng-container",20),s()),n&2){let e=d();a(2),c("ngTemplateOutlet",e.headerTemplate)("ngTemplateOutletContext",le(2,Be,e.modelValue(),e.visibleOptions()))}}function On(n,r){n&1&&g(0,"CheckIcon",29),n&2&&(c("styleClass","p-checkbox-icon"),y("aria-hidden",!0))}function Fn(n,r){}function En(n,r){n&1&&u(0,Fn,0,0,"ng-template")}function kn(n,r){if(n&1&&(l(0,"span",30),u(1,En,1,0,null,31),s()),n&2){let e=d(4);y("aria-hidden",!0),a(),c("ngTemplateOutlet",e.checkIconTemplate)}}function Mn(n,r){if(n&1&&(A(0),u(1,On,1,2,"CheckIcon",27)(2,kn,2,2,"span",28),R()),n&2){let e=d(3);a(),c("ngIf",!e.checkIconTemplate),a(),c("ngIf",e.checkIconTemplate)}}function Vn(n,r){if(n&1){let e=C();l(0,"div",23),x("click",function(t){f(e);let o=d(2);return h(o.onToggleAll(t))})("keydown",function(t){f(e);let o=d(2);return h(o.onHeaderCheckboxKeyDown(t))}),l(1,"div",24)(2,"input",25,4),x("focus",function(t){f(e);let o=d(2);return h(o.onHeaderCheckboxFocus(t))})("blur",function(t){f(e);let o=d(2);return h(o.onHeaderCheckboxBlur(t))}),s()(),l(4,"div",26),u(5,Mn,3,2,"ng-container",15),s()()}if(n&2){let e=d(2);c("ngClass",L(8,ci,e.disabled||e.toggleAllDisabled)),a(),y("data-p-hidden-accessible",!0),a(),c("disabled",e.disabled||e.toggleAllDisabled),y("checked",e.allSelected())("aria-label",e.toggleAllAriaLabel),a(2),c("ngClass",se(10,xn,e.allSelected(),e.headerCheckboxFocus,e.disabled||e.toggleAllDisabled)),y("aria-checked",e.allSelected()),a(),c("ngIf",e.allSelected())}}function Ln(n,r){n&1&&H(0)}function Dn(n,r){if(n&1&&(A(0),u(1,Ln,1,0,"ng-container",20),R()),n&2){let e=d(2);a(),c("ngTemplateOutlet",e.filterTemplate)("ngTemplateOutletContext",L(2,pi,e.filterOptions))}}function Pn(n,r){n&1&&g(0,"SearchIcon",29),n&2&&(c("styleClass","p-listbox-filter-icon"),y("aria-hidden",!0))}function An(n,r){}function Rn(n,r){n&1&&u(0,An,0,0,"ng-template")}function Nn(n,r){if(n&1&&(l(0,"span",37),u(1,Rn,1,0,null,31),s()),n&2){let e=d(4);y("aria-hidden",!0),a(),c("ngTemplateOutlet",e.filterIconTemplate)}}function Kn(n,r){if(n&1){let e=C();l(0,"div",34)(1,"input",35,5),x("input",function(t){f(e);let o=d(3);return h(o.onFilterChange(t))})("keydown",function(t){f(e);let o=d(3);return h(o.onFilterKeyDown(t))})("blur",function(t){f(e);let o=d(3);return h(o.onFilterBlur(t))}),s(),u(3,Pn,1,2,"SearchIcon",27)(4,Nn,2,2,"span",36),s()}if(n&2){let e=d(3);a(),c("value",e._filterValue()||"")("disabled",e.disabled)("tabindex",!e.disabled&&!e.focused?e.tabindex:-1),y("aria-owns",e.id+"_list")("aria-activedescendant",e.focusedOptionId)("placeholder",e.filterPlaceHolder)("aria-label",e.ariaFilterLabel),a(2),c("ngIf",!e.filterIconTemplate),a(),c("ngIf",e.filterIconTemplate)}}function jn(n,r){if(n&1&&(u(0,Kn,5,9,"div",32),l(1,"span",33),m(2),s()),n&2){let e=d(2);c("ngIf",e.filter),a(),y("data-p-hidden-accessible",!0),a(),k(" ",e.filterResultMessageText," ")}}function Gn(n,r){if(n&1&&(l(0,"div",19),u(1,Vn,6,14,"div",21)(2,Dn,2,4,"ng-container",22)(3,jn,3,3,"ng-template",null,3,We),s()),n&2){let e=N(4),i=d();a(),c("ngIf",i.checkbox&&i.multiple&&i.showToggleAll),a(),c("ngIf",i.filterTemplate)("ngIfElse",e)}}function Qn(n,r){n&1&&H(0)}function Hn(n,r){if(n&1&&u(0,Qn,1,0,"ng-container",20),n&2){let e=r.$implicit,i=r.options;d(2);let t=N(9);c("ngTemplateOutlet",t)("ngTemplateOutletContext",le(2,Be,e,i))}}function qn(n,r){n&1&&H(0)}function $n(n,r){if(n&1&&u(0,qn,1,0,"ng-container",20),n&2){let e=r.options,i=d(3);c("ngTemplateOutlet",i.loaderTemplate)("ngTemplateOutletContext",L(2,pi,e))}}function Bn(n,r){n&1&&(A(0),u(1,$n,1,4,"ng-template",40),R())}function zn(n,r){if(n&1){let e=C();l(0,"p-scroller",38,6),x("onLazyLoad",function(t){f(e);let o=d();return h(o.onLazyLoad.emit(t))}),u(2,Hn,1,5,"ng-template",39)(3,Bn,2,0,"ng-container",15),s()}if(n&2){let e=d();$(L(9,it,e.scrollHeight)),c("items",e.visibleOptions())("itemSize",e.virtualScrollItemSize)("autoSize",!0)("tabindex",-1)("lazy",e.lazy)("options",e.virtualScrollOptions),a(3),c("ngIf",e.loaderTemplate)}}function Un(n,r){n&1&&H(0)}function Wn(n,r){if(n&1&&(A(0),u(1,Un,1,0,"ng-container",20),R()),n&2){let e=d(),i=N(9);a(),c("ngTemplateOutlet",i)("ngTemplateOutletContext",le(3,Be,e.visibleOptions(),w(2,vn)))}}function Zn(n,r){if(n&1&&(l(0,"span"),m(1),s()),n&2){let e=d(2).$implicit,i=d(2);a(),I(i.getOptionGroupLabel(e.optionGroup))}}function Xn(n,r){n&1&&H(0)}function Jn(n,r){if(n&1&&(A(0),l(1,"li",44),u(2,Zn,2,1,"span",15)(3,Xn,1,0,"ng-container",20),s(),R()),n&2){let e=d(),i=e.$implicit,t=e.index,o=d().options,p=d();a(),c("ngStyle",L(5,it,o.itemSize+"px")),y("id",p.id+"_"+p.getOptionIndex(t,o)),a(),c("ngIf",!p.groupTemplate),a(),c("ngTemplateOutlet",p.groupTemplate)("ngTemplateOutletContext",L(7,yn,i.optionGroup))}}function Yn(n,r){n&1&&g(0,"CheckIcon",29),n&2&&(c("styleClass","p-checkbox-icon"),y("aria-hidden",!0))}function eo(n,r){}function to(n,r){n&1&&u(0,eo,0,0,"ng-template")}function io(n,r){if(n&1&&(l(0,"span",30),u(1,to,1,0,null,31),s()),n&2){let e=d(6);y("aria-hidden",!0),a(),c("ngTemplateOutlet",e.checkIconTemplate)}}function no(n,r){if(n&1&&(A(0),u(1,Yn,1,2,"CheckIcon",27)(2,io,2,2,"span",28),R()),n&2){let e=d(5);a(),c("ngIf",!e.checkIconTemplate),a(),c("ngIf",e.checkIconTemplate)}}function oo(n,r){if(n&1&&(l(0,"div",47)(1,"div",48),u(2,no,3,2,"ng-container",15),s()()),n&2){let e=d(2).$implicit,i=d(2);c("ngClass",L(3,ci,i.disabled||i.isOptionDisabled(e))),a(),c("ngClass",L(5,Sn,i.isSelected(e))),a(),c("ngIf",i.isSelected(e))}}function ro(n,r){if(n&1&&(l(0,"span"),m(1),s()),n&2){let e=d(2).$implicit,i=d(2);a(),I(i.getOptionLabel(e))}}function ao(n,r){n&1&&H(0)}function lo(n,r){if(n&1){let e=C();A(0),l(1,"li",45),x("click",function(t){f(e);let o=d(),p=o.$implicit,_=o.index,b=d().options,P=d();return h(P.onOptionSelect(t,p,P.getOptionIndex(_,b)))})("dblclick",function(t){f(e);let o=d().$implicit,p=d(2);return h(p.onOptionDoubleClick(t,o))})("mousedown",function(t){f(e);let o=d().index,p=d().options,_=d();return h(_.onOptionMouseDown(t,_.getOptionIndex(o,p)))})("mouseenter",function(t){f(e);let o=d().index,p=d().options,_=d();return h(_.onOptionMouseEnter(t,_.getOptionIndex(o,p)))})("touchend",function(){f(e);let t=d(3);return h(t.onOptionTouchEnd())}),u(2,oo,3,7,"div",46)(3,ro,2,1,"span",15)(4,ao,1,0,"ng-container",20),s(),R()}if(n&2){let e=d(),i=e.$implicit,t=e.index,o=d().options,p=d();a(),c("ngStyle",L(12,it,o.itemSize+"px"))("ngClass",se(14,Cn,p.isSelected(i),p.focusedOptionIndex()===p.getOptionIndex(t,o),p.isOptionDisabled(i))),y("id",p.id+"_"+p.getOptionIndex(t,o))("aria-label",p.getOptionLabel(i))("aria-selected",p.isSelected(i))("aria-disabled",p.isOptionDisabled(i))("aria-setsize",p.ariaSetSize)("ariaPosInset",p.getAriaPosInset(p.getOptionIndex(t,o))),a(),c("ngIf",p.checkbox&&p.multiple),a(),c("ngIf",!p.itemTemplate),a(),c("ngTemplateOutlet",p.itemTemplate)("ngTemplateOutletContext",le(18,In,i,p.getOptionIndex(t,o)))}}function so(n,r){if(n&1&&u(0,Jn,4,9,"ng-container",15)(1,lo,5,21,"ng-container",15),n&2){let e=r.$implicit,i=d(2);c("ngIf",i.isOptionGroup(e)),a(),c("ngIf",!i.isOptionGroup(e))}}function co(n,r){if(n&1&&(A(0),m(1),R()),n&2){let e=d(3);a(),k(" ",e.emptyFilterMessageText," ")}}function po(n,r){n&1&&H(0,null,8)}function mo(n,r){if(n&1&&(l(0,"li",49),u(1,co,2,1,"ng-container",22)(2,po,2,0,"ng-container",31),s()),n&2){let e=d(2);a(),c("ngIf",!e.emptyFilterTemplate&&!e.emptyTemplate)("ngIfElse",e.emptyFilter),a(),c("ngTemplateOutlet",e.emptyFilterTemplate||e.emptyTemplate)}}function uo(n,r){if(n&1&&(A(0),m(1),R()),n&2){let e=d(3);a(),k(" ",e.emptyMessage," ")}}function _o(n,r){n&1&&H(0,null,9)}function fo(n,r){if(n&1&&(l(0,"li",49),u(1,uo,2,1,"ng-container",22)(2,_o,2,0,"ng-container",31),s()),n&2){let e=d(2);a(),c("ngIf",!e.emptyTemplate)("ngIfElse",e.empty),a(),c("ngTemplateOutlet",e.emptyTemplate)}}function ho(n,r){if(n&1){let e=C();l(0,"ul",41,7),x("focus",function(t){f(e);let o=d();return h(o.onListFocus(t))})("blur",function(t){f(e);let o=d();return h(o.onListBlur(t))})("keydown",function(t){f(e);let o=d();return h(o.onListKeyDown(t))}),u(2,so,2,2,"ng-template",42)(3,mo,3,3,"li",43)(4,fo,3,3,"li",43),s()}if(n&2){let e=r.$implicit,i=r.options,t=d();$(i.contentStyle),c("tabindex",-1)("ngClass",i.contentStyleClass),y("aria-multiselectable",!0)("aria-activedescendant",t.focused?t.focusedOptionId:void 0)("aria-label",t.ariaLabel)("aria-multiselectable",t.multiple)("aria-disabled",t.disabled),a(2),c("ngForOf",e),a(),c("ngIf",t.hasFilter()&&t.isEmpty()),a(),c("ngIf",!t.hasFilter()&&t.isEmpty())}}function go(n,r){n&1&&H(0)}function bo(n,r){if(n&1&&(l(0,"div",50),Ue(1,1),u(2,go,1,0,"ng-container",20),s()),n&2){let e=d();a(2),c("ngTemplateOutlet",e.footerTemplate)("ngTemplateOutletContext",le(2,Be,e.modelValue(),e.visibleOptions()))}}function xo(n,r){if(n&1&&(l(0,"span",18),m(1),s()),n&2){let e=d();a(),k(" ",e.emptyMessage," ")}}var vo={provide:Ie,useExisting:ge(()=>yo),multi:!0},yo=(()=>{class n{el;cd;filterService;config;renderer;id;searchMessage;emptySelectionMessage;selectionMessage;autoOptionFocus=!0;ariaLabel;selectOnFocus;searchLocale;focusOnHover;filterMessage;filterFields;lazy=!1;virtualScroll;virtualScrollItemSize;virtualScrollOptions;scrollHeight="200px";tabindex=0;multiple;style;styleClass;listStyle;listStyleClass;readonly;disabled;checkbox=!1;filter=!1;filterBy;filterMatchMode="contains";filterLocale;metaKeySelection=!1;dataKey;showToggleAll=!0;optionLabel;optionValue;optionGroupChildren="items";optionGroupLabel="label";optionDisabled;ariaFilterLabel;filterPlaceHolder;emptyFilterMessage;emptyMessage;group;get options(){return this._options()}set options(e){this._options.set(e)}get filterValue(){return this._filterValue()}set filterValue(e){this._filterValue.set(e)}get selectAll(){return this._selectAll}set selectAll(e){this._selectAll=e}onChange=new j;onClick=new j;onDblClick=new j;onFilter=new j;onFocus=new j;onBlur=new j;onSelectAllChange=new j;headerCheckboxViewChild;filterViewChild;lastHiddenFocusableElement;firstHiddenFocusableElement;scroller;listViewChild;headerFacet;footerFacet;templates;itemTemplate;groupTemplate;headerTemplate;filterTemplate;footerTemplate;emptyFilterTemplate;emptyTemplate;filterIconTemplate;checkIconTemplate;_filterValue=oe(null);_filteredOptions;filterOptions;filtered;value;onModelChange=()=>{};onModelTouched=()=>{};optionTouched;focus;headerCheckboxFocus;translationSubscription;focused;get containerClass(){return{"p-listbox p-component":!0,"p-disabled":this.disabled}}get focusedOptionId(){return this.focusedOptionIndex()!==-1?`${this.id}_${this.focusedOptionIndex()}`:null}get filterResultMessageText(){return O.isNotEmpty(this.visibleOptions())?this.filterMessageText.replaceAll("{0}",this.visibleOptions().length):this.emptyFilterMessageText}get filterMessageText(){return this.filterMessage||this.config.translation.searchMessage||""}get searchMessageText(){return this.searchMessage||this.config.translation.searchMessage||""}get emptyFilterMessageText(){return this.emptyFilterMessage||this.config.translation.emptySearchMessage||this.config.translation.emptyFilterMessage||""}get selectionMessageText(){return this.selectionMessage||this.config.translation.selectionMessage||""}get emptySelectionMessageText(){return this.emptySelectionMessage||this.config.translation.emptySelectionMessage||""}get selectedMessageText(){return this.hasSelectedOption()?this.selectionMessageText.replaceAll("{0}",this.multiple?this.modelValue().length:"1"):this.emptySelectionMessageText}get ariaSetSize(){return this.visibleOptions().filter(e=>!this.isOptionGroup(e)).length}get virtualScrollerDisabled(){return!this.virtualScroll}get searchFields(){return this.filterFields||[this.optionLabel]}get toggleAllAriaLabel(){return this.config.translation.aria?this.config.translation.aria[this.allSelected()?"selectAll":"unselectAll"]:void 0}searchValue;searchTimeout;_selectAll=null;_options=oe(null);startRangeIndex=oe(-1);focusedOptionIndex=oe(-1);modelValue=oe(null);visibleOptions=ht(()=>{let e=this.group?this.flatOptions(this._options()):this._options()||[];return this._filterValue()?this.filterService.filter(e,this.searchFields,this._filterValue(),this.filterMatchMode,this.filterLocale):e});constructor(e,i,t,o,p){this.el=e,this.cd=i,this.filterService=t,this.config=o,this.renderer=p}ngOnInit(){this.id=this.id||xt(),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()}),this.autoUpdateModel(),this.filterBy&&(this.filterOptions={filter:e=>this.onFilterChange(e),reset:()=>this.resetFilter()})}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":this.itemTemplate=e.template;break;case"group":this.groupTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"filter":this.filterTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"emptyfilter":this.emptyFilterTemplate=e.template;break;case"filtericon":this.filterIconTemplate=e.template;break;case"checkicon":this.checkIconTemplate=e.template;break;default:this.itemTemplate=e.template;break}})}writeValue(e){this.value=e,this.modelValue.set(this.value),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}flatOptions(e){return(e||[]).reduce((i,t,o)=>{i.push({optionGroup:t,group:!0,index:o});let p=this.getOptionGroupChildren(t);return p&&p.forEach(_=>i.push(_)),i},[])}autoUpdateModel(){if(this.selectOnFocus&&this.autoOptionFocus&&!this.hasSelectedOption()&&!this.multiple){let e=this.findFirstFocusedOptionIndex();this.focusedOptionIndex.set(e),this.onOptionSelect(null,this.visibleOptions()[this.focusedOptionIndex()])}}updateModel(e,i){this.value=e,this.modelValue.set(e),this.onModelChange(e),this.onChange.emit({originalEvent:i,value:this.value})}removeOption(e){return this.modelValue().filter(i=>!O.equals(i,this.getOptionValue(e),this.equalityKey()))}onOptionSelect(e,i,t=-1){this.disabled||this.isOptionDisabled(i)||this.readonly||(e&&this.onClick.emit({originalEvent:e,option:i,value:this.value}),this.multiple?this.onOptionSelectMultiple(e,i):this.onOptionSelectSingle(e,i),this.optionTouched=!1,t!==-1&&this.focusedOptionIndex.set(t))}onOptionSelectMultiple(e,i){let t=this.isSelected(i),o=null;if(this.optionTouched?!1:this.metaKeySelection){let _=e.metaKey||e.ctrlKey;t?o=_?this.removeOption(i):[this.getOptionValue(i)]:(o=_?this.modelValue()||[]:[],o=[...o,this.getOptionValue(i)])}else o=t?this.removeOption(i):[...this.modelValue()||[],this.getOptionValue(i)];this.updateModel(o,e)}onOptionSelectSingle(e,i){let t=this.isSelected(i),o=!1,p=null;if(this.optionTouched?!1:this.metaKeySelection){let b=e.metaKey||e.ctrlKey;t?b&&(p=null,o=!0):(p=this.getOptionValue(i),o=!0)}else p=t?null:this.getOptionValue(i),o=!0;o&&this.updateModel(p,e)}onOptionSelectRange(e,i=-1,t=-1){if(i===-1&&(i=this.findNearestSelectedOptionIndex(t,!0)),t===-1&&(t=this.findNearestSelectedOptionIndex(i)),i!==-1&&t!==-1){let o=Math.min(i,t),p=Math.max(i,t),_=this.visibleOptions().slice(o,p+1).filter(b=>this.isValidOption(b)).map(b=>this.getOptionValue(b));this.updateModel(_,e)}}onToggleAll(e){if(!(this.disabled||this.readonly)){if(B.focus(this.headerCheckboxViewChild.nativeElement),this.selectAll!==null)this.onSelectAllChange.emit({originalEvent:e,checked:!this.allSelected()});else{let i=this.allSelected()?[]:this.visibleOptions().filter(t=>this.isValidOption(t)).map(t=>this.getOptionValue(t));this.updateModel(i,e)}e.preventDefault()}}allSelected(){return this.selectAll!==null?this.selectAll:O.isNotEmpty(this.visibleOptions())&&this.visibleOptions().every(e=>this.isOptionGroup(e)||this.isOptionDisabled(e)||this.isSelected(e))}onOptionTouchEnd(){this.disabled||(this.optionTouched=!0)}onOptionMouseDown(e,i){this.changeFocusedOptionIndex(e,i)}onOptionMouseEnter(e,i){this.focusOnHover&&this.changeFocusedOptionIndex(e,i)}onOptionDoubleClick(e,i){this.disabled||this.isOptionDisabled(i)||this.readonly||this.onDblClick.emit({originalEvent:e,option:i,value:this.value})}onFirstHiddenFocus(e){B.focus(this.listViewChild.nativeElement);let i=B.getFirstFocusableElement(this.el.nativeElement,':not([data-p-hidden-focusable="true"])');this.lastHiddenFocusableElement.nativeElement.tabIndex=O.isEmpty(i)?"-1":void 0,this.firstHiddenFocusableElement.nativeElement.tabIndex=-1}onLastHiddenFocus(e){if(e.relatedTarget===this.listViewChild.nativeElement){let t=B.getFirstFocusableElement(this.el.nativeElement,":not(.p-hidden-focusable)");B.focus(t),this.firstHiddenFocusableElement.nativeElement.tabIndex=void 0}else B.focus(this.firstHiddenFocusableElement.nativeElement);this.lastHiddenFocusableElement.nativeElement.tabIndex=-1}onFocusout(e){!this.el.nativeElement.contains(e.relatedTarget)&&this.lastHiddenFocusableElement&&this.firstHiddenFocusableElement&&(this.firstHiddenFocusableElement.nativeElement.tabIndex=this.lastHiddenFocusableElement.nativeElement.tabIndex=void 0)}onListFocus(e){this.focused=!0;let i=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(i),this.onFocus.emit(e)}onListBlur(e){this.focused=!1,this.focusedOptionIndex.set(-1),this.startRangeIndex.set(-1),this.searchValue=""}onHeaderCheckboxFocus(e){this.headerCheckboxFocus=!0}onHeaderCheckboxBlur(){this.headerCheckboxFocus=!1}onHeaderCheckboxKeyDown(e){if(this.disabled){e.preventDefault();return}switch(e.code){case"Space":this.onToggleAll(e);break;case"Enter":this.onToggleAll(e);break;case"Tab":this.onHeaderCheckboxTabKeyDown(e);break;default:break}}onHeaderCheckboxTabKeyDown(e){B.focus(this.listViewChild.nativeElement),e.preventDefault()}onFilterChange(e){let i=e.target.value?.trim();this._filterValue.set(i),this.focusedOptionIndex.set(-1),this.startRangeIndex.set(-1),this.onFilter.emit({originalEvent:e,filter:this._filterValue()}),!this.virtualScrollerDisabled&&this.scroller.scrollToIndex(0)}onFilterBlur(e){this.focusedOptionIndex.set(-1),this.startRangeIndex.set(-1)}onListKeyDown(e){let i=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Enter":case"Space":case"NumpadEnter":this.onSpaceKey(e);break;case"Tab":break;case"ShiftLeft":case"ShiftRight":this.onShiftKey();break;default:if(this.multiple&&e.code==="KeyA"&&i){let t=this.visibleOptions().filter(o=>this.isValidOption(o)).map(o=>this.getOptionValue(o));this.updateModel(t,e),e.preventDefault();break}!i&&O.isPrintableCharacter(e.key)&&(this.searchOptions(e,e.key),e.preventDefault());break}}onFilterKeyDown(e){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,!0);break;case"Home":this.onHomeKey(e,!0);break;case"End":this.onEndKey(e,!0);break;case"Enter":this.onEnterKey(e);break;case"ShiftLeft":case"ShiftRight":this.onShiftKey();break;default:break}}onArrowDownKey(e){let i=this.focusedOptionIndex()!==-1?this.findNextOptionIndex(this.focusedOptionIndex()):this.findFirstFocusedOptionIndex();this.multiple&&e.shiftKey&&this.onOptionSelectRange(e,this.startRangeIndex(),i),this.changeFocusedOptionIndex(e,i),e.preventDefault()}onArrowUpKey(e){let i=this.focusedOptionIndex()!==-1?this.findPrevOptionIndex(this.focusedOptionIndex()):this.findLastFocusedOptionIndex();this.multiple&&e.shiftKey&&this.onOptionSelectRange(e,i,this.startRangeIndex()),this.changeFocusedOptionIndex(e,i),e.preventDefault()}onArrowLeftKey(e,i=!1){i&&this.focusedOptionIndex.set(-1)}onHomeKey(e,i=!1){if(i)e.currentTarget.setSelectionRange(0,0),this.focusedOptionIndex.set(-1);else{let t=e.metaKey||e.ctrlKey,o=this.findFirstOptionIndex();this.multiple&&e.shiftKey&&t&&this.onOptionSelectRange(e,o,this.startRangeIndex()),this.changeFocusedOptionIndex(e,o)}e.preventDefault()}onEndKey(e,i=!1){if(i){let t=e.currentTarget,o=t.value.length;t.setSelectionRange(o,o),this.focusedOptionIndex.set(-1)}else{let t=e.metaKey||e.ctrlKey,o=this.findLastOptionIndex();this.multiple&&e.shiftKey&&t&&this.onOptionSelectRange(e,this.startRangeIndex(),o),this.changeFocusedOptionIndex(e,o)}e.preventDefault()}onPageDownKey(e){this.scrollInView(0),e.preventDefault()}onPageUpKey(e){this.scrollInView(this.visibleOptions().length-1),e.preventDefault()}onEnterKey(e){this.focusedOptionIndex()!==-1&&(this.multiple&&e.shiftKey?this.onOptionSelectRange(e,this.focusedOptionIndex()):this.onOptionSelect(e,this.visibleOptions()[this.focusedOptionIndex()])),e.preventDefault()}onSpaceKey(e){this.onEnterKey(e)}onShiftKey(){let e=this.focusedOptionIndex();this.startRangeIndex.set(e)}getOptionGroupChildren(e){return this.optionGroupChildren?O.resolveFieldData(e,this.optionGroupChildren):e.items}getOptionGroupLabel(e){return this.optionGroupLabel?O.resolveFieldData(e,this.optionGroupLabel):e&&e.label!==void 0?e.label:e}getOptionLabel(e){return this.optionLabel?O.resolveFieldData(e,this.optionLabel):e.label!=null?e.label:e}getOptionIndex(e,i){return this.virtualScrollerDisabled?e:i&&i.getItemOptions(e).index}getOptionValue(e){return this.optionValue?O.resolveFieldData(e,this.optionValue):!this.optionLabel&&e&&e.value!==void 0?e.value:e}getAriaPosInset(e){return(this.optionGroupLabel?e-this.visibleOptions().slice(0,e).filter(i=>this.isOptionGroup(i)).length:e)+1}hasSelectedOption(){return O.isNotEmpty(this.modelValue())}isOptionGroup(e){return this.optionGroupLabel&&e.optionGroup&&e.group}changeFocusedOptionIndex(e,i){this.focusedOptionIndex()!==i&&(this.focusedOptionIndex.set(i),this.scrollInView(),this.selectOnFocus&&!this.multiple&&this.onOptionSelect(e,this.visibleOptions()[i]))}searchOptions(e,i){this.searchValue=(this.searchValue||"")+i;let t=-1,o=!1;return this.focusedOptionIndex()!==-1?(t=this.visibleOptions().slice(this.focusedOptionIndex()).findIndex(p=>this.isOptionMatched(p)),t=t===-1?this.visibleOptions().slice(0,this.focusedOptionIndex()).findIndex(p=>this.isOptionMatched(p)):t+this.focusedOptionIndex()):t=this.visibleOptions().findIndex(p=>this.isOptionMatched(p)),t!==-1&&(o=!0),t===-1&&this.focusedOptionIndex()===-1&&(t=this.findFirstFocusedOptionIndex()),t!==-1&&this.changeFocusedOptionIndex(e,t),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),o}isOptionMatched(e){return this.isValidOption(e)&&this.getOptionLabel(e).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))}scrollInView(e=-1){let i=e!==-1?`${this.id}_${e}`:this.focusedOptionId,t=B.findSingle(this.listViewChild.nativeElement,`li[id="${i}"]`);t?t.scrollIntoView&&t.scrollIntoView({block:"nearest",inline:"nearest"}):this.virtualScrollerDisabled||this.virtualScroll&&this.scroller.scrollToIndex(e!==-1?e:this.focusedOptionIndex())}findFirstOptionIndex(){return this.visibleOptions().findIndex(e=>this.isValidOption(e))}findLastOptionIndex(){return O.findLastIndex(this.visibleOptions(),e=>this.isValidOption(e))}findFirstFocusedOptionIndex(){let e=this.findFirstSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e}findLastFocusedOptionIndex(){let e=this.findLastSelectedOptionIndex();return e<0?this.findLastOptionIndex():e}findLastSelectedOptionIndex(){return this.hasSelectedOption()?O.findLastIndex(this.visibleOptions(),e=>this.isValidSelectedOption(e)):-1}findNextOptionIndex(e){let i=e<this.visibleOptions().length-1?this.visibleOptions().slice(e+1).findIndex(t=>this.isValidOption(t)):-1;return i>-1?i+e+1:e}findNextSelectedOptionIndex(e){let i=this.hasSelectedOption()&&e<this.visibleOptions().length-1?this.visibleOptions().slice(e+1).findIndex(t=>this.isValidSelectedOption(t)):-1;return i>-1?i+e+1:-1}findPrevSelectedOptionIndex(e){let i=this.hasSelectedOption()&&e>0?O.findLastIndex(this.visibleOptions().slice(0,e),t=>this.isValidSelectedOption(t)):-1;return i>-1?i:-1}findFirstSelectedOptionIndex(){return this.hasSelectedOption()?this.visibleOptions().findIndex(e=>this.isValidSelectedOption(e)):-1}findPrevOptionIndex(e){let i=e>0?O.findLastIndex(this.visibleOptions().slice(0,e),t=>this.isValidOption(t)):-1;return i>-1?i:e}findNearestSelectedOptionIndex(e,i=!1){let t=-1;return this.hasSelectedOption()&&(i?(t=this.findPrevSelectedOptionIndex(e),t=t===-1?this.findNextSelectedOptionIndex(e):t):(t=this.findNextSelectedOptionIndex(e),t=t===-1?this.findPrevSelectedOptionIndex(e):t)),t>-1?t:e}equalityKey(){return this.optionValue?null:this.dataKey}isValidSelectedOption(e){return this.isValidOption(e)&&this.isSelected(e)}isOptionDisabled(e){return this.optionDisabled?O.resolveFieldData(e,this.optionDisabled):!1}isSelected(e){let i=this.getOptionValue(e);return this.multiple?(this.modelValue()||[]).some(t=>O.equals(t,i,this.equalityKey())):O.equals(this.modelValue(),i,this.equalityKey())}isValidOption(e){return e&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))}isEmpty(){return!this._options()?.length||!this.visibleOptions()?.length}hasFilter(){return this._filterValue()&&this._filterValue().trim().length>0}resetFilter(){this.filterViewChild&&this.filterViewChild.nativeElement&&(this.filterViewChild.nativeElement.value=""),this._filterValue.set(null)}ngOnDestroy(){this.translationSubscription&&this.translationSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)(v(ct),v(ve),v(yt),v(Ce),v(pt))};static \u0275cmp=K({type:n,selectors:[["p-listbox"]],contentQueries:function(i,t,o){if(i&1&&(ae(o,It,5),ae(o,St,5),ae(o,D,4)),i&2){let p;F(p=E())&&(t.headerFacet=p.first),F(p=E())&&(t.footerFacet=p.first),F(p=E())&&(t.templates=p)}},viewQuery:function(i,t){if(i&1&&(V(dn,5),V(mn,5),V(un,5),V(_n,5),V(fn,5),V(hn,5)),i&2){let o;F(o=E())&&(t.headerCheckboxViewChild=o.first),F(o=E())&&(t.filterViewChild=o.first),F(o=E())&&(t.lastHiddenFocusableElement=o.first),F(o=E())&&(t.firstHiddenFocusableElement=o.first),F(o=E())&&(t.scroller=o.first),F(o=E())&&(t.listViewChild=o.first)}},hostAttrs:[1,"p-element"],inputs:{id:"id",searchMessage:"searchMessage",emptySelectionMessage:"emptySelectionMessage",selectionMessage:"selectionMessage",autoOptionFocus:[2,"autoOptionFocus","autoOptionFocus",T],ariaLabel:"ariaLabel",selectOnFocus:[2,"selectOnFocus","selectOnFocus",T],searchLocale:[2,"searchLocale","searchLocale",T],focusOnHover:[2,"focusOnHover","focusOnHover",T],filterMessage:"filterMessage",filterFields:"filterFields",lazy:[2,"lazy","lazy",T],virtualScroll:[2,"virtualScroll","virtualScroll",T],virtualScrollItemSize:[2,"virtualScrollItemSize","virtualScrollItemSize",_e],virtualScrollOptions:"virtualScrollOptions",scrollHeight:"scrollHeight",tabindex:[2,"tabindex","tabindex",_e],multiple:[2,"multiple","multiple",T],style:"style",styleClass:"styleClass",listStyle:"listStyle",listStyleClass:"listStyleClass",readonly:[2,"readonly","readonly",T],disabled:[2,"disabled","disabled",T],checkbox:[2,"checkbox","checkbox",T],filter:[2,"filter","filter",T],filterBy:"filterBy",filterMatchMode:"filterMatchMode",filterLocale:"filterLocale",metaKeySelection:[2,"metaKeySelection","metaKeySelection",T],dataKey:"dataKey",showToggleAll:[2,"showToggleAll","showToggleAll",T],optionLabel:"optionLabel",optionValue:"optionValue",optionGroupChildren:"optionGroupChildren",optionGroupLabel:"optionGroupLabel",optionDisabled:"optionDisabled",ariaFilterLabel:"ariaFilterLabel",filterPlaceHolder:"filterPlaceHolder",emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",group:[2,"group","group",T],options:"options",filterValue:"filterValue",selectAll:"selectAll"},outputs:{onChange:"onChange",onClick:"onClick",onDblClick:"onDblClick",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onSelectAllChange:"onSelectAllChange"},features:[G([vo]),be],ngContentSelectors:bn,decls:16,vars:24,consts:[["firstHiddenFocusableElement",""],["buildInItems",""],["lastHiddenFocusableElement",""],["builtInFilterElement",""],["headerchkbox",""],["filterInput",""],["scroller",""],["list",""],["emptyFilter",""],["empty",""],[3,"focusout","ngClass","ngStyle"],["role","presentation",1,"p-hidden-accessible","p-hidden-focusable",3,"focus","tabindex"],["class","p-listbox-header",4,"ngIf"],[3,"ngClass","ngStyle"],[3,"items","style","itemSize","autoSize","tabindex","lazy","options","onLazyLoad",4,"ngIf"],[4,"ngIf"],["class","p-listbox-footer",4,"ngIf"],["role","status","aria-live","polite","class","p-hidden-accessible",4,"ngIf"],["role","status","aria-live","polite",1,"p-hidden-accessible"],[1,"p-listbox-header"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","p-checkbox p-component",3,"ngClass","click","keydown",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"p-checkbox","p-component",3,"click","keydown","ngClass"],[1,"p-hidden-accessible"],["type","checkbox","readonly","readonly",3,"focus","blur","disabled"],["role","checkbox",1,"p-checkbox-box",3,"ngClass"],[3,"styleClass",4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet"],["class","p-listbox-filter-container",4,"ngIf"],["role","status","attr.aria-live","polite",1,"p-hidden-accessible"],[1,"p-listbox-filter-container"],["type","text","role","searchbox",1,"p-listbox-filter","p-inputtext","p-component",3,"input","keydown","blur","value","disabled","tabindex"],["class","p-listbox-filter-icon",4,"ngIf"],[1,"p-listbox-filter-icon"],[3,"onLazyLoad","items","itemSize","autoSize","tabindex","lazy","options"],["pTemplate","content"],["pTemplate","loader"],["role","listbox",1,"p-listbox-list",3,"focus","blur","keydown","tabindex","ngClass"],["ngFor","",3,"ngForOf"],["class","p-listbox-empty-message","role","option",4,"ngIf"],["role","option",1,"p-listbox-item-group",3,"ngStyle"],["pRipple","","role","option",1,"p-listbox-item",3,"click","dblclick","mousedown","mouseenter","touchend","ngStyle","ngClass"],["class","p-checkbox p-component",3,"ngClass",4,"ngIf"],[1,"p-checkbox","p-component",3,"ngClass"],[1,"p-checkbox-box",3,"ngClass"],["role","option",1,"p-listbox-empty-message"],[1,"p-listbox-footer"]],template:function(i,t){if(i&1){let o=C();mt(gn),l(0,"div",10),x("focusout",function(_){return f(o),h(t.onFocusout(_))}),l(1,"span",11,0),x("focus",function(_){return f(o),h(t.onFirstHiddenFocus(_))}),s(),u(3,Tn,3,5,"div",12)(4,Gn,5,3,"div",12),l(5,"div",13),u(6,zn,4,11,"p-scroller",14)(7,Wn,2,6,"ng-container",15)(8,ho,5,12,"ng-template",null,1,We),s(),u(10,bo,3,5,"div",16)(11,xo,2,1,"span",17),l(12,"span",18),m(13),s(),l(14,"span",11,2),x("focus",function(_){return f(o),h(t.onLastHiddenFocus(_))}),s()()}i&2&&(re(t.styleClass),c("ngClass",t.containerClass)("ngStyle",t.style),y("id",t.id),a(),c("tabindex",t.disabled?-1:t.tabindex),y("aria-hidden",!0)("data-p-hidden-focusable",!0),a(2),c("ngIf",t.headerFacet||t.headerTemplate),a(),c("ngIf",t.checkbox&&t.multiple&&t.showToggleAll||t.filter),a(),re(t.listStyleClass),dt("max-height",t.virtualScroll?"auto":t.scrollHeight||"auto"),c("ngClass","p-listbox-list-wrapper")("ngStyle",t.listStyle),a(),c("ngIf",t.virtualScroll),a(),c("ngIf",!t.virtualScroll),a(3),c("ngIf",t.footerFacet||t.footerTemplate),a(),c("ngIf",t.isEmpty()),a(2),k(" ",t.selectedMessageText," "),a(),c("tabindex",t.disabled?-1:t.tabindex),y("aria-hidden",!0)("data-p-hidden-focusable",!0))},dependencies:()=>[ce,pe,z,ye,U,D,Ot,jt,Xe,ue],styles:[`@layer primeng{.p-listbox-list-wrapper{overflow:auto}.p-listbox-list{list-style-type:none;margin:0;padding:0}.p-listbox-item{cursor:pointer;position:relative;overflow:hidden;display:flex;align-items:center;-webkit-user-select:none;user-select:none}.p-listbox-header{display:flex;align-items:center}.p-listbox-filter-container{position:relative;flex:1 1 auto}.p-listbox-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-listbox-filter{width:100%}}
`],encapsulation:2,changeDetection:0})}return n})(),di=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ne({type:n});static \u0275inj=ie({imports:[de,fe,Ft,Ze,Xe,ue,fe,Ze]})}return n})();var Co=["materiaPrimaDropdown"],Io=["insumosDropdown"],So=()=>({maxWidth:"1000px"}),wo=()=>({width:"100%"}),mi=()=>({height:"2.5rem"});function To(n,r){if(n&1&&(l(0,"div",28),m(1),l(2,"div"),g(3,"i",29),s()()),n&2){let e=r.$implicit;a(),k(" ",e.nombre," ")}}function Oo(n,r){if(n&1){let e=C();l(0,"div",30)(1,"span")(2,"b"),m(3),s()(),l(4,"div",31)(5,"p-inputGroup",32),g(6,"p-inputNumber",33),l(7,"p-inputGroupAddon"),m(8),s()(),l(9,"p-button",34),x("onClick",function(){let t=f(e).$implicit,o=d(2);return h(o.onDeleteMateriaPrima(t.materiaPrimaId))}),s()()()}if(n&2){let e=r.$implicit,i=r.index;a(3),I(e.nombre),a(2),$(w(8,mi)),a(),c("maxFractionDigits",2)("formControlName",i),a(2),I(e.unidadMedida),a(),c("rounded",!0)("text",!0)}}function Fo(n,r){if(n&1&&(l(0,"div",28),m(1),l(2,"div"),g(3,"i",29),s()()),n&2){let e=r.$implicit;a(),k(" ",e.nombre," ")}}function Eo(n,r){if(n&1){let e=C();l(0,"div",30)(1,"span")(2,"b"),m(3),s()(),l(4,"div",31)(5,"p-inputGroup",32),g(6,"p-inputNumber",33),l(7,"p-inputGroupAddon"),m(8),s()(),l(9,"p-button",34),x("onClick",function(){let t=f(e).$implicit,o=d(2);return h(o.onDeleteInsumo(t.insumoId))}),s()()()}if(n&2){let e=r.$implicit,i=r.index;a(3),I(e.nombre),a(2),$(w(8,mi)),a(),c("maxFractionDigits",2)("formControlName",i),a(2),I(e.unidadMedida),a(),c("rounded",!0)("text",!0)}}function ko(n,r){if(n&1){let e=C();l(0,"div",4)(1,"h5",5),m(2,"Editar receta"),s(),l(3,"form",6),x("ngSubmit",function(){f(e);let t=d();return h(t.onSubmit())}),l(4,"div",7)(5,"div",8)(6,"h5"),m(7,"Detalles"),s(),l(8,"label",9),m(9,"Nombre"),s(),g(10,"input",10)(11,"span",11),s(),l(12,"div",8)(13,"label",12),m(14,"Descripci\xF3n"),s(),g(15,"input",13)(16,"span",11),s(),g(17,"p-divider",14),l(18,"div",15)(19,"h5"),m(20,"Ingredientes"),s(),l(21,"p",16),m(22," Los ingredientes deben estar especificados para la elaboraci\xF3n de "),l(23,"b"),m(24,"una unidad"),s(),m(25," del producto final. "),g(26,"br"),m(27," Debes incluir al menos un ingrediente de cada tipo: materia prima y receta. "),s()(),l(28,"div",17)(29,"div",18)(30,"label",19),m(31,"Materias Primas"),s(),l(32,"p-dropdown",20,0),x("onChange",function(t){f(e);let o=d();return h(o.onSelectMateriaPrima(t))}),u(34,To,4,1,"ng-template",21),s(),l(35,"div",22),u(36,Oo,10,9,"div",23),s()(),l(37,"div",18)(38,"label",19),m(39,"Insumos"),s(),l(40,"p-dropdown",24,1),x("onChange",function(t){f(e);let o=d();return h(o.onSelectInsumo(t))}),u(42,Fo,4,1,"ng-template",21),s(),l(43,"div",25),u(44,Eo,10,9,"div",23),s()()(),l(45,"span",26),g(46,"p-button",27),s()()()()}if(n&2){let e,i,t,o,p,_,b=d();$(w(21,So)),a(3),c("formGroup",b.form),a(7),c("errors",(e=b.form.get("nombre"))==null?null:e.errors),a(),c("valueForm",(i=b.form.get("nombre"))==null?null:i.value)("errors",(t=b.form.get("nombre"))==null?null:t.errors),a(4),c("errors",(o=b.form.get("descripcion"))==null?null:o.errors),a(),c("valueForm",(p=b.form.get("descripcion"))==null?null:p.value)("errors",(_=b.form.get("descripcion"))==null?null:_.errors),a(),c("ngStyle",w(22,wo)),a(15),c("options",b.filteredMateriasPrimas)("autoDisplayFirst",!1)("filter",!0)("showClear",!0),a(4),c("ngForOf",b.selectedMateriasPrimas),a(4),c("options",b.filteredInsumos)("autoDisplayFirst",!1)("filter",!0)("showClear",!0),a(4),c("ngForOf",b.selectedInsumos),a(2),c("disabled",b.form.invalid)}}function ze(n){return n.value>0?null:{greaterThanZero:!0}}var ui=(()=>{let r=class r{constructor(i,t,o,p,_,b){this.recetasService=i,this.materiaPrimaService=t,this.insumosService=o,this.router=p,this.toastr=_,this.activatedRoute=b,this.loading=!1,this.allMateriasPrimas=[],this.allInsumos=[],this.selectedMateriasPrimas=[],this.selectedInsumos=[],this.id=Number(this.activatedRoute.snapshot.paramMap.get("id"))}ngOnInit(){this.recetasService.detail(this.id).subscribe(i=>{this.receta=i,this.selectedInsumos=i.ingredientes.filter(t=>t.insumo!=null).map(t=>({id:t.id,nombre:t.insumo.nombre,insumoId:t.insumo.id,unidadMedida:t.insumo.unidadMedida,cantidad:t.cantidad})),this.selectedMateriasPrimas=i.ingredientes.filter(t=>t.materiaPrima!=null).map(t=>({id:t.id,nombre:t.materiaPrima.nombre,materiaPrimaId:t.materiaPrima.id,unidadMedida:t.materiaPrima.unidadMedida,cantidad:t.cantidad})),this.form=new Oe({nombre:new Q(i.nombre,q.required),descripcion:new Q(i.descripcion,q.maxLength(256)),insumos:new me(this.selectedInsumos.map(t=>new Q(t.cantidad,ze)),q.required),materiasPrimas:new me(this.selectedMateriasPrimas.map(t=>new Q(t.cantidad,ze)),q.required)})}),this.materiaPrimaService.get().subscribe(i=>this.allMateriasPrimas=i),this.insumosService.get().subscribe(i=>this.allInsumos=i)}onSubmit(){if(!this.form.valid)return;let i=this.form.getRawValue(),t=this.selectedInsumos.map((b,P)=>({insumoId:b.insumoId,materiaPrimaId:null,cantidad:i.insumos[P]})),o=this.selectedMateriasPrimas.map((b,P)=>({materiaPrimaId:b.materiaPrimaId,insumoId:null,cantidad:i.materiasPrimas[P]})),p=[...t,...o],_={nombre:i.nombre,descripcion:i.descripcion,ingredientes:p};this.loading=!0,this.recetasService.edit(this.id,_).subscribe(b=>{this.toastr.success("Se han guardado los cambios"),this.router.navigate(["/"+S.Receta,S.Detail,this.receta.id])})}get filteredInsumos(){let i=this.selectedInsumos.map(t=>t.insumoId);return this.allInsumos.filter(t=>!i.includes(t.id))}get filteredMateriasPrimas(){let i=this.selectedMateriasPrimas.map(t=>t.materiaPrimaId);return this.allMateriasPrimas.filter(t=>!i.includes(t.id))}getMateriasPrimasFormArr(){return this.form.get("materiasPrimas")}onSelectMateriaPrima(i){let t=i.value;t&&(this.selectedMateriasPrimas.find(o=>o.id==t.materiaPrimaId)||(this.selectedMateriasPrimas.push({id:t.id,materiaPrimaId:t.id,nombre:t.nombre,cantidad:0,unidadMedida:t.unidadMedida}),this.getMateriasPrimasFormArr().push(new Q("",ze))),this.materiaPrimaDropdown.clear())}onDeleteMateriaPrima(i){let t=this.selectedMateriasPrimas.findIndex(o=>o.materiaPrimaId==i);t>-1&&(this.selectedMateriasPrimas.splice(t,1),this.getMateriasPrimasFormArr().removeAt(t))}getInsumosArr(){return this.form.get("insumos")}onSelectInsumo(i){let t=i.value;t&&(this.selectedInsumos.find(o=>o.insumoId==t.id)||(this.selectedInsumos.push({insumoId:t.id,nombre:t.nombre,cantidad:0,unidadMedida:t.unidadMedida}),this.getInsumosArr().push(new Q("",ze))),this.insumosDropdown.clear())}onDeleteInsumo(i){let t=this.selectedInsumos.findIndex(o=>o.insumoId==i);t>-1&&(this.selectedInsumos.splice(t,1),this.getInsumosArr().removeAt(t))}cancel(){this.router.navigate(["/"+S.Receta,S.Query])}};r.\u0275fac=function(t){return new(t||r)(v(M),v(Y),v(ee),v(Z),v(X),v(Ve))},r.\u0275cmp=K({type:r,selectors:[["receta-edit"]],viewQuery:function(t,o){if(t&1&&(V(Co,5),V(Io,5)),t&2){let p;F(p=E())&&(o.materiaPrimaDropdown=p.first),F(p=E())&&(o.insumosDropdown=p.first)}},features:[G([M,Y,ee])],decls:2,vars:1,consts:[["materiaPrimaDropdown",""],["insumosDropdown",""],["pRipple","","label","Volver","icon","pi pi-arrow-left","styleClass","mb-2","severity","secondary",3,"click"],["class","card",3,"style",4,"ngIf"],[1,"card"],[1,"mb-5","m-2"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],["htmlFor","nombre"],["pInputText","","id","firstname2","type","text","placeholder","Nombre","formControlName","nombre","appCustomInputError","",3,"errors"],["customLabel","",3,"valueForm","errors"],["htmlFor","descripcion"],["pInputText","","id","descripcion","type","text","placeholder","Descripcion","formControlName","descripcion","appCustomInputError","",3,"errors"],["styleClass","my-0 w-full",3,"ngStyle"],[1,"my-4","field","col-12"],[1,"text-500"],[1,"grid","field","col-12"],[1,"col"],["htmlFor","familiaPrimaId",1,"mr-3"],["placeholder","Selecciona una materia prima","optionLabel","nombre","filterBy","nombre",3,"onChange","options","autoDisplayFirst","filter","showClear"],["pTemplate","item"],["formArrayName","materiasPrimas",1,"flex","flex-column","gap-1","mt-2"],["class","shadow-1 px-2 pl-2 pr-1 flex justify-content-between align-items-center border-round-md",4,"ngFor","ngForOf"],["placeholder","Selecciona un insumos","optionLabel","nombre","filterBy","nombre",3,"onChange","options","autoDisplayFirst","filter","showClear"],["formArrayName","insumos",1,"flex","flex-column","gap-1","mt-2"],[1,"ml-auto","mt-2"],["label","Guardar","size","large","type","submit",3,"disabled"],[1,"flex","align-items-center","justify-content-between","gap-2"],[1,"fa-solid","fa-plus","text-lg","opacity-50"],[1,"shadow-1","px-2","pl-2","pr-1","flex","justify-content-between","align-items-center","border-round-md"],[1,"flex","gap-2","align-items-center"],[1,"w-10rem"],["placeholder","Cantidad","size","2",3,"maxFractionDigits","formControlName"],["pRipple","","icon","pi pi-trash","severity","secondary",3,"onClick","rounded","text"]],template:function(t,o){t&1&&(l(0,"p-button",2),x("click",function(){return o.cancel()}),s(),u(1,ko,47,23,"div",3)),t&2&&(a(),c("ngIf",!!o.form))},dependencies:[pe,z,U,D,W,J,De,Fe,Se,we,Te,Ee,Me,ke,je,Ge,Qe,Pe,Ke,He],encapsulation:2});let n=r;return n})();var Mo=[{path:"",redirectTo:"query",pathMatch:"full"},{path:"query",component:ni,title:"Listado de Recetas"},{path:"new",component:si,title:"Agregar Receta"},{path:"detail/:id",component:ri,title:"Detalle de Receta"},{path:"edit/:id",component:ui,title:"Editar Receta"}],ha=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=ne({type:r}),r.\u0275inj=ie({imports:[de,Dt.forChild(Mo),Ht,kt,Rt,Bt,zt,Nt,$t,Jt,Kt,Yt,Wt,Ut,qt,Gt,Vt,Lt,Xt,oi,ei,di,Qt,Zt,ti]});let n=r;return n})();export{ha as RecetasModule};
