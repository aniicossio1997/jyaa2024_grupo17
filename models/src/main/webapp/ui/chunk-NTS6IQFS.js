import{a as je,b as ke}from"./chunk-5FI5EUAA.js";import{a as Ne}from"./chunk-LHQOYPNM.js";import{B as Ke,i as B,j as qe,n as Pe,o as Ge,p as Qe,q as Oe,s as Be,t as $e,u as ze,v as He,w as We,z as Je}from"./chunk-N32QBCDO.js";import{a as Me,b as De,e as Ae,f as Re,i as Ue,l as Ve}from"./chunk-MOHWG4PF.js";import{$ as f,G as Ce,H as w,I as Ee,K as L,L as d,N as j,O as k,P as q,R as v,T as P,U as G,W as Q,Z as we,_ as xe,a as _e,ca as Ie,ea as x,fa as Fe,ha as O,ia as Te,ja as I,m as V,pa as F,q as Se,qa as Le,v as ye}from"./chunk-VXQCQYAP.js";import{$ as C,Bb as fe,Gb as U,Hb as m,Ib as D,Jb as ve,Lc as ge,Oa as a,Pa as c,Pb as E,R as se,Rb as A,S as pe,Sb as he,Uc as be,W as ue,aa as de,eb as R,fb as ce,gb as p,ia as N,ja as T,pb as n,qb as t,r as y,rb as s,vb as M,xb as b,yb as _}from"./chunk-MPDHWXUF.js";var h=(()=>{let o=class o{constructor(e){this.http=e,this.API_URL=Te.API_URL+"usuarios"}get(e=!1){return this.http.get(this.API_URL+"?includeBlocked="+e).pipe(y(i=>i))}detail(e){return this.http.get(this.API_URL+"/"+e).pipe(y(i=>i))}create(e){return this.http.post(this.API_URL,e).pipe(y(i=>i))}edit(e,i){return this.http.put(this.API_URL+"/"+e,i).pipe(y(r=>r))}delete(e){return this.http.delete(this.API_URL+"/"+e).pipe(y(i=>i))}ngOnDestroy(){}};o.\u0275fac=function(i){return new(i||o)(ue(_e))},o.\u0275prov=se({token:o,factory:o.\u0275fac});let l=o;return l})();var Xe=()=>({"min-width":"50rem"}),nt=()=>[5,10,20],lt=()=>["nombre","apellido","username","email"],at=l=>[l];function mt(l,o){if(l&1){let u=M();n(0,"h2",9),m(1,"Usuarios"),t(),n(2,"div",10)(3,"div",11)(4,"span",12),s(5,"i",13),n(6,"input",14),b("input",function(i){N(u),_();let r=U(2);return T(r.filterGlobal(i.target.value,"contains"))}),t()()(),s(7,"p-button",15),t()}if(l&2){let u=_();a(7),p("routerLink",he(1,at,u.Routes.NEW))}}function st(l,o){l&1&&(n(0,"tr")(1,"th"),m(2,"Acciones"),t(),n(3,"th",16),m(4," Nombre de usuario "),s(5,"p-sortIcon",17),t(),n(6,"th",18),m(7,"Email "),s(8,"p-sortIcon",19),t(),n(9,"th",20),m(10,"Nombre "),s(11,"p-sortIcon",21),t(),n(12,"th",22),m(13," Apellido "),s(14,"p-sortIcon",23),t(),n(15,"th",24),m(16,"Rol "),s(17,"p-sortIcon",25),t()())}function pt(l,o){if(l&1){let u=M();n(0,"tr")(1,"td")(2,"button",26),b("click",function(i){let r=N(u).$implicit,g=U(4),S=_();return T(S.generateMenu(r,g,i))}),t(),s(3,"p-menu",27,1),t(),n(5,"td"),m(6),t(),n(7,"td"),m(8),t(),n(9,"td"),m(10),t(),n(11,"td"),m(12),t(),n(13,"td"),s(14,"p-tag",28),t()()}if(l&2){let u=o.$implicit,e=_();a(3),p("popup",!0)("model",e.itemsMenu),a(3),D(u.username),a(2),D(u.email),a(2),D(u.nombre),a(2),D(u.apellido),a(2),fe("value",u.rol),p("severity",u.rol==="ADMIN"?"info":"success")}}function ut(l,o){l&1&&(n(0,"tr")(1,"td",29),m(2," No se encontraron usuarios "),t()()),l&2&&(a(),ce("colspan",5))}function dt(l,o){if(l&1&&(n(0,"div",30),m(1),t()),l&2){let u=_(),e=U(2);a(),ve(" En total hay ",e.filteredValue?e.filteredValue.length:u.usuarios.length," registros. ")}}var it=(()=>{let o=class o{constructor(e,i,r,g,S){this.usuariosService=e,this.router=i,this.confirmationService=r,this.toastr=g,this.confirmationDialogService=S,this.usuarios=[],this.loading=!0,this.itemsMenu=[]}ngOnInit(){this.fetchUsers()}fetchUsers(){this.loading=!0,this.usuariosService.get().subscribe(e=>{this.usuarios=e,this.loading=!1})}get Routes(){return{NEW:`/${f.Usuario}/${f.New}`}}generateMenu(e,i,r){i.toggle(r),this.itemsMenu=[{label:"Editar",icon:"pi pi-pencil",command:()=>{this.router.navigate([`/${f.Usuario}/${f.Edit}/`,e.id])}},{label:"Eliminar",icon:"pi pi-trash",command:()=>{this.delete(e)}}]}delete(e){this.confirmationDialogService.confirmDelete("\xBFEst\xE1 seguro que desea eliminar el usuario?",()=>{this.usuariosService.delete(e.id).subscribe(()=>{this.toastr.success("Se ha eliminado el usuario"),this.fetchUsers()})})}};o.\u0275fac=function(i){return new(i||o)(c(h),c(x),c(V),c(I),c(Ne))},o.\u0275cmp=C({type:o,selectors:[["app-query"]],features:[E([h,V,Se])],decls:8,vars:11,consts:[["dt",""],["menu",""],[1,"card"],[3,"value","tableStyle","paginator","rows","rowsPerPageOptions","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"mb-4"],[1,"flex","align-items-center","justify-content-between","flex-wrap"],[1,"flex","gap-4","flex-wrap"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pRipple","","severity","primary","label","Agregar Usuario","icon","pi pi-plus",1,"mr-2",3,"routerLink"],["pSortableColumn","username"],["field","username"],["pSortableColumn","email"],["field","email"],["pSortableColumn","nombre"],["field","nombre"],["pSortableColumn","apellido"],["field","apellido"],["pSortableColumn","rol"],["field","rol"],["pButton","","pRipple","","type","button","icon","pi pi-bars",1,"p-button-rounded","p-button-text",3,"click"],["appendTo","body",3,"popup","model"],[3,"value","severity"],[1,"text-center","py-4"],[1,"flex","align-items-center","justify-content-between"]],template:function(i,r){i&1&&(n(0,"div",2)(1,"p-table",3,0),R(3,mt,8,3,"ng-template",4)(4,st,18,0,"ng-template",5)(5,pt,15,8,"ng-template",6)(6,ut,3,1,"ng-template",7)(7,dt,2,1,"ng-template",8),t()()),i&2&&(a(),p("value",r.usuarios)("tableStyle",A(7,Xe))("paginator",!0)("rows",5)("tableStyle",A(8,Xe))("rowsPerPageOptions",A(9,nt))("globalFilterFields",A(10,lt)))},dependencies:[Fe,Pe,ye,Ge,Qe,Ce,w,Me,He,F]});let l=o;return l})();var rt=(()=>{let o=class o{constructor(e,i,r){this.usuariosService=e,this.router=i,this.toastr=r,this.roles=[{label:"Administrador",value:"ADMIN"},{label:"Encargado de Sala",value:"ENCARGADO_SALA"}],this.rol="ADMIN",this.loading=!1,this.form=new q({nombre:new v("",d.required),apellido:new v("",d.required),username:new v("",d.required),password:new v("",[d.required,d.minLength(3)]),email:new v("",[d.required,d.email]),rol:new v(null,d.required)})}onSubmit(){console.warn(this.form.value);let e=this.form.getRawValue(),i={nombre:e.nombre,apellido:e.apellido,username:e.username,email:e.email,rol:e.rol.value,password:e.password};this.loading=!0,this.usuariosService.create(i).subscribe(r=>{this.toastr.success("Se ha agregado el usuario"),this.router.navigate(["/"+f.Usuario,f.Query])})}back(){this.router.navigate(["/"+f.Usuario,f.Query])}ngOnInit(){}};o.\u0275fac=function(i){return new(i||o)(c(h),c(x),c(I))},o.\u0275cmp=C({type:o,selectors:[["app-new"]],features:[E([h])],decls:38,vars:23,consts:[["pRipple","","label","Volver","icon","pi pi-arrow-left","styleClass","mb-2","severity","secondary",3,"click"],[1,"card",2,"max-width","600px"],[1,"mb-5","m-2"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-12"],["htmlFor","nombre"],["pInputText","","id","firstname2","type","text","placeholder","Nombre","formControlName","nombre","appCustomInputError","",3,"errors"],["customLabel","",3,"valueForm","errors"],["htmlFor","apellido"],["pInputText","","id","apellido","type","text","placeholder","Apellido","formControlName","apellido","appCustomInputError","",3,"errors"],["htmlFor","username"],["pInputText","","id","username","type","text","placeholder","Nombre de usuario","formControlName","username","appCustomInputError","",3,"errors"],["htmlFor","email"],["pInputText","","id","email","type","text","placeholder","Email","formControlName","email","appCustomInputError","",3,"errors"],["htmlFor","password"],["pInputText","","id","password","type","password","placeholder","Contrase\xF1a","formControlName","password","appCustomInputError","",3,"errors"],["htmlFor","rol"],["optionLabel","label","placeholder","Selecciona un rol","formControlName","rol","appCustomInputError","",3,"options","autoDisplayFirst","value","errors"],[1,"ml-auto"],["label","Guardar","size","large","type","submit",3,"disabled"]],template:function(i,r){if(i&1&&(n(0,"p-button",0),b("click",function(){return r.back()}),t(),n(1,"div",1)(2,"h5",2),m(3,"Agregar usuario"),t(),n(4,"form",3),b("ngSubmit",function(){return r.onSubmit()}),n(5,"div",4)(6,"div",5)(7,"label",6),m(8,"Nombre"),t(),s(9,"input",7)(10,"span",8),t(),n(11,"div",5)(12,"label",9),m(13,"Apellido"),t(),s(14,"input",10)(15,"span",8),t(),n(16,"div",5)(17,"label",11),m(18,"Nombre de usuario"),t(),s(19,"input",12)(20,"span",8),t(),n(21,"div",5)(22,"label",13),m(23,"Email"),t(),s(24,"input",14)(25,"span",8),t(),n(26,"div",5)(27,"label",15),m(28,"Contrase\xF1a"),t(),s(29,"input",16)(30,"span",8),t(),n(31,"div",5)(32,"label",17),m(33,"Rol"),t(),s(34,"p-dropdown",18)(35,"span",8),t(),n(36,"span",19),s(37,"p-button",20),t()()()()),i&2){let g,S,H,W,J,K,X,Y,Z,ee,te,ie,re,oe,ne,le,ae,me;a(4),p("formGroup",r.form),a(5),p("errors",(g=r.form.get("nombre"))==null?null:g.errors),a(),p("valueForm",(S=r.form.get("nombre"))==null?null:S.value)("errors",(H=r.form.get("nombre"))==null?null:H.errors),a(4),p("errors",(W=r.form.get("apellido"))==null?null:W.errors),a(),p("valueForm",(J=r.form.get("apellido"))==null?null:J.value)("errors",(K=r.form.get("apellido"))==null?null:K.errors),a(4),p("errors",(X=r.form.get("username"))==null?null:X.errors),a(),p("valueForm",(Y=r.form.get("username"))==null?null:Y.value)("errors",(Z=r.form.get("username"))==null?null:Z.errors),a(4),p("errors",(ee=r.form.get("email"))==null?null:ee.errors),a(),p("valueForm",(te=r.form.get("email"))==null?null:te.value)("errors",(ie=r.form.get("email"))==null?null:ie.errors),a(4),p("errors",(re=r.form.get("password"))==null?null:re.errors),a(),p("valueForm",(oe=r.form.get("password"))==null?null:oe.value)("errors",(ne=r.form.get("password"))==null?null:ne.errors),a(4),p("options",r.roles)("autoDisplayFirst",!1)("value",r.form.get("rol"))("errors",(le=r.form.get("rol"))==null?null:le.errors),a(),p("valueForm",(ae=r.form.get("rol"))==null?null:ae.value)("errors",(me=r.form.get("rol"))==null?null:me.errors),a(2),p("disabled",r.form.invalid)}},dependencies:[w,F,B,P,L,j,k,G,Q,Ae,Re]});let l=o;return l})();function vt(l,o){if(l&1){let u=M();n(0,"div",2)(1,"h5",3),m(2,"Editar usuario"),t(),n(3,"form",4),b("ngSubmit",function(){N(u);let i=_();return T(i.onSubmit())}),n(4,"div",5)(5,"div",6)(6,"label",7),m(7,"Nombre"),t(),s(8,"input",8),t(),n(9,"div",6)(10,"label",9),m(11,"Apellido"),t(),s(12,"input",10),t(),n(13,"div",6)(14,"label",11),m(15,"Nombre de usuario"),t(),s(16,"input",12),t(),n(17,"div",6)(18,"label",13),m(19,"Email"),t(),s(20,"input",14),t(),n(21,"div",6)(22,"label",15),m(23,"Contrase\xF1a"),t(),s(24,"input",16),t(),n(25,"div",6)(26,"label",17),m(27,"Rol"),t(),s(28,"p-dropdown",18),t(),n(29,"span",19),s(30,"p-button",20),t()()()()}if(l&2){let u=_();a(3),p("formGroup",u.form),a(25),p("options",u.roles)("autoDisplayFirst",!1)("value",u.form.get("rol")),a(2),p("disabled",u.form.invalid)("loading",u.loading)}}var ot=(()=>{let o=class o{constructor(e,i,r,g){this.usuariosService=e,this.router=i,this.toastr=r,this.activatedRoute=g,this.roles=[{label:"Administrador",value:"ADMIN"},{label:"Encargado de Sala",value:"ENCARGADO_SALA"}],this.rol=null,this.loading=!1,this.form=new q({nombre:new v("",d.required),apellido:new v("",d.required),username:new v("",d.required),password:new v("",[d.minLength(3)]),email:new v("",[d.required,d.email]),rol:new v("",d.required)}),this.id=Number(this.activatedRoute.snapshot.paramMap.get("id"))}ngOnInit(){this.usuariosService.detail(this.id).subscribe(e=>{this.usuario=e,this.form.setValue({nombre:e.nombre,apellido:e.apellido,password:"",email:e.email,username:e.username,rol:e.rol})})}onSubmit(){let e=this.form.getRawValue(),i={nombre:e.nombre,apellido:e.apellido,username:e.username,email:e.email,rol:e.rol};e.password&&(i.password=e.password),this.loading=!0,this.usuariosService.edit(this.usuario.id,i).subscribe(()=>{this.toastr.success("Se han guardado los cambios"),this.router.navigate(["/"+f.Usuario,f.Query])})}setRol(e){this.form.get("rol").setValue(e)}back(){this.router.navigate(["/"+f.Usuario,f.Query])}};o.\u0275fac=function(i){return new(i||o)(c(h),c(x),c(I),c(Ie))},o.\u0275cmp=C({type:o,selectors:[["app-edit"]],features:[E([h])],decls:2,vars:1,consts:[["pRipple","","label","Volver","icon","pi pi-arrow-left","styleClass","mb-2","severity","secondary",3,"click"],["class","card","style","max-width: 600px",4,"ngIf"],[1,"card",2,"max-width","600px"],[1,"mb-5","m-2"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-12"],["htmlFor","nombre"],["pInputText","","id","firstname2","type","text","placeholder","Nombre","formControlName","nombre"],["htmlFor","apellido"],["pInputText","","id","apellido","type","text","placeholder","Apellido","formControlName","apellido"],["htmlFor","username"],["pInputText","","id","username","type","text","placeholder","Nombre de usuario","formControlName","username"],["htmlFor","email"],["pInputText","","id","email","type","text","placeholder","Email","formControlName","email"],["htmlFor","password"],["pInputText","","id","password","type","password","placeholder","Contrase\xF1a","formControlName","password"],["htmlFor","rol"],["optionLabel","label","optionValue","value","placeholder","Selecciona un rol","formControlName","rol",3,"options","autoDisplayFirst","value"],[1,"ml-auto"],["label","Guardar","size","large","type","submit",3,"disabled","loading"]],template:function(i,r){i&1&&(n(0,"p-button",0),b("click",function(){return r.back()}),t(),R(1,vt,31,6,"div",1)),i&2&&(a(),p("ngIf",!!r.usuario))},dependencies:[ge,w,F,B,P,L,j,k,G,Q]});let l=o;return l})();var ht=[{path:"",redirectTo:"query",pathMatch:"full"},{path:"query",component:it,title:"Listado de Usuarios"},{path:"new",component:rt,title:"Agregar Usuario"},{path:"edit/:id",component:ot,title:"Editar Usuario"}],si=(()=>{let o=class o{};o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=de({type:o}),o.\u0275inj=pe({imports:[be,O.forChild(ht),Oe,Ee,De,ze,We,Ve,$e,ke,Le,je,Ke,Je,O,Be,qe,we,xe,Ue,O]});let l=o;return l})();export{si as UsuariosModule};
