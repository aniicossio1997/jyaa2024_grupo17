import{a as je,b as ke}from"./chunk-J7CRMSWP.js";import{a as Ne}from"./chunk-WBNJTG47.js";import{B as Ke,i as B,j as qe,n as Pe,o as Ge,p as Qe,q as Oe,s as Be,t as $e,u as ze,v as He,w as We,z as Je}from"./chunk-IJ6BS5SH.js";import{a as Me,b as De,e as Ae,f as Re,j as Ue,m as Ve}from"./chunk-AUGZRSW5.js";import{$ as f,G as xe,H as E,I as Ce,K as L,L as d,N as j,O as k,P as q,R as v,T as P,U as G,W as Q,Z as Ee,_ as we,a as _e,ca as Ie,ea as w,fa as Fe,ha as O,ia as Te,ja as I,m as V,pa as F,q as Se,qa as Le,v as ye}from"./chunk-QZ7GV5CC.js";import{$ as x,Bb as fe,Gb as U,Hb as l,Ib as D,Jb as ve,Lc as ge,Oa as m,Pa as c,Pb as C,R as se,Rb as A,S as pe,Sb as he,Tc as be,W as ue,aa as de,eb as R,fb as ce,gb as p,ia as N,ja as T,pb as t,qb as i,r as y,rb as s,vb as M,xb as b,yb as _}from"./chunk-FI3UJX5Y.js";var h=(()=>{let n=class n{constructor(e){this.http=e,this.API_URL=Te.API_URL+"usuarios"}get(e=!1){return this.http.get(this.API_URL+"?includeBlocked="+e).pipe(y(r=>r))}detail(e){return this.http.get(this.API_URL+"/"+e).pipe(y(r=>r))}create(e){return this.http.post(this.API_URL,e).pipe(y(r=>r))}edit(e,r){return this.http.put(this.API_URL+"/"+e,r).pipe(y(o=>o))}delete(e){return this.http.delete(this.API_URL+"/"+e).pipe(y(r=>r))}ngOnDestroy(){}};n.\u0275fac=function(r){return new(r||n)(ue(_e))},n.\u0275prov=se({token:n,factory:n.\u0275fac});let a=n;return a})();var Xe=()=>({"min-width":"50rem"}),nt=()=>[5,10,20],lt=()=>["nombre","apellido","username","email"],at=a=>[a];function mt(a,n){if(a&1){let u=M();t(0,"h2",9),l(1,"Usuarios"),i(),t(2,"div",10)(3,"div",11)(4,"span",12),s(5,"i",13),t(6,"input",14),b("input",function(r){N(u),_();let o=U(2);return T(o.filterGlobal(r.target.value,"contains"))}),i()()(),s(7,"p-button",15),i()}if(a&2){let u=_();m(7),p("routerLink",he(1,at,u.Routes.NEW))}}function st(a,n){a&1&&(t(0,"tr")(1,"th"),l(2,"Acciones"),i(),t(3,"th",16),l(4," Nombre de usuario "),s(5,"p-sortIcon",17),i(),t(6,"th",18),l(7,"Email "),s(8,"p-sortIcon",19),i(),t(9,"th",20),l(10,"Nombre "),s(11,"p-sortIcon",21),i(),t(12,"th",22),l(13," Apellido "),s(14,"p-sortIcon",23),i(),t(15,"th",24),l(16,"Rol "),s(17,"p-sortIcon",25),i()())}function pt(a,n){if(a&1){let u=M();t(0,"tr")(1,"td")(2,"button",26),b("click",function(r){let o=N(u).$implicit,g=U(4),S=_();return T(S.generateMenu(o,g,r))}),i(),s(3,"p-menu",27,1),i(),t(5,"td"),l(6),i(),t(7,"td"),l(8),i(),t(9,"td"),l(10),i(),t(11,"td"),l(12),i(),t(13,"td"),s(14,"p-tag",28),i()()}if(a&2){let u=n.$implicit,e=_();m(3),p("popup",!0)("model",e.itemsMenu),m(3),D(u.username),m(2),D(u.email),m(2),D(u.nombre),m(2),D(u.apellido),m(2),fe("value",u.rol),p("severity",u.rol==="ADMIN"?"info":"success")}}function ut(a,n){a&1&&(t(0,"tr")(1,"td",29),l(2," No se encontraron usuarios "),i()()),a&2&&(m(),ce("colspan",5))}function dt(a,n){if(a&1&&(t(0,"div",30),l(1),i()),a&2){let u=_(),e=U(2);m(),ve(" En total hay ",e.filteredValue?e.filteredValue.length:u.usuarios.length," registros. ")}}var it=(()=>{let n=class n{constructor(e,r,o,g,S){this.usuariosService=e,this.router=r,this.confirmationService=o,this.toastr=g,this.confirmationDialogService=S,this.usuarios=[],this.loading=!0,this.itemsMenu=[]}ngOnInit(){this.fetchUsers()}fetchUsers(){this.loading=!0,this.usuariosService.get().subscribe(e=>{this.usuarios=e,this.loading=!1})}get Routes(){return{NEW:`/${f.Usuario}/${f.New}`}}generateMenu(e,r,o){r.toggle(o),this.itemsMenu=[{label:"Editar",icon:"pi pi-pencil",command:()=>{this.router.navigate([`/${f.Usuario}/${f.Edit}/`,e.id])}},{label:"Eliminar",icon:"pi pi-trash",command:()=>{this.delete(e)}}]}delete(e){this.confirmationDialogService.confirmDelete("\xBFEst\xE1 seguro que desea eliminar el usuario?",()=>{this.usuariosService.delete(e.id).subscribe(()=>{this.toastr.success("Se ha eliminado el usuario"),this.fetchUsers()})})}};n.\u0275fac=function(r){return new(r||n)(c(h),c(w),c(V),c(I),c(Ne))},n.\u0275cmp=x({type:n,selectors:[["app-query"]],features:[C([h,V,Se])],decls:8,vars:11,consts:[["dt",""],["menu",""],[1,"card"],[3,"value","tableStyle","paginator","rows","rowsPerPageOptions","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"mb-4"],[1,"flex","align-items-center","justify-content-between","flex-wrap"],[1,"flex","gap-4","flex-wrap"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pRipple","","severity","primary","label","Agregar Usuario","icon","pi pi-plus",1,"mr-2",3,"routerLink"],["pSortableColumn","username"],["field","username"],["pSortableColumn","email"],["field","email"],["pSortableColumn","nombre"],["field","nombre"],["pSortableColumn","apellido"],["field","apellido"],["pSortableColumn","rol"],["field","rol"],["pButton","","pRipple","","type","button","icon","pi pi-bars",1,"p-button-rounded","p-button-text",3,"click"],["appendTo","body",3,"popup","model"],[3,"value","severity"],[1,"text-center","py-4"],[1,"flex","align-items-center","justify-content-between"]],template:function(r,o){r&1&&(t(0,"div",2)(1,"p-table",3,0),R(3,mt,8,3,"ng-template",4)(4,st,18,0,"ng-template",5)(5,pt,15,8,"ng-template",6)(6,ut,3,1,"ng-template",7)(7,dt,2,1,"ng-template",8),i()()),r&2&&(m(),p("value",o.usuarios)("tableStyle",A(7,Xe))("paginator",!0)("rows",5)("tableStyle",A(8,Xe))("rowsPerPageOptions",A(9,nt))("globalFilterFields",A(10,lt)))},dependencies:[Fe,Pe,ye,Ge,Qe,xe,E,Me,He,F]});let a=n;return a})();var rt=(()=>{let n=class n{constructor(e,r,o){this.usuariosService=e,this.router=r,this.toastr=o,this.roles=[{label:"Administrador",value:"ADMIN"},{label:"Encargado de Sala",value:"ENCARGADO_SALA"}],this.rol="ADMIN",this.loading=!1,this.form=new q({nombre:new v("",d.required),apellido:new v("",d.required),username:new v("",d.required),password:new v("",[d.required,d.minLength(3)]),email:new v("",[d.required,d.email]),rol:new v(null,d.required)})}onSubmit(){console.warn(this.form.value);let e=this.form.getRawValue(),r={nombre:e.nombre,apellido:e.apellido,username:e.username,email:e.email,rol:e.rol.value,password:e.password};this.loading=!0,this.usuariosService.create(r).subscribe(o=>{this.toastr.success("Se ha agregado el usuario"),this.router.navigate(["/"+f.Usuario,f.Query])})}back(){this.router.navigate(["/"+f.Usuario,f.Query])}ngOnInit(){}};n.\u0275fac=function(r){return new(r||n)(c(h),c(w),c(I))},n.\u0275cmp=x({type:n,selectors:[["app-new"]],features:[C([h])],decls:50,vars:23,consts:[["pRipple","","label","Volver","icon","pi pi-arrow-left","styleClass","mb-2","severity","secondary",3,"click"],[1,"card",2,"max-width","600px"],[1,"mb-5","m-2"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-12"],["htmlFor","nombre"],[1,"text-danger"],["pInputText","","id","firstname2","type","text","placeholder","Nombre","formControlName","nombre","appCustomInputError","",3,"errors"],["customLabel","",3,"valueForm","errors"],["htmlFor","apellido"],["pInputText","","id","apellido","type","text","placeholder","Apellido","formControlName","apellido","appCustomInputError","",3,"errors"],["htmlFor","username"],["pInputText","","id","username","type","text","placeholder","Nombre de usuario","formControlName","username","appCustomInputError","",3,"errors"],["htmlFor","email"],["pInputText","","id","email","type","text","placeholder","Email","formControlName","email","appCustomInputError","",3,"errors"],["htmlFor","password"],["pInputText","","id","password","type","password","placeholder","Contrase\xF1a","formControlName","password","appCustomInputError","",3,"errors"],["htmlFor","rol"],["optionLabel","label","placeholder","Selecciona un rol","formControlName","rol","appCustomInputError","",3,"options","autoDisplayFirst","value","errors"],[1,"ml-auto"],["label","Guardar","size","large","type","submit",3,"disabled"]],template:function(r,o){if(r&1&&(t(0,"p-button",0),b("click",function(){return o.back()}),i(),t(1,"div",1)(2,"h5",2),l(3,"Agregar usuario"),i(),t(4,"form",3),b("ngSubmit",function(){return o.onSubmit()}),t(5,"div",4)(6,"div",5)(7,"label",6),l(8,"Nombre "),t(9,"span",7),l(10,"*"),i()(),s(11,"input",8)(12,"span",9),i(),t(13,"div",5)(14,"label",10),l(15,"Apellido "),t(16,"span",7),l(17,"*"),i()(),s(18,"input",11)(19,"span",9),i(),t(20,"div",5)(21,"label",12),l(22,"Nombre de usuario "),t(23,"span",7),l(24,"*"),i()(),s(25,"input",13)(26,"span",9),i(),t(27,"div",5)(28,"label",14),l(29,"Email "),t(30,"span",7),l(31,"*"),i()(),s(32,"input",15)(33,"span",9),i(),t(34,"div",5)(35,"label",16),l(36,"Contrase\xF1a "),t(37,"span",7),l(38,"*"),i()(),s(39,"input",17)(40,"span",9),i(),t(41,"div",5)(42,"label",18),l(43,"Rol "),t(44,"span",7),l(45,"*"),i()(),s(46,"p-dropdown",19)(47,"span",9),i(),t(48,"span",20),s(49,"p-button",21),i()()()()),r&2){let g,S,H,W,J,K,X,Y,Z,ee,te,ie,re,oe,ne,le,ae,me;m(4),p("formGroup",o.form),m(7),p("errors",(g=o.form.get("nombre"))==null?null:g.errors),m(),p("valueForm",(S=o.form.get("nombre"))==null?null:S.value)("errors",(H=o.form.get("nombre"))==null?null:H.errors),m(6),p("errors",(W=o.form.get("apellido"))==null?null:W.errors),m(),p("valueForm",(J=o.form.get("apellido"))==null?null:J.value)("errors",(K=o.form.get("apellido"))==null?null:K.errors),m(6),p("errors",(X=o.form.get("username"))==null?null:X.errors),m(),p("valueForm",(Y=o.form.get("username"))==null?null:Y.value)("errors",(Z=o.form.get("username"))==null?null:Z.errors),m(6),p("errors",(ee=o.form.get("email"))==null?null:ee.errors),m(),p("valueForm",(te=o.form.get("email"))==null?null:te.value)("errors",(ie=o.form.get("email"))==null?null:ie.errors),m(6),p("errors",(re=o.form.get("password"))==null?null:re.errors),m(),p("valueForm",(oe=o.form.get("password"))==null?null:oe.value)("errors",(ne=o.form.get("password"))==null?null:ne.errors),m(6),p("options",o.roles)("autoDisplayFirst",!1)("value",o.form.get("rol"))("errors",(le=o.form.get("rol"))==null?null:le.errors),m(),p("valueForm",(ae=o.form.get("rol"))==null?null:ae.value)("errors",(me=o.form.get("rol"))==null?null:me.errors),m(2),p("disabled",o.form.invalid)}},dependencies:[E,F,B,P,L,j,k,G,Q,Ae,Re]});let a=n;return a})();function vt(a,n){if(a&1){let u=M();t(0,"div",2)(1,"h5",3),l(2,"Editar usuario"),i(),t(3,"form",4),b("ngSubmit",function(){N(u);let r=_();return T(r.onSubmit())}),t(4,"div",5)(5,"div",6)(6,"label",7),l(7,"Nombre "),t(8,"span",8),l(9,"*"),i()(),s(10,"input",9),i(),t(11,"div",6)(12,"label",10),l(13,"Apellido "),t(14,"span",8),l(15,"*"),i()(),s(16,"input",11),i(),t(17,"div",6)(18,"label",12),l(19,"Nombre de usuario "),t(20,"span",8),l(21,"*"),i()(),s(22,"input",13),i(),t(23,"div",6)(24,"label",14),l(25,"Email "),t(26,"span",8),l(27,"*"),i()(),s(28,"input",15),i(),t(29,"div",6)(30,"label",16),l(31,"Contrase\xF1a "),i(),s(32,"input",17),i(),t(33,"div",6)(34,"label",18),l(35,"Rol "),t(36,"span",8),l(37,"*"),i()(),s(38,"p-dropdown",19),i(),t(39,"span",20),s(40,"p-button",21),i()()()()}if(a&2){let u=_();m(3),p("formGroup",u.form),m(35),p("options",u.roles)("autoDisplayFirst",!1)("value",u.form.get("rol")),m(2),p("disabled",u.form.invalid)("loading",u.loading)}}var ot=(()=>{let n=class n{constructor(e,r,o,g){this.usuariosService=e,this.router=r,this.toastr=o,this.activatedRoute=g,this.roles=[{label:"Administrador",value:"ADMIN"},{label:"Encargado de Sala",value:"ENCARGADO_SALA"}],this.rol=null,this.loading=!1,this.form=new q({nombre:new v("",d.required),apellido:new v("",d.required),username:new v("",d.required),password:new v("",[d.minLength(3)]),email:new v("",[d.required,d.email]),rol:new v("",d.required)}),this.id=Number(this.activatedRoute.snapshot.paramMap.get("id"))}ngOnInit(){this.usuariosService.detail(this.id).subscribe(e=>{this.usuario=e,this.form.setValue({nombre:e.nombre,apellido:e.apellido,password:"",email:e.email,username:e.username,rol:e.rol})})}onSubmit(){let e=this.form.getRawValue(),r={nombre:e.nombre,apellido:e.apellido,username:e.username,email:e.email,rol:e.rol};e.password&&(r.password=e.password),this.loading=!0,this.usuariosService.edit(this.usuario.id,r).subscribe(()=>{this.toastr.success("Se han guardado los cambios"),this.router.navigate(["/"+f.Usuario,f.Query])})}setRol(e){this.form.get("rol").setValue(e)}back(){this.router.navigate(["/"+f.Usuario,f.Query])}};n.\u0275fac=function(r){return new(r||n)(c(h),c(w),c(I),c(Ie))},n.\u0275cmp=x({type:n,selectors:[["app-edit"]],features:[C([h])],decls:2,vars:1,consts:[["pRipple","","label","Volver","icon","pi pi-arrow-left","styleClass","mb-2","severity","secondary",3,"click"],["class","card","style","max-width: 600px",4,"ngIf"],[1,"card",2,"max-width","600px"],[1,"mb-5","m-2"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-12"],["htmlFor","nombre"],[1,"text-danger"],["pInputText","","id","firstname2","type","text","placeholder","Nombre","formControlName","nombre"],["htmlFor","apellido"],["pInputText","","id","apellido","type","text","placeholder","Apellido","formControlName","apellido"],["htmlFor","username"],["pInputText","","id","username","type","text","placeholder","Nombre de usuario","formControlName","username"],["htmlFor","email"],["pInputText","","id","email","type","text","placeholder","Email","formControlName","email"],["htmlFor","password"],["pInputText","","id","password","type","password","placeholder","Contrase\xF1a","formControlName","password"],["htmlFor","rol"],["optionLabel","label","optionValue","value","placeholder","Selecciona un rol","formControlName","rol",3,"options","autoDisplayFirst","value"],[1,"ml-auto"],["label","Guardar","size","large","type","submit",3,"disabled","loading"]],template:function(r,o){r&1&&(t(0,"p-button",0),b("click",function(){return o.back()}),i(),R(1,vt,41,6,"div",1)),r&2&&(m(),p("ngIf",!!o.usuario))},dependencies:[ge,E,F,B,P,L,j,k,G,Q]});let a=n;return a})();var ht=[{path:"",redirectTo:"query",pathMatch:"full"},{path:"query",component:it,title:"Listado de Usuarios"},{path:"new",component:rt,title:"Agregar Usuario"},{path:"edit/:id",component:ot,title:"Editar Usuario"}],si=(()=>{let n=class n{};n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=de({type:n}),n.\u0275inj=pe({imports:[be,O.forChild(ht),Oe,Ce,De,ze,We,Ve,$e,ke,Le,je,Ke,Je,O,Be,qe,Ee,we,Ue,O]});let a=n;return a})();export{si as UsuariosModule};
