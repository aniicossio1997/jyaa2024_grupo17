import{a as Ve,b as Ae}from"./chunk-3ODBE2C6.js";import{a as ee,b as kt,c as E,d as jt}from"./chunk-E2R7OA6O.js";import{a as _t,b as bt}from"./chunk-J7CRMSWP.js";import{a as Y}from"./chunk-YSM7HIWG.js";import{a as Mt,b as ke}from"./chunk-47TK7PFT.js";import{a as je,b as Rt}from"./chunk-BZDX7QXS.js";import{a as Te,b as St}from"./chunk-R65F2ROU.js";import{a as de,b as xt}from"./chunk-AZKQCPMW.js";import{a as ge}from"./chunk-WBNJTG47.js";import{A as b,B as Nt,b as Pe,c as Ct,i as $,j as Et,l as pe,m as It,n as Ne,o as Me,p as Re,q as yt,s as wt,t as Ft,u as Dt,v as K,w as Tt,x as X,y as U,z as Pt}from"./chunk-IJ6BS5SH.js";import{a as pt,b as ut,e as ft,f as Fe,g as De,j as gt,m as vt}from"./chunk-AUGZRSW5.js";import{$ as I,G as at,H as T,I as rt,K as we,L as P,N as G,O as k,Q as ot,R as fe,T as j,U as B,V as lt,W as L,X as st,Y as q,Z as mt,_ as ct,a as se,ca as me,ea as W,ha as dt,ia as ce,ja as V,m as it,pa as J,q as nt,qa as ht,v as H}from"./chunk-QZ7GV5CC.js";import{$ as y,$b as Z,Db as Se,Eb as Ce,Fb as Ee,Gb as z,Hb as s,Ib as h,Ic as Ye,Jb as F,Kb as N,Kc as ye,Lb as Ie,Lc as R,Oa as m,Pa as u,Pb as D,Pc as et,R as oe,Rb as _,S as We,Tb as Xe,Tc as tt,W as le,_b as Q,aa as Je,eb as v,fb as ne,gb as c,ia as S,ja as C,jb as Ke,pb as i,qb as a,r as xe,rb as d,sb as Le,tb as qe,vb as w,xb as g,yb as f}from"./chunk-FI3UJX5Y.js";var A=(()=>{let o=class o{constructor(e){this.http=e,this.API_URL=ce.API_URL+"elaboraciones"}getAll(e){return this.http.get(this.API_URL+(e?"?recetaId="+e:""))}detail(e){return this.http.get(this.API_URL+"/"+e)}create(e){return this.http.post(this.API_URL,e)}edit(e,t){return this.http.put(this.API_URL+"/"+e,t)}delete(e){return this.http.delete(this.API_URL+"/"+e).pipe(xe(t=>t))}ngOnDestroy(){}};o.\u0275fac=function(t){return new(t||o)(le(se))},o.\u0275prov=oe({token:o,factory:o.\u0275fac});let n=o;return n})();var te=(()=>{let o=class o{constructor(e){this.http=e,this.API_URL=ce.API_URL+"notas"}create(e){return this.http.post(this.API_URL,e)}delete(e){return this.http.delete(this.API_URL+"/"+e).pipe(xe(t=>t))}ngOnDestroy(){}};o.\u0275fac=function(t){return new(t||o)(le(se))},o.\u0275prov=oe({token:o,factory:o.\u0275fac});let n=o;return n})();var Kt=["ingresosDropdown"];var Ot=(()=>{let o=class o{constructor(e,t,l,p,x){this.ref=e,this.fb=t,this.toastr=l,this.notaService=p,this.config=x,this.msjError=void 0,this.selectedIngresos=[],this.submited=!1,this.initForm()}ngOnInit(){this.callback=this.config.data.callback,this.elaboracionId=this.config.data.elaboracionId}cancel(){this.ref.close()}save(){let t={descripcion:this.myForm.getRawValue().descripcion,elaboracionId:this.elaboracionId};this.notaService.create(t).subscribe(()=>{this.toastr.success("Se ha a\xF1adido la nota!"),this.callback(),this.ref.close()})}initForm(){this.myForm=this.fb.group({descripcion:new fe("",[P.minLength(3),P.maxLength(256)])})}};o.\u0275fac=function(t){return new(t||o)(u(U),u(q),u(V),u(te),u(X))},o.\u0275cmp=y({type:o,selectors:[["app-ingreso-cambiar-nota"]],viewQuery:function(t,l){if(t&1&&Se(Kt,5),t&2){let p;Ce(p=Ee())&&(l.ingresosDropdown=p.first)}},features:[D([b,te])],decls:13,vars:5,consts:[[1,"p-fluid","p-formgrid","grid",3,"ngSubmit","formGroup"],[1,"field","col-12","md:col-12"],["htmlFor","descripcion"],[1,"text-danger"],["pInputText","","id","descripcion","type","text","placeholder","Escribe una nota","formControlName","descripcion","appCustomInputError","",3,"errors"],["customLabel","",3,"valueForm","errors"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"onClick"],["pRipple","","label","Aceptar","icon","pi pi-check","type","submit",3,"disabled"]],template:function(t,l){if(t&1&&(i(0,"div")(1,"form",0),g("ngSubmit",function(){return l.save()}),i(2,"div",1)(3,"label",2),s(4,"Nota "),i(5,"span",3),s(6,"*"),a()(),d(7,"textarea",4)(8,"span",5),a(),i(9,"div",6)(10,"div",7)(11,"p-button",8),g("onClick",function(){return l.cancel()}),a(),d(12,"p-button",9),a()()()()),t&2){let p,x,M;m(),c("formGroup",l.myForm),m(6),c("errors",(p=l.myForm.get("descripcion"))==null?null:p.errors),m(),c("valueForm",(x=l.myForm.get("descripcion"))==null?null:x.value)("errors",(M=l.myForm.get("descripcion"))==null?null:M.errors),m(4),c("disabled",l.myForm.invalid)}},dependencies:[T,J,j,we,G,k,B,L,ft,Fe],encapsulation:2});let n=o;return n})();var Oe=(()=>{let o=class o{constructor(e){this.http=e,this.API_URL=ce.API_URL+"estadoelaboracion"}create(e){return this.http.post(this.API_URL,e)}ngOnDestroy(){}};o.\u0275fac=function(t){return new(t||o)(le(se))},o.\u0275prov=oe({token:o,factory:o.\u0275fac});let n=o;return n})();function ei(n,o){if(n&1&&(i(0,"span",11),s(1),a()),n&2){let r=f();m(),F(" ",r.msjError!=null?r.msjError:""," ")}}var Gt=(()=>{let o=class o{constructor(e,t,l,p,x,M){this.dialogService=e,this.ref=t,this.fb=l,this.config=p,this.toastr=x,this.estadoElaboracionService=M,this.estados=Object.keys(E),this.msjError=void 0,this.currentDate=new Date,this.loading=!1,this.initForm()}ngOnInit(){this.elaboracionId=this.config.data.elaboracionId,this.estadoInicial=this.config.data.estadoInicial,this.callback=this.config.data.callback,this.myForm.get("estado").setValue(this.estadoInicial),this.myForm.get("estado").valueChanges.subscribe(e=>{e!=this.msjError&&(this.msjError=void 0)})}cancel(){this.ref.close()}save(){if(this.myForm.get("estado").value==this.estadoInicial){this.msjError="Debes asignar un estado distinto al actual";return}this.msjError=void 0,this.loading=!0,this.estadoElaboracionService.create({estado:this.myForm.get("estado").value,elaboracionId:this.elaboracionId,fecha:this.myForm.get("fecha").value}).subscribe(e=>{this.loading=!1,this.toastr.success("Se ha actualizado el estado de la elaboraci\xF3n!"),this.cancel(),this.callback()})}initForm(){this.myForm=this.fb.group({estado:["",P.required],fecha:[new Date,P.required]})}};o.\u0275fac=function(t){return new(t||o)(u(b),u(U),u(q),u(X),u(V),u(Oe))},o.\u0275cmp=y({type:o,selectors:[["app-elaboracion-cambiar-estado"]],features:[D([b,Oe])],decls:15,vars:11,consts:[[1,"p-fluid","p-formgrid","grid",3,"formGroup"],[1,"field","col-12","md:col-12"],["htmlFor","estado"],["placeholder","Selecciona un estado","formControlName","estado",3,"options","autoDisplayFirst","value"],["class","p-2 text-danger",4,"ngIf"],["htmlFor","descripcionid"],["inputId","calendar-24h","formControlName","fecha","dateFormat","dd/mm/yy ",1,"min-w-full",3,"showTime","maxDate","hourFormat","showIcon"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"click"],["pRipple","","label","Guardar","icon","pi pi-check",3,"onClick","disabled","loading"],[1,"p-2","text-danger"]],template:function(t,l){t&1&&(i(0,"div")(1,"form",0)(2,"div",1)(3,"label",2),s(4,"Estados *"),a(),d(5,"p-dropdown",3),v(6,ei,2,1,"span",4),a(),i(7,"div",1)(8,"label",5),s(9,"Fecha "),a(),d(10,"p-calendar",6),a(),i(11,"div",7)(12,"div",8)(13,"p-button",9),g("click",function(){return l.cancel()}),a(),i(14,"p-button",10),g("onClick",function(){return l.save()}),a()()()()()),t&2&&(m(),c("formGroup",l.myForm),m(4),c("options",l.estados)("autoDisplayFirst",!1)("value",l.myForm.get("estado")),m(),c("ngIf",l.msjError!=null),m(4),c("showTime",!0)("maxDate",l.currentDate)("hourFormat",24)("showIcon",!0),m(4),c("disabled",l.myForm.invalid)("loading",l.loading))},dependencies:[R,T,$,j,G,k,B,L,Pe],encapsulation:2});let n=o;return n})();function ii(n,o){if(n&1&&(i(0,"span",15),s(1),a()),n&2){let r=f();m(),F(" ",r.msjError!=null?r.msjError:""," ")}}var qt=(()=>{let o=class o{constructor(e,t,l,p,x,M,ue){this.dialogService=e,this.ref=t,this.fb=l,this.config=p,this.toastr=x,this.entregaElaboracionService=M,this.puntoVentaService=ue,this.msjError=void 0,this.currentDate=new Date,this.maxCantidad=0,this.loading=!1,this.puntosVenta=[],this.bloquear=!1,this.positiveNumberValidator=be=>{let He=be.value;return isNaN(He)||He<0?{positiveNumber:{value:be.value}}:null}}ngOnInit(){this.elaboracion=this.config.data.elaboracion,this.callback=this.config.data.callback,this.maxCantidad=this.elaboracion.cantidad-this.elaboracion.entregas.reduce((e,t)=>e+t.cantidad,0),this.bloquear=this.maxCantidad<=0||!0,this.initForm(),this.puntoVentaService.get().subscribe(e=>this.puntosVenta=e)}cancel(){this.ref.close()}save(){this.msjError=void 0,this.loading=!0,this.entregaElaboracionService.create({cantidad:this.myForm.get("cantidad").value,updateState:this.myForm.get("updateState").value,elaboracionId:this.elaboracion.id,puntoVentaId:this.myForm.get("puntoVentaId").value,fecha:this.myForm.get("fecha").value}).subscribe(e=>{this.loading=!1,this.toastr.success("Se ha registrado la entrega!"),this.cancel(),this.callback()})}initForm(){this.myForm=this.fb.group({cantidad:[null,[P.required,P.max(this.maxCantidad)]],fecha:[new Date,P.required],puntoVentaId:[null,P.required],updateState:[!1]})}};o.\u0275fac=function(t){return new(t||o)(u(b),u(U),u(q),u(X),u(V),u(Ve),u(Ae))},o.\u0275cmp=y({type:o,selectors:[["app-elaboracion-registrar-entrega"]],features:[D([b,Ve,Ae])],decls:27,vars:18,consts:[[1,"p-fluid","p-formgrid","grid",3,"formGroup"],[1,"field","col-12","md:col-12"],["htmlFor","estado"],[1,"text-danger"],["placeholder","Selecciona un Punto de Venta","optionLabel","nombre","formControlName","puntoVentaId","filterPlaceholder","Buscar","optionValue","id","filterBy","nombre",3,"options","autoDisplayFirst","filter","value"],["class","p-2 text-danger",4,"ngIf"],["htmlFor","cantidad"],["placeholder","Ingrese una cantidad","formControlName","cantidad","maxFractionDigits","0",3,"min","max","value"],["customLabel","",3,"valueForm","errors"],["htmlFor","fecha"],["inputId","calendar-24h","placeholder","Selecciona una fecha","formControlName","fecha","dateFormat","dd/mm/yy ",1,"min-w-full",3,"showTime","maxDate","showIcon","value"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"click"],["pRipple","","label","Guardar","icon","pi pi-check",3,"onClick","disabled","loading"],[1,"p-2","text-danger"]],template:function(t,l){if(t&1&&(i(0,"div")(1,"form",0)(2,"div",1)(3,"label",2),s(4,"Punto de Venta "),i(5,"span",3),s(6,"*"),a()(),d(7,"p-dropdown",4),v(8,ii,2,1,"span",5),a(),i(9,"div",1)(10,"label",6),s(11,"Cantidad "),i(12,"span",3),s(13,"*"),a()(),i(14,"p-inputGroup"),d(15,"p-inputNumber",7),i(16,"p-inputGroupAddon"),s(17),a()(),d(18,"span",8),a(),i(19,"div",1)(20,"label",9),s(21,"Fecha "),a(),d(22,"p-calendar",10),a(),i(23,"div",11)(24,"div",12)(25,"p-button",13),g("click",function(){return l.cancel()}),a(),i(26,"p-button",14),g("onClick",function(){return l.save()}),a()()()()()),t&2){let p,x;m(),c("formGroup",l.myForm),m(6),c("options",l.puntosVenta)("autoDisplayFirst",!1)("filter",!0)("value",l.myForm.get("puntoVentaId")),m(),c("ngIf",l.msjError!=null),m(7),c("min",1)("max",l.maxCantidad)("value",l.myForm.get("cantidad")),m(2),F("disponible: ",l.maxCantidad,""),m(),c("valueForm",(p=l.myForm.get("cantidad"))==null?null:p.value)("errors",(x=l.myForm.get("cantidad"))==null?null:x.errors),m(4),c("showTime",!1)("maxDate",l.currentDate)("showIcon",!0)("value",l.myForm.get("fecha")),m(4),c("disabled",l.myForm.invalid)("loading",l.loading)}},dependencies:[R,T,$,j,G,k,B,L,Fe,pe,de,Te,Pe],encapsulation:2});let n=o;return n})();var ie=()=>({"min-width":"50rem"}),Be=()=>[5,10,20],oi=()=>["autor.username","fecha","descripcion"],li=()=>["estado","fecha","autor.username"],si=()=>["cantidad","puntoVenta.nombre","autor.username","fecha"],mi=()=>["cantidad","ingrediente","ingresoCodigo","ingresoFecha","unidadMedida","familiaProductora","tipo"],ci=(n,o)=>({"text-success":n,"text-900":o});function di(n,o){if(n&1){let r=w();i(0,"div",20)(1,"h5",21),s(2,"Notas"),a(),i(3,"p-button",22),g("click",function(){S(r);let t=f(2);return C(t.openNotaForm())}),a()()}}function pi(n,o){n&1&&(i(0,"tr")(1,"th",23),s(2,"Fecha"),d(3,"p-sortIcon",24),a(),i(4,"th",25),s(5," Autor "),d(6,"p-sortIcon",26),a(),i(7,"th",27),s(8," Nota "),d(9,"p-sortIcon",28),a(),d(10,"th",29),a())}function ui(n,o){if(n&1){let r=w();i(0,"tr")(1,"td"),s(2),Q(3,"dateTransformPipe"),a(),i(4,"td"),s(5),a(),i(6,"td")(7,"b"),s(8),a()(),i(9,"td",29)(10,"p-button",30),g("onClick",function(){let t=S(r).$implicit,l=f(2);return C(l.deleteNota(t))}),a()()()}if(n&2){let r=o.$implicit;m(2),F(" ",Z(3,5,r.fecha)," "),m(3),h(r.autor.username),m(3),h(r.descripcion),m(2),c("rounded",!0)("text",!0)}}function fi(n,o){n&1&&(i(0,"tr")(1,"td",31),s(2," A\xFAn no se han agregado notas "),a()()),n&2&&(m(),ne("colspan",6))}function gi(n,o){if(n&1){let r=w();i(0,"h5"),s(1,"Historial de Estados"),a(),i(2,"div",20)(3,"span",32),d(4,"i",33),i(5,"input",34),g("input",function(t){S(r),f();let l=z(40);return C(l.filterGlobal(t.target.value,"contains"))}),a()(),i(6,"p-button",35),g("click",function(){S(r);let t=f(2);return C(t.openCambiarEstado())}),a()()}}function vi(n,o){n&1&&(i(0,"tr")(1,"th",23),s(2," Fecha Inicio"),d(3,"p-sortIcon",24),a(),i(4,"th",25),s(5," Autor "),d(6,"p-sortIcon",26),a(),i(7,"th",36),s(8," Estado "),d(9,"p-sortIcon",37),a()())}function hi(n,o){if(n&1&&(i(0,"tr")(1,"td"),s(2),Q(3,"dateTransformPipe"),a(),i(4,"td"),s(5),a(),i(6,"td"),d(7,"p-tag",38),a()()),n&2){let r=o.$implicit,e=f(2);m(2),F(" ",Z(3,4,r.fecha)," "),m(3),h(r.autor.username),m(2),c("value",r.estado)("severity",e.getEstadoSeverity(r.estado))}}function _i(n,o){n&1&&(i(0,"tr")(1,"td",31),s(2," No se encontraron resultados "),a()()),n&2&&(m(),ne("colspan",6))}function bi(n,o){if(n&1){let r=w();i(0,"div",20)(1,"h5"),s(2,"Entregas"),a(),i(3,"div",39),s(4," Entregado: "),i(5,"b"),s(6),a()()(),i(7,"div",20)(8,"span",32),d(9,"i",33),i(10,"input",34),g("input",function(t){S(r),f();let l=z(47);return C(l.filterGlobal(t.target.value,"contains"))}),a()(),i(11,"p-button",40),g("onClick",function(){S(r);let t=f(2);return C(t.openRegistrarEntrega())}),a()()}if(n&2){let r=f(2);m(3),c("ngClass",Xe(4,ci,r.totalEntregado===r.elaboracionDetalle.cantidad,r.totalEntregado!==r.elaboracionDetalle.cantidad)),m(3),N(" ",r.totalEntregado," / ",r.elaboracionDetalle.cantidad,""),m(5),c("disabled",r.totalEntregado>=r.elaboracionDetalle.cantidad)}}function xi(n,o){n&1&&(i(0,"tr")(1,"th",25),s(2," Autor"),d(3,"p-sortIcon",26),a(),i(4,"th",41),s(5," Cantidad "),d(6,"p-sortIcon",42),a(),i(7,"th",43),s(8," Punto de Venta "),d(9,"p-sortIcon",44),a(),i(10,"th",23),s(11," Fecha "),d(12,"p-sortIcon",24),a()())}function Si(n,o){if(n&1&&(i(0,"tr")(1,"td"),s(2),a(),i(3,"td"),s(4),a(),i(5,"td"),s(6),a(),i(7,"td"),s(8),Q(9,"dateTransformPipe"),a()()),n&2){let r=o.$implicit;m(2),F(" ",r.autor.username," "),m(2),h(r.cantidad),m(2),h(r.puntoVenta.nombre),m(2),h(Z(9,4,r.fecha))}}function Ci(n,o){n&1&&(i(0,"tr")(1,"td",31),s(2," A\xFAn no se han registrado entregas resultados "),a()()),n&2&&(m(),ne("colspan",6))}function Ei(n,o){if(n&1){let r=w();i(0,"div",20)(1,"h5"),s(2,"Consumos de Insumos y Materias Primas"),a(),i(3,"span",32),d(4,"i",33),i(5,"input",34),g("input",function(t){S(r),f();let l=z(54);return C(l.filterGlobal(t.target.value,"contains"))}),a()()()}}function Ii(n,o){n&1&&(i(0,"tr")(1,"th",45),s(2," Ingrediente"),d(3,"p-sortIcon",46),a(),i(4,"th",41),s(5," Cantidad "),d(6,"p-sortIcon",42),a(),i(7,"th",47),s(8,"Tipo "),d(9,"p-sortIcon",48),a(),i(10,"th",49),s(11," Familia Productora "),d(12,"p-sortIcon",50),a(),i(13,"th",51),s(14," C\xF3digo "),d(15,"p-sortIcon",52),a(),i(16,"th",53),s(17," Fecha Ingreso "),d(18,"p-sortIcon",54),a()())}function yi(n,o){if(n&1&&(i(0,"tr")(1,"td"),s(2),a(),i(3,"td"),s(4),a(),i(5,"td")(6,"b"),s(7),a()(),i(8,"td"),s(9),a(),i(10,"td"),s(11),a(),i(12,"td"),s(13),Q(14,"dateTransformPipe"),a()()),n&2){let r=o.$implicit;m(2),F(" ",r.ingrediente," "),m(2),N("",r.cantidad," ",r.unidadMedida,""),m(3),h(r.tipo),m(2),h(r.familiaProductora),m(2),h(r.ingresoCodigo),m(2),h(Z(14,7,r.ingresoFecha))}}function wi(n,o){n&1&&(i(0,"tr")(1,"td",31),s(2," No se encontraron resultados "),a()()),n&2&&(m(),ne("colspan",6))}function Fi(n,o){if(n&1&&(i(0,"div",6)(1,"div",7)(2,"div",8),s(3,"Detalle de elaboraci\xF3n"),a(),i(4,"div",9)(5,"div",10),s(6," Receta: "),i(7,"b"),s(8),a()(),i(9,"div",10),s(10," C\xF3digo: "),i(11,"b"),s(12),a()(),i(13,"div",10),s(14," Autor: "),i(15,"b"),s(16),a()(),i(17,"div",10),s(18," Estado: "),d(19,"p-tag",11),a(),i(20,"div",10),s(21," Cantidad: "),i(22,"b"),s(23),a()(),i(24,"div",10),s(25," Actualizado: "),i(26,"b"),s(27),Q(28,"dateTransformPipe"),a()()()(),i(29,"div"),d(30,"p-divider"),i(31,"div",12)(32,"p-table",13,0),v(34,di,4,0,"ng-template",14)(35,pi,11,0,"ng-template",15)(36,ui,11,7,"ng-template",16)(37,fi,3,1,"ng-template",17),a()(),i(38,"div",18)(39,"p-table",19,1),v(41,gi,7,0,"ng-template",14)(42,vi,10,0,"ng-template",15)(43,hi,8,6,"ng-template",16)(44,_i,3,1,"ng-template",17),a()(),i(45,"div",18)(46,"p-table",19,2),v(48,bi,12,7,"ng-template",14)(49,xi,13,0,"ng-template",15)(50,Si,10,6,"ng-template",16)(51,Ci,3,1,"ng-template",17),a()(),i(52,"div",18)(53,"p-table",19,3),v(55,Ei,6,0,"ng-template",14)(56,Ii,19,0,"ng-template",15)(57,yi,15,9,"ng-template",16)(58,wi,3,1,"ng-template",17),a()()()()),n&2){let r=f();m(8),h(r.elaboracionDetalle.receta.nombre),m(4),h(r.elaboracionDetalle.codigo),m(4),h(r.autor),m(3),c("value",r.elaboracionDetalle.estado.estado)("severity",r.getEstadoSeverity(r.elaboracionDetalle.estado.estado)),m(4),N("",r.elaboracionDetalle.cantidad," ",r.elaboracionDetalle.cantidad>1?"UNIDADES":"UNIDAD",""),m(4),h(Z(28,40,r.elaboracionDetalle.estado.fecha)),m(5),c("value",r.elaboracionDetalle.notas)("tableStyle",_(42,ie))("paginator",!0)("alwaysShowPaginator",!1)("rows",5)("tableStyle",_(43,ie))("rowsPerPageOptions",_(44,Be))("globalFilterFields",_(45,oi)),m(7),c("value",r.elaboracionDetalle.estados)("tableStyle",_(46,ie))("paginator",!0)("rows",5)("tableStyle",_(47,ie))("alwaysShowPaginator",!1)("rowsPerPageOptions",_(48,Be))("globalFilterFields",_(49,li)),m(7),c("value",r.elaboracionDetalle.entregas)("tableStyle",_(50,ie))("paginator",!0)("rows",5)("tableStyle",_(51,ie))("alwaysShowPaginator",!1)("rowsPerPageOptions",_(52,Be))("globalFilterFields",_(53,si)),m(7),c("value",r.consumos)("tableStyle",_(54,ie))("paginator",!0)("rows",5)("tableStyle",_(55,ie))("alwaysShowPaginator",!1)("rowsPerPageOptions",_(56,Be))("globalFilterFields",_(57,mi))}}var $t=(()=>{let o=class o{constructor(e,t,l,p,x,M,ue){this.elaboracionService=e,this.router=t,this.toastr=l,this.activatedRoute=p,this.dialogService=x,this.confirmationDialogService=M,this.notaService=ue,this.loading=!1,this.consumos=[],this.totalEntregado=0,this.id=Number(this.activatedRoute.snapshot.paramMap.get("id"))}ngOnInit(){this.init()}get autor(){return this.elaboracionDetalle?this.elaboracionDetalle.estados[0]?.autor.nombre:""}openNotaForm(){let e=this.init.bind(this);this.ref=this.dialogService.open(Ot,{header:"Agregar Nota",width:"50vw",breakpoints:{"960px":"75vw","640px":"90vw"},closable:!1,contentStyle:{overflow:"visible"},data:{callback:e,elaboracionId:this.elaboracionDetalle.id}}),this.ref.onClose.subscribe(t=>{})}openCambiarEstado(){let e=this.init.bind(this);this.ref=this.dialogService.open(Gt,{header:"Cambiar estado de la elaboraci\xF3n",width:"30vw",breakpoints:{"960px":"75vw","640px":"90vw"},closable:!1,contentStyle:{overflow:"visible"},data:{callback:e,elaboracionId:this.elaboracionDetalle.id,estadoInicial:this.elaboracionDetalle.estado.estado}}),this.ref.onClose.subscribe(t=>{})}openRegistrarEntrega(){let e=this.init.bind(this);this.ref=this.dialogService.open(qt,{header:"Registrar Entrega",width:"30vw",breakpoints:{"960px":"75vw","640px":"90vw"},closable:!1,contentStyle:{overflow:"visible"},data:{callback:e,elaboracion:this.elaboracionDetalle}}),this.ref.onClose.subscribe(t=>{this.init()})}getEstadoSeverity(e){switch(e){case E.ENTREGADO_COMPLETO:return"success";case E.ENTREGADO_PARCIAL:return"primary";case E.EN_DEPOSITO:return"warning";case E.EN_PROCESO:return"info"}return""}init(){this.elaboracionService.detail(this.id).subscribe(e=>{this.elaboracionDetalle=e;let t=e.consumosMateriaPrima.map(p=>({cantidad:p.cantidad,unidadMedida:p.unidadMedida,ingresoCodigo:p.ingresoMateriaPrima.codigo,tipo:"MATERIA PRIMA",ingrediente:p.ingresoMateriaPrima.materiaPrima.nombre,familiaProductora:p.ingresoMateriaPrima.familiaProductora.nombre,ingresoFecha:p.ingresoMateriaPrima.fecha})),l=e.consumosInsumo.map(p=>({cantidad:p.cantidad,unidadMedida:p.insumo.unidadMedida,tipo:"INSUMO",ingresoCodigo:null,ingrediente:p.insumo.nombre,familiaProductora:null,ingresoFecha:null}));this.consumos=[...t,...l],this.totalEntregado=e.entregas.reduce((p,x)=>p+x.cantidad,0)})}deleteNota(e){let t=this.init.bind(this);this.confirmationDialogService.confirmDelete("\xBFEst\xE1 seguro que desea eliminar la nota?",()=>{console.log(e),this.notaService.delete(e.id).subscribe(()=>{this.toastr.success("Se ha eliminado la nota!"),t()})})}back(){this.router.navigate(["/"+I.Elaboracion,I.Query])}};o.\u0275fac=function(t){return new(t||o)(u(A),u(W),u(V),u(me),u(b),u(ge),u(te))},o.\u0275cmp=y({type:o,selectors:[["elaboracion-detail"]],features:[D([A,b,ge,te])],decls:2,vars:1,consts:[["dt2",""],["dt",""],["dt4",""],["dt3",""],["pRipple","","label","Volver","icon","pi pi-arrow-left","styleClass","mb-2","severity","secondary",3,"click"],["class","card relative",4,"ngIf"],[1,"card","relative"],[1,"mt-2"],[1,"mb-4","font-bold"],[1,"grid","text-lg"],[1,"col-6"],[1,"ml-1",3,"value","severity"],[1,"bg-item","border-round"],[3,"value","tableStyle","paginator","alwaysShowPaginator","rows","rowsPerPageOptions","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"mt-3","bg-item","border-round"],[3,"value","tableStyle","paginator","rows","alwaysShowPaginator","rowsPerPageOptions","globalFilterFields"],[1,"flex","align-items-center","justify-content-between"],[1,"m-0"],["pRipple","","label","Agregar Nota","icon","pi pi-plus","styleClass","mb-2","severity","primary",3,"click"],["pSortableColumn","fecha"],["field","fecha"],["pSortableColumn","autor.username"],["field","autor.username"],["pSortableColumn","descripcion"],["field","descripcion"],[2,"width","80px"],["pRipple","","icon","pi pi-trash","severity","secondary",3,"onClick","rounded","text"],[1,"text-center","py-4"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pRipple","","label","Cambiar estado","icon","pi pi-tag","styleClass","mb-2","severity","primary",3,"click"],["pSortableColumn","estado"],["field","estado"],[3,"value","severity"],[3,"ngClass"],["pRipple","","label","Registrar Entrega","icon","pi pi-truck","styleClass","mb-2","severity","primary",3,"onClick","disabled"],["pSortableColumn","cantidad"],["field","cantidad"],["pSortableColumn","puntoVenta.nombre"],["field","puntoVenta.nombre"],["pSortableColumn","ingrediente"],["field","ingrediente"],["pSortableColumn","tipo"],["field","tipo"],["pSortableColumn","familiaProductora"],["field","familiaProductora"],["pSortableColumn","ingresoCodigo"],["field","ingresoCodigo"],["pSortableColumn","ingresoFecha"],["field","ingresoFecha"]],template:function(t,l){t&1&&(i(0,"p-button",4),g("click",function(){return l.back()}),a(),v(1,Fi,59,58,"div",5)),t&2&&(m(),c("ngIf",!!l.elaboracionDetalle))},dependencies:[Ye,R,Ne,H,Me,Re,T,K,J,je,De]});let n=o;return n})();var Ti=["ingresosDropdown"],Pi=()=>({height:"2.5rem"});function Ni(n,o){if(n&1&&(i(0,"div",17)(1,"div"),s(2),a(),i(3,"div",18),s(4),d(5,"p-tag",19),a()()),n&2){let r=o.$implicit,e=f(2);m(2),h(r.codigo),m(2),N(" disponible (",r.cantidad," ",e.materiaPrima.unidadMedida,") "),m(),c("value",r.currentState.nombre)("severity",e.getSeverity(r.currentState.nombre))}}function Mi(n,o){n&1&&d(0,"i",20)}function Ri(n,o){if(n&1){let r=w();i(0,"div",21)(1,"span")(2,"b"),s(3),a(),d(4,"p-tag",19),a(),i(5,"div",22)(6,"span",18),s(7),a(),i(8,"p-inputGroup",23),d(9,"p-inputNumber",24),i(10,"p-inputGroupAddon"),s(11),a()(),i(12,"p-button",25),g("onClick",function(){let t=S(r).$implicit,l=f(2);return C(l.onDeleteIngreso(t.id))}),a()()()}if(n&2){let r=o.$implicit,e=o.index,t=f(2);m(3),h(r.codigo),m(),c("value",r.currentState.nombre)("severity",t.getSeverity(r.currentState.nombre)),m(3),N(" (disponible: ",r.cantidad," ",t.materiaPrima.unidadMedida,")"),m(),Ke(_(13,Pi)),m(),c("maxFractionDigits",2)("formControlName",e)("max",r.cantidad),m(2),h(t.materiaPrima.unidadMedida),m(),c("rounded",!0)("text",!0)}}function ki(n,o){if(n&1&&(i(0,"div",26),s(1),a()),n&2){let r=o.ngIf;m(),F(" ",r," ")}}function ji(n,o){if(n&1){let r=w();i(0,"div")(1,"form",2),g("ngSubmit",function(){S(r);let t=f();return C(t.save())}),i(2,"div",3),s(3," Por favor, selecciona los ingresos y cantidades correspondientes a las materias primas utilizados en la elaboraci\xF3n. "),a(),i(4,"div",4)(5,"label",5),s(6,"Ingresos"),a(),i(7,"p-dropdown",6,0),g("onChange",function(t){S(r);let l=f();return C(l.onSelectIngreso(t))}),v(9,Ni,6,5,"ng-template",7),a()(),i(10,"div",8),s(11),v(12,Mi,1,0,"i",9),a(),i(13,"div",10),v(14,Ri,13,14,"div",11),a(),v(15,ki,2,1,"div",12),i(16,"div",13)(17,"div",14)(18,"p-button",15),g("onClick",function(){S(r);let t=f();return C(t.cancel())}),a(),d(19,"p-button",16),a()()()()}if(n&2){let r=f();m(),c("formGroup",r.myForm),m(6),c("options",r.materiaPrima.ingresos)("autoDisplayFirst",!1)("filter",!0)("showClear",!0),m(4),Ie(" ",r.getMin(r.cantidadRequerida,r.cantidadTotalSeleccionada)," / ",r.cantidadRequerida," ",r.materiaPrima.unidadMedida," "),m(),c("ngIf",r.cantidadRequerida<=r.materiaPrima.totalCantidadDisponible),m(2),c("ngForOf",r.selectedIngresos),m(),c("ngIf",r.getErrorMessage())}}function Ut(n){return n.value>0?null:{greaterThanZero:!0}}var Qt=(()=>{let o=class o{constructor(e,t,l,p){this.ref=e,this.fb=t,this.config=l,this.materiaPrimaService=p,this.msjError=void 0,this.selectedIngresos=[],this.submited=!1,this.initForm()}ngOnInit(){this.materiaPrimaId=this.config.data.materiaPrima.id,this.cantidadRequerida=this.config.data.cantidadRequerida;let e=this.config.data.initialData??[];this.callback=this.config.data.callback,this.materiaPrimaId&&this.materiaPrimaService.getById(this.materiaPrimaId).subscribe(t=>{this.materiaPrima=t,e.forEach(l=>{let p=this.materiaPrima.ingresos.find(x=>x.id==l.ingresoMateriaPrimaId);p&&(this.selectedIngresos.push(p),this.getIngresosFormArr().push(new fe(l.cantidad,Ut)))})})}onSelectIngreso(e){let t=e.value;t&&(this.selectedIngresos.find(l=>l.id==t.id)||(this.selectedIngresos.push(t),this.getIngresosFormArr().push(new fe(0,Ut))),this.ingresosDropdown.clear())}onDeleteIngreso(e){let t=this.selectedIngresos.findIndex(l=>l.id==e);t>-1&&(this.selectedIngresos.splice(t,1),this.getIngresosFormArr().removeAt(t))}getIngresosFormArr(){return this.myForm.get("cantidades")}getMin(e,t){return Math.min(e,t)}cancel(){this.ref.close()}save(){let e=this.getIngresosFormArr().getRawValue(),t=this.selectedIngresos.map((l,p)=>({ingresoMateriaPrimaId:l.id,cantidad:e[p]}));this.submited=!0,!this.getErrorMessage()&&(console.log({materiaPrimaId:this.materiaPrimaId,data:t}),this.callback(this.materiaPrimaId,t),this.ref.close())}get cantidadTotalSeleccionada(){return this.getIngresosFormArr().getRawValue().reduce((t,l)=>t+l,0)}getErrorMessage(){return this.submited?this.cantidadTotalSeleccionada>this.cantidadRequerida?"La cantidad seleccionada supera la cantidad requerida, por favor ajusta las cantidades.":this.cantidadTotalSeleccionada<this.cantidadRequerida?"La cantidad seleccionada no cubre la cantidad requerida, por favor ajusta las cantidades.":null:null}getSeverity(e){switch(e){case ke.CAMARA_FRIO:return"primary";case ke.ESTANTE:return"warning";case ke.FREEZER:return"info"}}initForm(){this.myForm=this.fb.group({cantidades:new st([],P.required)})}};o.\u0275fac=function(t){return new(t||o)(u(U),u(q),u(X),u(Y))},o.\u0275cmp=y({type:o,selectors:[["app-ingreso-cambiar-estado"]],viewQuery:function(t,l){if(t&1&&Se(Ti,5),t&2){let p;Ce(p=Ee())&&(l.ingresosDropdown=p.first)}},features:[D([b,Y])],decls:1,vars:1,consts:[["ingresosDropdown",""],[4,"ngIf"],[1,"p-fluid","p-formgrid","grid",3,"ngSubmit","formGroup"],[1,"col-12","md:col-12","text-400"],[1,"field","col-12","md:col-12"],["htmlFor","estado"],["placeholder","Buscar ingresos","optionLabel","codigo","filterPlaceholder","C\xF3digo de ingreso","filterBy","codigo",3,"onChange","options","autoDisplayFirst","filter","showClear"],["pTemplate","item"],[1,"ml-auto"],["class","fa-solid fa-check text-success",4,"ngIf"],["formArrayName","cantidades",1,"field","col-12","flex","flex-column","gap-1"],["class","shadow-1 px-2 pl-2 pr-1 flex justify-content-between align-items-center border-round-md bg-item",4,"ngFor","ngForOf"],["class","text-danger p-3",4,"ngIf"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"onClick"],["pRipple","","label","Aceptar","icon","pi pi-check","type","submit"],[1,"flex","align-items-center","justify-content-between","gap-2"],[1,"text-sm"],[1,"ml-2",3,"value","severity"],[1,"fa-solid","fa-check","text-success"],[1,"shadow-1","px-2","pl-2","pr-1","flex","justify-content-between","align-items-center","border-round-md","bg-item"],[1,"flex","gap-2","align-items-center"],[1,"w-10rem"],["placeholder","Cantidad","size","2",3,"maxFractionDigits","formControlName","max"],["pRipple","","icon","pi pi-trash","severity","secondary",3,"onClick","rounded","text"],[1,"text-danger","p-3"]],template:function(t,l){t&1&&v(0,ji,20,11,"div",1),t&2&&c("ngIf",l.materiaPrima)},dependencies:[ye,R,H,T,K,$,j,G,k,B,L,lt,pe,de,Te],encapsulation:2});let n=o;return n})();var Ai=()=>({width:"100%"});function Oi(n,o){if(n&1&&d(0,"p-tag",29),n&2){let r=o.$implicit,e=f();c("value",r)("severity",e.getEstadoSeverity(r))}}function Gi(n,o){if(n&1&&d(0,"p-tag",29),n&2){let r=o.$implicit,e=f();c("value",r)("severity",e.getEstadoSeverity(r))}}function Bi(n,o){n&1&&d(0,"i",38)}function Li(n,o){if(n&1&&(i(0,"div",39),s(1," No cuentas con las cantidades necesarias "),i(2,"div",40),s(3),a()()),n&2){let r=f(2).$implicit;m(3),N(" (disponible: ",r.insumo.cantidadDisponible," ",r.insumo.unidadMedida,") ")}}function qi(n,o){if(n&1&&(i(0,"div",41),s(1),a()),n&2){let r=f(2).$implicit;m(),N(" disponible: ",r.insumo.cantidadDisponible," ",r.insumo.unidadMedida," ")}}function $i(n,o){if(n&1&&(Le(0),i(1,"div",32)(2,"div")(3,"h6",33),s(4),a()(),i(5,"div",34)(6,"div"),s(7),v(8,Bi,1,0,"i",35),a(),v(9,Li,4,2,"div",36)(10,qi,2,2,"div",37),a()(),qe()),n&2){let r=o.ngIf,e=f().$implicit;m(4),h(e.insumo.nombre),m(3),N("",r," ",e.insumo.unidadMedida," "),m(),c("ngIf",r<=e.insumo.cantidadDisponible),m(),c("ngIf",r>e.insumo.cantidadDisponible),m(),c("ngIf",r<=e.insumo.cantidadDisponible)}}function Ui(n,o){if(n&1&&(i(0,"div",30),v(1,$i,11,6,"ng-container",31),a()),n&2){let r,e=o.$implicit,t=f();m(),c("ngIf",(((r=t.form.get("cantidad"))==null?null:r.value)*e.cantidad).toFixed(1))}}function Qi(n,o){n&1&&d(0,"i",38)}function Zi(n,o){if(n&1&&(i(0,"div",39),s(1," No cuentas con las cantidades necesarias "),i(2,"div",40),s(3),a()()),n&2){let r=f(2).$implicit;m(3),N(" (disponible: ",r.materiaPrima.totalCantidadDisponible," ",r.materiaPrima.unidadMedida,") ")}}function zi(n,o){if(n&1&&(i(0,"div",46),s(1),a()),n&2){let r=f(2).$implicit;m(),N(" disponible: ",r.materiaPrima.totalCantidadDisponible," ",r.materiaPrima.unidadMedida," ")}}function Hi(n,o){if(n&1){let r=w();Le(0),i(1,"div",32)(2,"div")(3,"h6",33),s(4),a()(),i(5,"div",43)(6,"div",34)(7,"div"),s(8),v(9,Qi,1,0,"i",35),a(),v(10,Zi,4,2,"div",36)(11,zi,2,2,"div",44),a(),i(12,"p-button",45),g("click",function(){S(r);let t=f().$implicit,l=f();return C(l.openSelectorIngresos(t))}),a()()(),qe()}if(n&2){let r=o.ngIf,e=f().$implicit,t=f();m(4),h(e.materiaPrima.nombre),m(4),Ie(" ",t.getMin(t.consumosMateriaPrima.get(e.materiaPrima.id)?r:0,e.materiaPrima.totalCantidadDisponible)," / ",r," ",e.materiaPrima.unidadMedida," "),m(),c("ngIf",t.consumosMateriaPrima.get(e.materiaPrima.id)),m(),c("ngIf",r>e.materiaPrima.totalCantidadDisponible),m(),c("ngIf",r<=e.materiaPrima.totalCantidadDisponible)}}function Wi(n,o){if(n&1&&(i(0,"div",42),v(1,Hi,13,7,"ng-container",31),a()),n&2){let r=o.$implicit,e=f();m(),c("ngIf",e.getCantidad(r))}}var Zt=(()=>{let o=class o{constructor(e,t,l,p,x,M,ue,be){this.fb=e,this.router=t,this.recetaService=l,this.materiasPrimaService=p,this.activatedRoute=x,this.dialogService=M,this.elaboracionService=ue,this.toastr=be,this.detalleMateriaPrima=new Map,this.consumosMateriaPrima=new Map,this.unidadMedidaArray=Object.keys(Mt),this.estados=Object.keys(E),this.loading=!1,this.insumosInsuficientes=!1,this.materiasPrimasInsuficientes=!1,this.initForm(),this.consumosMateriaPrima=new Map,this.recetaId=Number(this.activatedRoute.snapshot.paramMap.get("id"))}ngOnInit(){this.recetaService.detail(this.recetaId).subscribe(e=>{this.receta=e,this.insumos=e.ingredientes.filter(t=>t.insumo!=null),this.materiasPrimas=e.ingredientes.filter(t=>t.materiaPrima!=null),this.materiasPrimas.forEach(t=>{this.materiasPrimaService.getById(t.materiaPrima.id).subscribe(l=>{this.detalleMateriaPrima.set(l.id,l),console.log(l,t.cantidad),l.totalCantidadDisponible<t.cantidad&&(this.materiasPrimasInsuficientes=!0)})}),this.insumos.some(t=>t.cantidad>t.insumo.cantidadDisponible)&&(this.insumosInsuficientes=!0)})}initForm(){this.form=this.fb.group({cantidad:[1,P.required],estado:E.EN_PROCESO,nota:[""]})}cancel(){this.router.navigate(["/"+I.Elaboracion])}save(){let e=this.form.getRawValue(),t=Array.from(this.consumosMateriaPrima.values()),l={cantidad:e.cantidad,estado:e.estado,fecha:new Date,nota:e.nota,recetaId:this.recetaId,consumoMateriasPrimas:t.flat()};this.loading=!0,this.elaboracionService.create(l).subscribe(p=>{this.loading=!1,this.toastr.success("Se ha creado la elaboraci\xF3n!"),this.router.navigate(["/"+I.Elaboracion+"/"+I.Detail+"/"+p.id])})}getMin(e,t){return Math.min(e,t)}getCantidad(e){return(e.cantidad*(this.form.get("cantidad")?.value??0)).toFixed(1)}onIngresosSelected(e,t){this.consumosMateriaPrima.set(e,t)}openSelectorIngresos(e){let t=this.onIngresosSelected.bind(this);this.ref=this.dialogService.open(Qt,{header:"Seleccionar ingresos de "+e.materiaPrima.nombre,width:"50vw",closable:!1,contentStyle:{overflow:"visible"},data:{materiaPrima:e.materiaPrima,cantidadRequerida:this.getCantidad(e),initialData:this.consumosMateriaPrima.get(e.materiaPrima.id),callback:t}}),this.ref.onClose.subscribe(l=>{})}getEstadoSeverity(e){switch(e){case E.ENTREGADO_COMPLETO:return"success";case E.ENTREGADO_PARCIAL:return"primary";case E.EN_DEPOSITO:return"warning";case E.EN_PROCESO:return"info"}return""}get invalid(){}};o.\u0275fac=function(t){return new(t||o)(u(q),u(W),u(ee),u(Y),u(me),u(b),u(A),u(V))},o.\u0275cmp=y({type:o,selectors:[["app-insumos-new"]],features:[D([ee,Y,b,A])],decls:47,vars:15,consts:[[1,"card",2,"width","80%"],[1,"mb-5"],[1,"p-fluid","p-formgrid","grid",3,"formGroup"],[1,"field","col-12","md:col-12"],["htmlFor","recetaId",1,"mr-3"],["id","recetaId","type","text","pInputText","",1,"font-bold",3,"disabled","value"],[1,"field","col-12","md:col-4"],["htmlFor","unidadMedida"],[1,"text-danger"],["placeholder","Ingrese una cantidad","formControlName","cantidad",3,"value"],[1,"field","col-12","md:col-8"],["htmlFor","nota",1,"mr-3"],["id","nota","type","text","placeholder","Nota Adicional","pInputText","","formControlName","nota",3,"disabled","value"],["htmlFor","estado"],["placeholder","Selecciona un estado","formControlName","estado",3,"options","autoDisplayFirst","value"],["pTemplate","selectedItem"],["pTemplate","item"],["styleClass","w-full",3,"ngStyle"],[1,"grid","w-full","col-12"],[1,"field","col-12"],["htmlFor","familiaPrimaId",1,"mr-3","text-lg","font-bold"],[1,"flex","flex-column","gap-1","mt-2"],["class","shadow-1 p-2 px-3 border-round-md border-200 border-1 bg-item",4,"ngFor","ngForOf"],[1,"flex","justify-content-between"],[1,"mr-3","text-lg","font-bold"],["class","shadow-1 p-3 border-round-md border-200 border-1 bg-item",4,"ngFor","ngForOf"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"onClick"],["pRipple","","label","Guardar","icon","pi pi-check",3,"onClick","loading","disabled"],[3,"value","severity"],[1,"shadow-1","p-2","px-3","border-round-md","border-200","border-1","bg-item"],[4,"ngIf"],[1,"flex","justify-content-between","align-items-center","flex-wrap"],[1,"mb-2"],[1,"flex","flex-column","align-items-end"],["class","fa-solid fa-check text-success",4,"ngIf"],["class","flex align-items-end text-danger flex-wrap text-sm",4,"ngIf"],["class","text-success text-sm",4,"ngIf"],[1,"fa-solid","fa-check","text-success"],[1,"flex","align-items-end","text-danger","flex-wrap","text-sm"],[1,"ml-1"],[1,"text-success","text-sm"],[1,"shadow-1","p-3","border-round-md","border-200","border-1","bg-item"],[1,"flex","flex-wrap","gap-4"],["class","text-info text-sm",4,"ngIf"],["pRipple","","label","Seleccionar Ingresos","size","small","severity","secondary",3,"click"],[1,"text-info","text-sm"]],template:function(t,l){t&1&&(i(0,"div",0)(1,"h5",1),s(2,"Nueva Elaboraci\xF3n"),a(),i(3,"form",2)(4,"div",3)(5,"label",4),s(6,"Receta: "),a(),d(7,"input",5),a(),i(8,"div",6)(9,"label",7),s(10,"Cantidad "),i(11,"span",8),s(12,"*"),a()(),i(13,"p-inputGroup"),d(14,"p-inputNumber",9),a()(),i(15,"div",10)(16,"label",11),s(17,"Nota Adicional: "),a(),d(18,"input",12),a(),i(19,"div",3)(20,"label",13),s(21,"Estado "),i(22,"span",8),s(23,"*"),a()(),i(24,"p-dropdown",14),v(25,Oi,1,2,"ng-template",15)(26,Gi,1,2,"ng-template",16),a()(),d(27,"p-divider",17),i(28,"div",3)(29,"h5"),s(30,"Ingredientes"),a(),i(31,"div",18)(32,"div",19)(33,"label",20),s(34,"Insumos"),a(),i(35,"div",21),v(36,Ui,2,1,"div",22),a()(),i(37,"div",19)(38,"div",23)(39,"label",24),s(40,"Materias Primas"),a()(),i(41,"div",21),v(42,Wi,2,1,"div",25),a()()()(),i(43,"div",19)(44,"div",26)(45,"p-button",27),g("onClick",function(){return l.cancel()}),a(),i(46,"p-button",28),g("onClick",function(){return l.save()}),a()()()()()),t&2&&(m(3),c("formGroup",l.form),m(4),c("disabled",!0)("value",l.receta==null?null:l.receta.nombre),m(7),c("value",l.form.get("cantidad")),m(4),c("disabled",!0)("value",l.form.get("nota")),m(6),c("options",l.estados)("autoDisplayFirst",!1)("value",l.form.get("estado")),m(3),c("ngStyle",_(14,Ai)),m(9),c("ngForOf",l.insumos),m(6),c("ngForOf",l.materiasPrimas),m(4),c("loading",l.loading)("disabled",l.form.invalid||l.insumosInsuficientes||l.materiasPrimasInsuficientes))},dependencies:[ye,R,et,H,T,K,J,$,j,we,G,k,B,L,je,pe,de],encapsulation:2});let n=o;return n})();function Ji(n,o){if(n&1){let r=w();i(0,"div")(1,"form",1),g("ngSubmit",function(){S(r);let t=f();return C(t.save())}),i(2,"div",2),s(3," Por favor, selecciona la receta que deseas a elaborar para continuar. "),a(),i(4,"div",3)(5,"p-dropdown",4),g("onChange",function(t){S(r);let l=f();return C(l.onSelectReceta(t))}),a()(),i(6,"div",5)(7,"div",6)(8,"p-button",7),g("onClick",function(){S(r);let t=f();return C(t.cancel())}),a(),d(9,"p-button",8),a()()()()}if(n&2){let r=f();m(5),c("options",r.recetas)("autoDisplayFirst",!1)("filter",!0),m(4),c("disabled",!r.recetaId)}}var zt=(()=>{let o=class o{constructor(e,t,l){this.ref=e,this.recetaService=t,this.router=l,this.recetas=[]}ngOnInit(){this.recetaService.get().subscribe(e=>{this.recetas=e})}onSelectReceta(e){this.recetaId=e.value.id}cancel(){this.ref.close()}save(){this.recetaId&&(this.router.navigate([`/${I.Elaboracion}/${I.New}/`,this.recetaId]),this.ref.close())}};o.\u0275fac=function(t){return new(t||o)(u(U),u(ee),u(W))},o.\u0275cmp=y({type:o,selectors:[["app-ingreso-cambiar-estado"]],features:[D([b,ee])],decls:1,vars:1,consts:[[4,"ngIf"],[1,"p-fluid","p-formgrid","grid",3,"ngSubmit"],[1,"col-12","md:col-12","text-400"],[1,"field","col-12","md:col-12"],["placeholder","Buscar recetas","optionLabel","nombre","filterPlaceholder","Buscar recetas","filterBy","nombre",3,"onChange","options","autoDisplayFirst","filter"],[1,"field","col-12"],[1,"flex","justify-content-between","flex-wrap"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","secondary",3,"onClick"],["pRipple","","label","Continuar","icon","pi pi-check","type","submit",3,"disabled"]],template:function(t,l){t&1&&v(0,Ji,10,4,"div",0),t&2&&c("ngIf",l.recetas)},dependencies:[R,T,$,j,k,ot],encapsulation:2});let n=o;return n})();var Ht=()=>({"min-width":"50rem"}),Ki=()=>[5,10,20],Xi=()=>["codigo","receta","cantidad","autor.username"];function Yi(n,o){if(n&1){let r=w();i(0,"h2",9),s(1,"Elaboraciones"),a(),i(2,"div",10)(3,"div",11)(4,"span",12),d(5,"i",13),i(6,"input",14),g("input",function(t){S(r),f();let l=z(2);return C(l.filterGlobal(t.target.value,"contains"))}),a()()(),i(7,"p-button",15),g("click",function(){S(r);let t=f();return C(t.openSelectorReceta())}),a()()}}function en(n,o){n&1&&(i(0,"tr")(1,"th"),s(2,"Acciones"),a(),i(3,"th",16),s(4," Fecha Inicio"),d(5,"p-sortIcon",17),a(),i(6,"th",18),s(7,"C\xF3digo "),d(8,"p-sortIcon",19),a(),i(9,"th",20),s(10,"Receta "),d(11,"p-sortIcon",21),a(),i(12,"th",22),s(13," Cantidad "),d(14,"p-sortIcon",23),a(),i(15,"th",24),s(16," Autor "),d(17,"p-sortIcon",25),a(),i(18,"th",26),s(19,"Estado "),d(20,"p-sortIcon",27),a(),i(21,"th",28),s(22," Actualizado"),d(23,"p-sortIcon",29),a()())}function tn(n,o){if(n&1){let r=w();i(0,"tr")(1,"td")(2,"button",30),g("click",function(t){let l=S(r).$implicit,p=z(4),x=f();return C(x.generateMenu(l,p,t))}),a(),d(3,"p-menu",31,1),a(),i(5,"td"),s(6),Q(7,"dateTransformPipe"),a(),i(8,"td"),s(9),a(),i(10,"td")(11,"b"),s(12),a()(),i(13,"td"),s(14),a(),i(15,"td")(16,"b"),s(17),a()(),i(18,"td"),d(19,"p-tag",32),a(),i(20,"td"),s(21),Q(22,"dateTransformPipe"),a()()}if(n&2){let r=o.$implicit,e=f();m(3),c("popup",!0)("model",e.itemsMenu),m(3),F(" ",Z(7,10,r.fecha)," "),m(3),h(r.codigo),m(3),h(r.receta),m(2),h(r.cantidad),m(3),h(r.autor.username),m(2),c("value",r.estado.estado)("severity",e.getEstadoSeverity(r.estado.estado)),m(2),F(" ",Z(22,12,r.estado.fecha)," ")}}function nn(n,o){n&1&&(i(0,"tr")(1,"td",33),s(2," No se encontraron resultados "),a()()),n&2&&(m(),ne("colspan",6))}function an(n,o){if(n&1&&(i(0,"div",34),s(1),a()),n&2){let r=f(),e=z(2);m(),F(" En total hay ",e.filteredValue?e.filteredValue.length:r.elaboraciones.length," registros. ")}}var Wt=(()=>{let o=class o{constructor(e,t,l,p,x,M){this.elaboracionService=e,this.router=t,this.toastr=l,this.confirmationDialogService=p,this.activatedRoute=x,this.dialogService=M,this.elaboraciones=[],this.loading=!0,this.itemsMenu=[]}ngOnInit(){this.recetaId=Number(this.activatedRoute.snapshot.paramMap.get("id")),this.fetchAll()}fetchAll(){this.loading=!0,this.elaboracionService.getAll().subscribe(e=>{this.elaboraciones=e,this.loading=!1})}get Routes(){return{NEW:`/${I.Elaboracion}/${I.New}`}}generateMenu(e,t,l){t.toggle(l),this.itemsMenu=[{label:"Detalle",icon:"pi pi-eye",command:()=>{this.router.navigate([`/${I.Elaboracion}/${I.Detail}/`,e.id])}},{label:"Eliminar",icon:"pi pi-trash",command:()=>{this.delete(e)}}]}delete(e){this.confirmationDialogService.confirmDelete("\xBFEst\xE1 seguro que desea eliminar la elaboraci\xF3n?",()=>{this.elaboracionService.delete(e.id).subscribe(()=>{this.toastr.success("Se ha eliminado la elaboracion"),this.fetchAll()})})}openSelectorReceta(){this.ref=this.dialogService.open(zt,{header:"Agregar elaboracion",width:"50vw",breakpoints:{"960px":"75vw","640px":"90vw"},closable:!1,contentStyle:{overflow:"visible"}}),this.ref.onClose.subscribe(e=>{})}getEstadoSeverity(e){switch(e){case E.ENTREGADO_COMPLETO:return"success";case E.ENTREGADO_PARCIAL:return"primary";case E.EN_DEPOSITO:return"warning";case E.EN_PROCESO:return"info"}return""}};o.\u0275fac=function(t){return new(t||o)(u(A),u(W),u(V),u(ge),u(me),u(b))},o.\u0275cmp=y({type:o,selectors:[["elaboraciones-query"]],features:[D([A,it,nt,b])],decls:8,vars:11,consts:[["dt",""],["menu",""],[1,"card"],[3,"value","tableStyle","paginator","rows","rowsPerPageOptions","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"mb-4"],[1,"flex","align-items-center","justify-content-between","flex-wrap"],[1,"flex","gap-4","flex-wrap"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pRipple","","severity","primary","label","Agregar Elaboraci\xF3n","icon","pi pi-plus",1,"mr-2",3,"click"],["pSortableColumn","fecha"],["field","fecha"],["pSortableColumn","codigo"],["field","codigo"],["pSortableColumn","receta"],["field","receta"],["pSortableColumn","cantidad"],["field","cantidad"],["pSortableColumn","autor.username"],["field","autor.username"],["pSortableColumn","estado.estado"],["field","estado.estado"],["pSortableColumn","estado.fecha"],["field","estado.fecha"],["pButton","","pRipple","","type","button","icon","pi pi-bars",1,"p-button-rounded","p-button-text",3,"click"],["appendTo","body",3,"popup","model"],[3,"value","severity"],[1,"text-center","py-4"],[1,"flex","align-items-center","justify-content-between"]],template:function(t,l){t&1&&(i(0,"div",2)(1,"p-table",3,0),v(3,Yi,8,0,"ng-template",4)(4,en,24,0,"ng-template",5)(5,tn,23,14,"ng-template",6)(6,nn,3,1,"ng-template",7)(7,an,2,1,"ng-template",8),a()()),t&2&&(m(),c("value",l.elaboraciones)("tableStyle",_(7,Ht))("paginator",!0)("rows",5)("tableStyle",_(8,Ht))("rowsPerPageOptions",_(9,Ki))("globalFilterFields",_(10,Xi)))},dependencies:[Ne,H,Me,Re,at,T,pt,K,J,De],encapsulation:2});let n=o;return n})();var rn=[{path:"",redirectTo:"query",pathMatch:"full"},{path:"detail/:id",component:$t,title:"Detalle de Elaboracion"},{path:"query",component:Wt,title:"Listado de Elaboraciones"},{path:`${I.New}/:id`,component:Zt,title:"Nueva Elaboracion"}],Ka=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=Je({type:o}),o.\u0275inj=We({imports:[tt,dt.forChild(rn),yt,rt,ut,Dt,Tt,vt,Ft,bt,ht,_t,Nt,Pt,wt,Et,mt,ct,gt,kt,Rt,jt,It,xt,St,Ct]});let n=o;return n})();export{Ka as ElaboracionesModule};
